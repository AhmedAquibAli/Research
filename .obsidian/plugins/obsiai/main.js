/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => GeminiChatbotPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// node_modules/@google/generative-ai/dist/index.mjs
var HarmCategory;
(function(HarmCategory2) {
  HarmCategory2["HARM_CATEGORY_UNSPECIFIED"] = "HARM_CATEGORY_UNSPECIFIED";
  HarmCategory2["HARM_CATEGORY_HATE_SPEECH"] = "HARM_CATEGORY_HATE_SPEECH";
  HarmCategory2["HARM_CATEGORY_SEXUALLY_EXPLICIT"] = "HARM_CATEGORY_SEXUALLY_EXPLICIT";
  HarmCategory2["HARM_CATEGORY_HARASSMENT"] = "HARM_CATEGORY_HARASSMENT";
  HarmCategory2["HARM_CATEGORY_DANGEROUS_CONTENT"] = "HARM_CATEGORY_DANGEROUS_CONTENT";
})(HarmCategory || (HarmCategory = {}));
var HarmBlockThreshold;
(function(HarmBlockThreshold2) {
  HarmBlockThreshold2["HARM_BLOCK_THRESHOLD_UNSPECIFIED"] = "HARM_BLOCK_THRESHOLD_UNSPECIFIED";
  HarmBlockThreshold2["BLOCK_LOW_AND_ABOVE"] = "BLOCK_LOW_AND_ABOVE";
  HarmBlockThreshold2["BLOCK_MEDIUM_AND_ABOVE"] = "BLOCK_MEDIUM_AND_ABOVE";
  HarmBlockThreshold2["BLOCK_ONLY_HIGH"] = "BLOCK_ONLY_HIGH";
  HarmBlockThreshold2["BLOCK_NONE"] = "BLOCK_NONE";
})(HarmBlockThreshold || (HarmBlockThreshold = {}));
var HarmProbability;
(function(HarmProbability2) {
  HarmProbability2["HARM_PROBABILITY_UNSPECIFIED"] = "HARM_PROBABILITY_UNSPECIFIED";
  HarmProbability2["NEGLIGIBLE"] = "NEGLIGIBLE";
  HarmProbability2["LOW"] = "LOW";
  HarmProbability2["MEDIUM"] = "MEDIUM";
  HarmProbability2["HIGH"] = "HIGH";
})(HarmProbability || (HarmProbability = {}));
var BlockReason;
(function(BlockReason2) {
  BlockReason2["BLOCKED_REASON_UNSPECIFIED"] = "BLOCKED_REASON_UNSPECIFIED";
  BlockReason2["SAFETY"] = "SAFETY";
  BlockReason2["OTHER"] = "OTHER";
})(BlockReason || (BlockReason = {}));
var FinishReason;
(function(FinishReason2) {
  FinishReason2["FINISH_REASON_UNSPECIFIED"] = "FINISH_REASON_UNSPECIFIED";
  FinishReason2["STOP"] = "STOP";
  FinishReason2["MAX_TOKENS"] = "MAX_TOKENS";
  FinishReason2["SAFETY"] = "SAFETY";
  FinishReason2["RECITATION"] = "RECITATION";
  FinishReason2["OTHER"] = "OTHER";
})(FinishReason || (FinishReason = {}));
var TaskType;
(function(TaskType2) {
  TaskType2["TASK_TYPE_UNSPECIFIED"] = "TASK_TYPE_UNSPECIFIED";
  TaskType2["RETRIEVAL_QUERY"] = "RETRIEVAL_QUERY";
  TaskType2["RETRIEVAL_DOCUMENT"] = "RETRIEVAL_DOCUMENT";
  TaskType2["SEMANTIC_SIMILARITY"] = "SEMANTIC_SIMILARITY";
  TaskType2["CLASSIFICATION"] = "CLASSIFICATION";
  TaskType2["CLUSTERING"] = "CLUSTERING";
})(TaskType || (TaskType = {}));
var GoogleGenerativeAIError = class extends Error {
  constructor(message) {
    super(`[GoogleGenerativeAI Error]: ${message}`);
  }
};
var GoogleGenerativeAIResponseError = class extends GoogleGenerativeAIError {
  constructor(message, response) {
    super(message);
    this.response = response;
  }
};
var BASE_URL = "https://generativelanguage.googleapis.com";
var API_VERSION = "v1";
var PACKAGE_VERSION = "0.1.3";
var PACKAGE_LOG_HEADER = "genai-js";
var Task;
(function(Task2) {
  Task2["GENERATE_CONTENT"] = "generateContent";
  Task2["STREAM_GENERATE_CONTENT"] = "streamGenerateContent";
  Task2["COUNT_TOKENS"] = "countTokens";
  Task2["EMBED_CONTENT"] = "embedContent";
  Task2["BATCH_EMBED_CONTENTS"] = "batchEmbedContents";
})(Task || (Task = {}));
var RequestUrl = class {
  constructor(model, task, apiKey, stream) {
    this.model = model;
    this.task = task;
    this.apiKey = apiKey;
    this.stream = stream;
  }
  toString() {
    let url = `${BASE_URL}/${API_VERSION}/models/${this.model}:${this.task}`;
    if (this.stream) {
      url += "?alt=sse";
    }
    return url;
  }
};
function getClientHeaders() {
  return `${PACKAGE_LOG_HEADER}/${PACKAGE_VERSION}`;
}
async function makeRequest(url, body) {
  let response;
  try {
    response = await fetch(url.toString(), {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-goog-api-client": getClientHeaders(),
        "x-goog-api-key": url.apiKey
      },
      body
    });
    if (!response.ok) {
      let message = "";
      try {
        const json = await response.json();
        message = json.error.message;
        if (json.error.details) {
          message += ` ${JSON.stringify(json.error.details)}`;
        }
      } catch (e) {
      }
      throw new Error(`[${response.status} ${response.statusText}] ${message}`);
    }
  } catch (e) {
    const err = new GoogleGenerativeAIError(`Error fetching from ${url.toString()}: ${e.message}`);
    err.stack = e.stack;
    throw err;
  }
  return response;
}
function addHelpers(response) {
  response.text = () => {
    if (response.candidates && response.candidates.length > 0) {
      if (response.candidates.length > 1) {
        console.warn(`This response had ${response.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`);
      }
      if (hadBadFinishReason(response.candidates[0])) {
        throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(response)}`, response);
      }
      return getText(response);
    } else if (response.promptFeedback) {
      throw new GoogleGenerativeAIResponseError(`Text not available. ${formatBlockErrorMessage(response)}`, response);
    }
    return "";
  };
  return response;
}
function getText(response) {
  var _a, _b, _c, _d;
  if ((_d = (_c = (_b = (_a = response.candidates) === null || _a === void 0 ? void 0 : _a[0].content) === null || _b === void 0 ? void 0 : _b.parts) === null || _c === void 0 ? void 0 : _c[0]) === null || _d === void 0 ? void 0 : _d.text) {
    return response.candidates[0].content.parts[0].text;
  } else {
    return "";
  }
}
var badFinishReasons = [FinishReason.RECITATION, FinishReason.SAFETY];
function hadBadFinishReason(candidate) {
  return !!candidate.finishReason && badFinishReasons.includes(candidate.finishReason);
}
function formatBlockErrorMessage(response) {
  var _a, _b, _c;
  let message = "";
  if ((!response.candidates || response.candidates.length === 0) && response.promptFeedback) {
    message += "Response was blocked";
    if ((_a = response.promptFeedback) === null || _a === void 0 ? void 0 : _a.blockReason) {
      message += ` due to ${response.promptFeedback.blockReason}`;
    }
    if ((_b = response.promptFeedback) === null || _b === void 0 ? void 0 : _b.blockReasonMessage) {
      message += `: ${response.promptFeedback.blockReasonMessage}`;
    }
  } else if ((_c = response.candidates) === null || _c === void 0 ? void 0 : _c[0]) {
    const firstCandidate = response.candidates[0];
    if (hadBadFinishReason(firstCandidate)) {
      message += `Candidate was blocked due to ${firstCandidate.finishReason}`;
      if (firstCandidate.finishMessage) {
        message += `: ${firstCandidate.finishMessage}`;
      }
    }
  }
  return message;
}
function __await(v) {
  return this instanceof __await ? (this.v = v, this) : new __await(v);
}
function __asyncGenerator(thisArg, _arguments, generator) {
  if (!Symbol.asyncIterator)
    throw new TypeError("Symbol.asyncIterator is not defined.");
  var g = generator.apply(thisArg, _arguments || []), i, q = [];
  return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function() {
    return this;
  }, i;
  function verb(n) {
    if (g[n])
      i[n] = function(v) {
        return new Promise(function(a, b) {
          q.push([n, v, a, b]) > 1 || resume(n, v);
        });
      };
  }
  function resume(n, v) {
    try {
      step(g[n](v));
    } catch (e) {
      settle(q[0][3], e);
    }
  }
  function step(r) {
    r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);
  }
  function fulfill(value) {
    resume("next", value);
  }
  function reject(value) {
    resume("throw", value);
  }
  function settle(f, v) {
    if (f(v), q.shift(), q.length)
      resume(q[0][0], q[0][1]);
  }
}
var responseLineRE = /^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;
function processStream(response) {
  const inputStream = response.body.pipeThrough(new TextDecoderStream("utf8", { fatal: true }));
  const responseStream = getResponseStream(inputStream);
  const [stream1, stream2] = responseStream.tee();
  return {
    stream: generateResponseSequence(stream1),
    response: getResponsePromise(stream2)
  };
}
async function getResponsePromise(stream) {
  const allResponses = [];
  const reader = stream.getReader();
  while (true) {
    const { done, value } = await reader.read();
    if (done) {
      return addHelpers(aggregateResponses(allResponses));
    }
    allResponses.push(value);
  }
}
function generateResponseSequence(stream) {
  return __asyncGenerator(this, arguments, function* generateResponseSequence_1() {
    const reader = stream.getReader();
    while (true) {
      const { value, done } = yield __await(reader.read());
      if (done) {
        break;
      }
      yield yield __await(addHelpers(value));
    }
  });
}
function getResponseStream(inputStream) {
  const reader = inputStream.getReader();
  const stream = new ReadableStream({
    start(controller) {
      let currentText = "";
      return pump();
      function pump() {
        return reader.read().then(({ value, done }) => {
          if (done) {
            if (currentText.trim()) {
              controller.error(new GoogleGenerativeAIError("Failed to parse stream"));
              return;
            }
            controller.close();
            return;
          }
          currentText += value;
          let match = currentText.match(responseLineRE);
          let parsedResponse;
          while (match) {
            try {
              parsedResponse = JSON.parse(match[1]);
            } catch (e) {
              controller.error(new GoogleGenerativeAIError(`Error parsing JSON response: "${match[1]}"`));
              return;
            }
            controller.enqueue(parsedResponse);
            currentText = currentText.substring(match[0].length);
            match = currentText.match(responseLineRE);
          }
          return pump();
        });
      }
    }
  });
  return stream;
}
function aggregateResponses(responses) {
  const lastResponse = responses[responses.length - 1];
  const aggregatedResponse = {
    promptFeedback: lastResponse === null || lastResponse === void 0 ? void 0 : lastResponse.promptFeedback
  };
  for (const response of responses) {
    if (response.candidates) {
      for (const candidate of response.candidates) {
        const i = candidate.index;
        if (!aggregatedResponse.candidates) {
          aggregatedResponse.candidates = [];
        }
        if (!aggregatedResponse.candidates[i]) {
          aggregatedResponse.candidates[i] = {
            index: candidate.index
          };
        }
        aggregatedResponse.candidates[i].citationMetadata = candidate.citationMetadata;
        aggregatedResponse.candidates[i].finishReason = candidate.finishReason;
        aggregatedResponse.candidates[i].finishMessage = candidate.finishMessage;
        aggregatedResponse.candidates[i].safetyRatings = candidate.safetyRatings;
        if (candidate.content && candidate.content.parts) {
          if (!aggregatedResponse.candidates[i].content) {
            aggregatedResponse.candidates[i].content = {
              role: candidate.content.role || "user",
              parts: [{ text: "" }]
            };
          }
          for (const part of candidate.content.parts) {
            if (part.text) {
              aggregatedResponse.candidates[i].content.parts[0].text += part.text;
            }
          }
        }
      }
    }
  }
  return aggregatedResponse;
}
async function generateContentStream(apiKey, model, params) {
  const url = new RequestUrl(
    model,
    Task.STREAM_GENERATE_CONTENT,
    apiKey,
    /* stream */
    true
  );
  const response = await makeRequest(url, JSON.stringify(params));
  return processStream(response);
}
async function generateContent(apiKey, model, params) {
  const url = new RequestUrl(
    model,
    Task.GENERATE_CONTENT,
    apiKey,
    /* stream */
    false
  );
  const response = await makeRequest(url, JSON.stringify(params));
  const responseJson = await response.json();
  const enhancedResponse = addHelpers(responseJson);
  return {
    response: enhancedResponse
  };
}
function formatNewContent(request, role) {
  let newParts = [];
  if (typeof request === "string") {
    newParts = [{ text: request }];
  } else {
    for (const partOrString of request) {
      if (typeof partOrString === "string") {
        newParts.push({ text: partOrString });
      } else {
        newParts.push(partOrString);
      }
    }
  }
  return { role, parts: newParts };
}
function formatGenerateContentInput(params) {
  if (params.contents) {
    return params;
  } else {
    const content = formatNewContent(params, "user");
    return { contents: [content] };
  }
}
function formatEmbedContentInput(params) {
  if (typeof params === "string" || Array.isArray(params)) {
    const content = formatNewContent(params, "user");
    return { content };
  }
  return params;
}
var SILENT_ERROR = "SILENT_ERROR";
var ChatSession = class {
  constructor(apiKey, model, params) {
    this.model = model;
    this.params = params;
    this._history = [];
    this._sendPromise = Promise.resolve();
    this._apiKey = apiKey;
    if (params === null || params === void 0 ? void 0 : params.history) {
      this._history = params.history.map((content) => {
        if (!content.role) {
          throw new Error("Missing role for history item: " + JSON.stringify(content));
        }
        return formatNewContent(content.parts, content.role);
      });
    }
  }
  /**
   * Gets the chat history so far. Blocked prompts are not added to history.
   * Blocked candidates are not added to history, nor are the prompts that
   * generated them.
   */
  async getHistory() {
    await this._sendPromise;
    return this._history;
  }
  /**
   * Sends a chat message and receives a non-streaming
   * {@link GenerateContentResult}
   */
  async sendMessage(request) {
    var _a, _b;
    await this._sendPromise;
    const newContent = formatNewContent(request, "user");
    const generateContentRequest = {
      safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,
      generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,
      contents: [...this._history, newContent]
    };
    let finalResult;
    this._sendPromise = this._sendPromise.then(() => generateContent(this._apiKey, this.model, generateContentRequest)).then((result) => {
      var _a2;
      if (result.response.candidates && result.response.candidates.length > 0) {
        this._history.push(newContent);
        const responseContent = Object.assign({
          parts: [],
          // Response seems to come back without a role set.
          role: "model"
        }, (_a2 = result.response.candidates) === null || _a2 === void 0 ? void 0 : _a2[0].content);
        this._history.push(responseContent);
      } else {
        const blockErrorMessage = formatBlockErrorMessage(result.response);
        if (blockErrorMessage) {
          console.warn(`sendMessage() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);
        }
      }
      finalResult = result;
    });
    await this._sendPromise;
    return finalResult;
  }
  /**
   * Sends a chat message and receives the response as a
   * {@link GenerateContentStreamResult} containing an iterable stream
   * and a response promise.
   */
  async sendMessageStream(request) {
    var _a, _b;
    await this._sendPromise;
    const newContent = formatNewContent(request, "user");
    const generateContentRequest = {
      safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,
      generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,
      contents: [...this._history, newContent]
    };
    const streamPromise = generateContentStream(this._apiKey, this.model, generateContentRequest);
    this._sendPromise = this._sendPromise.then(() => streamPromise).catch((_ignored) => {
      throw new Error(SILENT_ERROR);
    }).then((streamResult) => streamResult.response).then((response) => {
      if (response.candidates && response.candidates.length > 0) {
        this._history.push(newContent);
        const responseContent = Object.assign({}, response.candidates[0].content);
        if (!responseContent.role) {
          responseContent.role = "model";
        }
        this._history.push(responseContent);
      } else {
        const blockErrorMessage = formatBlockErrorMessage(response);
        if (blockErrorMessage) {
          console.warn(`sendMessageStream() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);
        }
      }
    }).catch((e) => {
      if (e.message !== SILENT_ERROR) {
        console.error(e);
      }
    });
    return streamPromise;
  }
};
async function countTokens(apiKey, model, params) {
  const url = new RequestUrl(model, Task.COUNT_TOKENS, apiKey, false);
  const response = await makeRequest(url, JSON.stringify(Object.assign(Object.assign({}, params), { model })));
  return response.json();
}
async function embedContent(apiKey, model, params) {
  const url = new RequestUrl(model, Task.EMBED_CONTENT, apiKey, false);
  const response = await makeRequest(url, JSON.stringify(params));
  return response.json();
}
async function batchEmbedContents(apiKey, model, params) {
  const url = new RequestUrl(model, Task.BATCH_EMBED_CONTENTS, apiKey, false);
  const requestsWithModel = params.requests.map((request) => {
    return Object.assign(Object.assign({}, request), { model: `models/${model}` });
  });
  const response = await makeRequest(url, JSON.stringify({ requests: requestsWithModel }));
  return response.json();
}
var GenerativeModel = class {
  constructor(apiKey, modelParams) {
    var _a;
    this.apiKey = apiKey;
    if (modelParams.model.startsWith("models/")) {
      this.model = (_a = modelParams.model.split("models/")) === null || _a === void 0 ? void 0 : _a[1];
    } else {
      this.model = modelParams.model;
    }
    this.generationConfig = modelParams.generationConfig || {};
    this.safetySettings = modelParams.safetySettings || [];
  }
  /**
   * Makes a single non-streaming call to the model
   * and returns an object containing a single {@link GenerateContentResponse}.
   */
  async generateContent(request) {
    const formattedParams = formatGenerateContentInput(request);
    return generateContent(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings }, formattedParams));
  }
  /**
   * Makes a single streaming call to the model
   * and returns an object containing an iterable stream that iterates
   * over all chunks in the streaming response as well as
   * a promise that returns the final aggregated response.
   */
  async generateContentStream(request) {
    const formattedParams = formatGenerateContentInput(request);
    return generateContentStream(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings }, formattedParams));
  }
  /**
   * Gets a new {@link ChatSession} instance which can be used for
   * multi-turn chats.
   */
  startChat(startChatParams) {
    return new ChatSession(this.apiKey, this.model, startChatParams);
  }
  /**
   * Counts the tokens in the provided request.
   */
  async countTokens(request) {
    const formattedParams = formatGenerateContentInput(request);
    return countTokens(this.apiKey, this.model, formattedParams);
  }
  /**
   * Embeds the provided content.
   */
  async embedContent(request) {
    const formattedParams = formatEmbedContentInput(request);
    return embedContent(this.apiKey, this.model, formattedParams);
  }
  /**
   * Embeds an array of {@link EmbedContentRequest}s.
   */
  async batchEmbedContents(batchEmbedContentRequest) {
    return batchEmbedContents(this.apiKey, this.model, batchEmbedContentRequest);
  }
};
var GoogleGenerativeAI = class {
  constructor(apiKey) {
    this.apiKey = apiKey;
  }
  /**
   * Gets a {@link GenerativeModel} instance for the provided model name.
   */
  getGenerativeModel(modelParams) {
    if (!modelParams.model) {
      throw new GoogleGenerativeAIError(`Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })`);
    }
    return new GenerativeModel(this.apiKey, modelParams);
  }
};

// src/services/GeminiService.ts
var GeminiService = class {
  constructor(apiKey) {
    const genAI = new GoogleGenerativeAI(apiKey);
    this.model = genAI.getGenerativeModel({ model: "gemini-pro" });
    this.startChat();
  }
  startChat() {
    this.chat = this.model.startChat({
      history: [],
      generationConfig: {
        maxOutputTokens: 1e3
      }
    });
  }
  async sendMessage(message) {
    try {
      const result = await this.chat.sendMessage(message);
      const response = await result.response;
      return response.text();
    } catch (error) {
      console.error("Error sending message to Gemini:", error);
      throw error;
    }
  }
  async summarizeContent(content) {
    const prompt = `Please summarize the following content:

${content}`;
    return this.sendMessage(prompt);
  }
  async translateContent(content, targetLanguage) {
    const prompt = `Please translate the following content to ${targetLanguage}:

${content}`;
    return this.sendMessage(prompt);
  }
  async findActionItems(content) {
    const prompt = `Please analyze the following content and list all action items and tasks:

${content}`;
    return this.sendMessage(prompt);
  }
};

// src/modals/LanguageSelectionModal.ts
var import_obsidian = require("obsidian");
var LanguageSelectionModal = class extends import_obsidian.Modal {
  constructor(app, onChoose) {
    super(app);
    this.onChoose = onChoose;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Select Target Language" });
    const languages = [
      "Arabic",
      "Chinese",
      "English",
      "French",
      "German",
      "Hindi",
      "Italian",
      "Japanese",
      "Korean",
      "Portuguese",
      "Russian",
      "Spanish"
    ];
    new import_obsidian.Setting(contentEl).setName("Language").addDropdown((dropdown) => {
      languages.forEach((lang) => dropdown.addOption(lang.toLowerCase(), lang));
      dropdown.onChange((value) => {
        this.result = value;
      });
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Translate").setCta().onClick(() => {
      this.onChoose(this.result);
      this.close();
    }));
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// main.ts
var import_obsidian4 = require("obsidian");

// src/modals/FileSelectionModal.ts
var import_obsidian2 = require("obsidian");
var FileSelectionModal = class extends import_obsidian2.FuzzySuggestModal {
  constructor(app, onChoose) {
    super(app);
    this.onChoose = onChoose;
    this.setPlaceholder("Type to search for a file...");
  }
  getItems() {
    return this.app.vault.getMarkdownFiles();
  }
  getItemText(file) {
    return file.basename;
  }
  onChooseItem(file, evt) {
    this.onChoose(file);
  }
  renderSuggestion(match, el) {
    var _a, _b;
    const file = match.item;
    el.createEl("div", { text: file.basename });
    const path = el.createEl("div", { text: (_b = (_a = file.parent) == null ? void 0 : _a.path) != null ? _b : "" });
    path.addClass("suggestion-path");
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  apiKey: "",
  floatingPosition: { x: 20, y: 20 },
  isDocked: false,
  chatSessions: []
};
var GeminiChatbotPlugin = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.geminiService = null;
    this.messagesContainer = null;
    this.inputField = null;
    this.currentFileContent = null;
    this.chatHistory = [];
    this.isFullPage = false;
    this.currentSession = null;
    this.referencedFiles = null;
    // Rate limiting and context management
    this.lastApiCall = 0;
    this.API_COOLDOWN = 1e3;
    // Prevent rapid-fire API calls
    this.MAX_CONTEXT_LENGTH = 3e4;
  }
  // Prevent token limit issues
  async onload() {
    const fontAwesomeLink = document.createElement("link");
    fontAwesomeLink.rel = "stylesheet";
    fontAwesomeLink.href = "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css";
    document.head.appendChild(fontAwesomeLink);
    await this.loadSettings();
    if (this.settings.apiKey) {
      this.initializeGeminiService();
    }
    this.addSettingTab(new GeminiChatbotSettingTab(this.app, this));
    this.addFloatingIcon();
    this.addChatContainer();
  }
  initializeGeminiService() {
    try {
      if (this.settings.apiKey) {
        const decryptedKey = this.decryptApiKey(this.settings.apiKey);
        this.geminiService = new GeminiService(decryptedKey);
      }
    } catch (error) {
      console.error("Failed to initialize Gemini service:", error);
    }
  }
  async handleMessage(message) {
    var _a, _b;
    if (!this.geminiService || !message.trim())
      return;
    const now = Date.now();
    if (now - this.lastApiCall < this.API_COOLDOWN) {
      this.addErrorMessage("Please wait a moment before sending another message");
      return;
    }
    this.toggleSuggestedActions(false);
    let contextMessage = message;
    let context = "";
    const fileReferences = message.match(/@([^\s]+)/g);
    if (fileReferences) {
      contextMessage = message.replace(/@([^\s]+)/g, "").trim();
      for (const ref of fileReferences) {
        const fileName = ref.slice(1);
        const fileContent = (_a = this.referencedFiles) == null ? void 0 : _a.get(fileName);
        if (fileContent) {
          const truncatedContent = this.truncateContent(fileContent);
          context += `
Relevant content from ${fileName}:
${truncatedContent}
`;
        }
      }
    }
    const activeFile = this.app.workspace.getActiveFile();
    if (activeFile && !fileReferences) {
      const content = await this.app.vault.read(activeFile);
      const truncatedContent = this.truncateContent(content);
      context += `
Relevant content from current note:
${truncatedContent}
`;
    }
    const finalMessage = context ? `${context}

User question: ${contextMessage}` : contextMessage;
    const userMessage = {
      role: "user",
      content: finalMessage,
      timestamp: Date.now()
    };
    await this.addMessageToChat({
      ...userMessage,
      content: contextMessage
    });
    const typingIndicator = document.createElement("div");
    typingIndicator.addClass("typing-indicator");
    typingIndicator.innerHTML = `
			<span></span>
			<span></span>
			<span></span>
		`;
    (_b = this.messagesContainer) == null ? void 0 : _b.appendChild(typingIndicator);
    try {
      this.lastApiCall = Date.now();
      const response = await this.geminiService.sendMessage(finalMessage);
      typingIndicator.remove();
      const botMessage = {
        role: "bot",
        content: response,
        timestamp: Date.now()
      };
      await this.addMessageToChat(botMessage);
      if (this.currentSession) {
        if (this.currentSession.messages.length === 2) {
          this.currentSession.title = this.generateSessionTitle(userMessage.content);
        }
        this.settings.chatSessions = [
          this.currentSession,
          ...this.settings.chatSessions.filter((s) => {
            var _a2;
            return s.id !== ((_a2 = this.currentSession) == null ? void 0 : _a2.id);
          })
        ];
        await this.saveSettings();
      }
    } catch (error) {
      typingIndicator.remove();
      let errorMessage = "Failed to get response from Gemini";
      if (error instanceof Error) {
        if (error.message.includes("429")) {
          errorMessage = "Rate limit reached. Please wait a moment before trying again.";
        } else if (error.message.includes("quota")) {
          errorMessage = "API quota exceeded. Please try again later.";
        }
      }
      this.addErrorMessage(errorMessage);
    }
  }
  async addMessageToChat(message) {
    if (!this.messagesContainer)
      return;
    const messageEl = document.createElement("div");
    messageEl.addClass(`gemini-message-${message.role}`);
    if (message.role === "bot") {
      const copyButton = messageEl.createEl("button", {
        text: "Copy to new note",
        cls: "copy-response-button"
      });
      copyButton.addEventListener("click", async () => {
        const title = this.generateNoteTitle(message.content);
        const file = await this.app.vault.create(`${title}.md`, message.content);
        const leaf = this.app.workspace.getLeaf(false);
        await leaf.openFile(file);
        new import_obsidian3.Notice("Response copied to new note!");
      });
      await import_obsidian4.MarkdownRenderer.renderMarkdown(message.content, messageEl, "", this);
    } else {
      const visibleContent = this.stripContextFromMessage(message.content);
      messageEl.textContent = visibleContent;
    }
    this.messagesContainer.appendChild(messageEl);
    this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
    if (this.currentSession) {
      this.currentSession.messages.push(message);
    }
  }
  // Add new method for typing animation
  async typeMessage(text, container) {
    await import_obsidian4.MarkdownRenderer.renderMarkdown(text, container, "", this);
    const elements = Array.from(container.children);
    container.empty();
    for (const element of elements) {
      if (element instanceof HTMLElement) {
        if (element.tagName === "P") {
          const text2 = element.textContent || "";
          const p = container.createEl("p");
          for (const char of text2) {
            p.textContent += char;
            await new Promise((resolve) => setTimeout(resolve, 10));
            if (this.messagesContainer) {
              this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
            }
          }
        } else {
          container.appendChild(element);
        }
      }
    }
  }
  // Add method to strip context from messages
  stripContextFromMessage(message) {
    const userQuestionMatch = message.match(/User question: (.*?)$/m);
    if (userQuestionMatch) {
      return userQuestionMatch[1].trim();
    }
    return message;
  }
  addErrorMessage(message) {
    if (!this.messagesContainer)
      return;
    const errorEl = document.createElement("div");
    errorEl.addClass("gemini-message-error");
    errorEl.textContent = message;
    this.messagesContainer.appendChild(errorEl);
  }
  addFloatingIcon() {
    this.chatIcon = document.createElement("div");
    this.chatIcon.addClass("gemini-chat-icon");
    this.chatIcon.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
			<path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
		</svg>`;
    this.chatIcon.addEventListener("click", () => {
      this.toggleChatContainer();
    });
    document.body.appendChild(this.chatIcon);
  }
  addChatContainer() {
    this.chatContainer = document.createElement("div");
    this.chatContainer.addClass("gemini-chat-container");
    this.chatContainer.style.display = "none";
    this.chatContainer.style.width = "380px";
    this.chatContainer.style.height = "590px";
    this.chatContainer.innerHTML = `
			<div class="gemini-chat-header">
				<div class="current-file"></div>
				<div class="chat-header-controls">
					<button class="history-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<circle cx="12" cy="12" r="10"></circle>
							<polyline points="12 6 12 12 16 14"></polyline>
						</svg>
					</button>
					<button class="more-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
							<line x1="3" y1="12" x2="21" y2="12"></line>
							<line x1="12" y1="3" x2="12" y2="21"></line>
						</svg>
					</button>
					<button class="close-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<line x1="18" y1="6" x2="6" y2="18"></line>
							<line x1="6" y1="6" x2="18" y2="18"></line>
						</svg>
					</button>
				</div>
			</div>
			
			<div class="bot-info">
				<div class="bot-avatar">
					<svg viewBox="0 0 1080 1080" fill="none" xmlns="http://www.w3.org/2000/svg">
						<defs>
							<filter id="filter" x="-20%" y="-20%" width="140%" height="140%" filterUnits="objectBoundingBox" primitiveUnits="userSpaceOnUse" color-interpolation-filters="linearRGB">
								<feMorphology operator="dilate" radius="20 20" in="SourceAlpha" result="morphology"/>
								<feFlood flood-color="#ffffff" flood-opacity="1" result="flood"/>
								<feComposite in="flood" in2="morphology" operator="in" result="composite"/>
								<feMerge result="merge">
									<feMergeNode in="composite" result="mergeNode"/>
									<feMergeNode in="SourceGraphic" result="mergeNode1"/>
								</feMerge>
							</filter>
						</defs>
						<g id="notion-avatar" filter="url(#filter)">
							<g id="notion-avatar-face" fill="#ffffff">
								<title>Face/ 5</title>
								<g id="Face/-5" stroke="none" stroke-width="1" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round">
									<path d="M532,379 C664.54834,379 772,486.45166 772,619 C772,751.54834 704.54834,859 532,859 C405.842528,859 335.866563,801.559592 307.358668,718.866959 C265.336704,716.464588 232,681.625396 232,639 C232,599.134956 261.158843,566.080325 299.312086,560.00055 C325.599297,455.979213 419.809919,379 532,379 Z M295.858895,624.545187 L304.141105,655.454813" id="Path" stroke="#000000" stroke-width="24"/>
								</g>
							</g>
							<g id="notion-avatar-nose">
								<title>Nose/ 5</title>
								<g id="Nose/-5" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round">
									<path d="M673,568 C662.55102,590.836147 657.326531,613.414126 657.326531,635.733939 C657.326531,669.213657 673,686.992054 670.061224,702.552554 C668.102041,712.92622 653.081633,714.756867 625,708.044495" id="Path" stroke="#000000" stroke-width="16"/>
								</g>
							</g>
							<g id="notion-avatar-mouth">
								<title>Mouth/ 1</title>
								<g id="Mouth/-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round">
									<path d="M549,759 C575.12979,773.666667 603.12979,781 633,781 C662.87021,781 682.87021,773.666667 693,759" id="Path" stroke="#000000" stroke-width="16"/>
								</g>
							</g>
							<g id="notion-avatar-eyes">
								<title>Eyes/ 7</title>
								<g id="Eyes/-7" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
									<path d="M570,516 C578.836556,516 586,526.745166 586,540 C586,553.254834 578.836556,564 570,564 C561.163444,564 554,553.254834 554,540 C554,526.745166 561.163444,516 570,516 Z M708,516 C716.836556,516 724,526.745166 724,540 C724,553.254834 716.836556,564 708,564 C699.163444,564 692,553.254834 692,540 C692,526.745166 699.163444,516 708,516 Z M568,527 C564.686292,527 562,529.686292 562,533 C562,536.313708 564.686292,539 568,539 C571.313708,539 574,536.313708 574,533 C574,529.686292 571.313708,527 568,527 Z M706,527 C702.686292,527 700,529.686292 700,533 C700,536.313708 702.686292,539 706,539 C709.313708,539 712,536.313708 712,533 C712,529.686292 709.313708,527 706,527 Z" id="Combined-Shape" fill="#000000"/>
								</g>
							</g>
							<g id="notion-avatar-eyebrows">
								<title>Eyebrows/ 1</title>
								<g id="Eyebrows/-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="square" stroke-linejoin="round">
									<g id="Group" transform="translate(521.000000, 490.000000)" stroke="#000000" stroke-width="20">
										<path d="M0,16 C12.8888889,5.33333333 27.8888889,0 45,0 C62.1111111,0 77.1111111,5.33333333 90,16" id="Path"/>
										<path d="M146,16 C158.888889,5.33333333 173.888889,0 191,0 C208.111111,0 223.111111,5.33333333 236,16" id="Path"/>
									</g>
								</g>
							</g>
							<g id="notion-avatar-hair">
								<title>Hairstyle/ 25</title>
								<g id="Hairstyle/-25" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round">
									<path d="M227,151 C291,143 344.152059,161.487028 368.024158,212.689811 C410.238527,194.447151 459.304239,186 515,186 C629.125983,186 703.747536,236.594939 747,304 C779.083989,354 792.083989,420.666667 786,504 L782.3412,503.1612 C722.927067,489.4804 699,484 661,460 C635.666667,444 602.333333,419.666667 561,387 C524.333333,437 495.333333,470 474,486 C442,510 357,547 304,565 C251,583 232,598 232,648 C232,681.333333 258.666667,705 312,719 C325.996223,746.033167 340.996223,769.366501 357,789 C373.003777,808.633499 393.003777,825.633499 417,840 C335.666667,855.333333 262.333333,855.333333 197,840 C131.666667,824.666667 79.3333333,791 40,739 C94.6666667,735 127.666667,710.333333 139,665 C169.469054,543.123784 93,519 93,379 C93,239 147.699952,160.912506 227,151 Z" id="Path" stroke="#000000" stroke-width="12" fill="#000000"/>
								</g>
							</g>
						</g>
					</svg>
				</div>
				<div class="bot-greeting">Hello, How can I help you today?</div>
			</div>

			<div class="gemini-chat-messages"></div>

			<div class="suggested-actions">
				<h3>Suggested</h3>
				<div class="action-button">
					<span class="action-icon">\u{1F4DD}</span>
					Summarize this page
				</div>
				<div class="action-button">
					<span class="action-icon">\u{1F50D}</span>
					Ask about this page
				</div>
				<div class="action-button">
					<span class="action-icon">\u{1F4DA}</span>
					Make a quiz
				</div>
				<div class="action-button">
					<span class="action-icon">\u{1F310}</span>
					Translate to
				</div>
			</div>

			<div class="chat-input-container">
				<div class="chat-input-wrapper">
					<textarea class="chat-input" placeholder="Ask anything or select..."></textarea>
					<div class="input-actions">
						<button class="mention-button">@</button>
						<button class="send-button">\u2191</button>
					</div>
				</div>
			</div>
		`;
    document.body.appendChild(this.chatContainer);
    this.addChatEventListeners();
    const resizeHandle = document.createElement("div");
    resizeHandle.addClass("resize-handle");
    this.chatContainer.appendChild(resizeHandle);
    this.addResizeFunctionality(resizeHandle);
  }
  addChatEventListeners() {
    const closeButton = this.chatContainer.querySelector(".close-button");
    closeButton == null ? void 0 : closeButton.addEventListener("click", () => {
      this.toggleChatContainer();
    });
    const sendButton = this.chatContainer.querySelector(".send-button");
    const inputField = this.chatContainer.querySelector(".chat-input");
    this.inputField = inputField;
    this.messagesContainer = this.chatContainer.querySelector(".gemini-chat-messages");
    sendButton == null ? void 0 : sendButton.addEventListener("click", () => {
      if (this.inputField) {
        const message = this.inputField.value.trim();
        if (message) {
          this.handleMessage(message);
          this.inputField.value = "";
        }
      }
    });
    inputField == null ? void 0 : inputField.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && !e.shiftKey && this.inputField) {
        e.preventDefault();
        const message = this.inputField.value.trim();
        if (message) {
          this.handleMessage(message);
          this.inputField.value = "";
        }
      }
    });
    const actionButtons = this.chatContainer.querySelectorAll(".action-button");
    actionButtons.forEach((button) => {
      button.addEventListener("click", () => {
        var _a, _b, _c, _d;
        if (!this.inputField)
          return;
        if ((_a = button.textContent) == null ? void 0 : _a.includes("Summarize")) {
          this.inputField.value = "Can you summarize this note for me?";
        } else if ((_b = button.textContent) == null ? void 0 : _b.includes("Ask about")) {
          this.inputField.value = "What is this note about?";
        } else if ((_c = button.textContent) == null ? void 0 : _c.includes("Make a quiz")) {
          this.inputField.value = "Can you create a quiz using this note?";
        } else if ((_d = button.textContent) == null ? void 0 : _d.includes("Translate")) {
          new LanguageSelectionModal(this.app, (language) => {
            if (this.inputField) {
              this.inputField.value = `Can you translate this note to ${language}?`;
            }
          }).open();
        }
        this.inputField.focus();
      });
    });
    const historyButton = this.chatContainer.querySelector(".history-button");
    historyButton == null ? void 0 : historyButton.addEventListener("click", () => {
      this.showChatHistoryView();
    });
    const moreButton = this.chatContainer.querySelector(".more-button");
    moreButton == null ? void 0 : moreButton.addEventListener("click", async () => {
      if (this.chatContainer.style.width === "380px" && this.chatContainer.style.height === "590px") {
        return;
      }
      this.chatContainer.classList.add("resetting");
      this.chatContainer.style.width = "380px";
      this.chatContainer.style.height = "590px";
      setTimeout(() => {
        this.chatContainer.classList.remove("resetting");
      }, 400);
    });
    const mentionButton = this.chatContainer.querySelector(".mention-button");
    mentionButton == null ? void 0 : mentionButton.addEventListener("click", () => {
      this.showFileSelectionModal();
    });
  }
  showLanguageSelectionModal(content) {
    new LanguageSelectionModal(this.app, (language) => {
      if (this.geminiService) {
        this.geminiService.translateContent(content, language).then((translation) => {
          this.addMessageToChat({
            role: "bot",
            content: translation,
            timestamp: Date.now()
          });
        }).catch((error) => {
          this.addErrorMessage("Translation failed");
          console.error("Translation error:", error);
        });
      }
    }).open();
  }
  async toggleChatContainer() {
    const isVisible = this.chatContainer.style.display !== "none";
    if (isVisible) {
      this.chatContainer.classList.add("closing");
      await new Promise((resolve) => setTimeout(resolve, 300));
      this.chatContainer.style.display = "none";
      this.chatContainer.classList.remove("closing");
    } else {
      this.chatContainer.style.display = "flex";
      this.currentSession = this.createNewSession();
      this.showMainChatView();
      this.toggleSuggestedActions(true);
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        this.currentFileContent = await this.app.vault.read(activeFile);
        this.updateChatHeader();
      } else {
        this.currentFileContent = null;
        this.updateChatHeader();
      }
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  onunload() {
    var _a, _b;
    const fontAwesomeLink = document.querySelector('link[href*="font-awesome"]');
    if (fontAwesomeLink) {
      fontAwesomeLink.remove();
    }
    (_a = this.chatIcon) == null ? void 0 : _a.remove();
    (_b = this.chatContainer) == null ? void 0 : _b.remove();
  }
  encryptApiKey(key) {
    return btoa(key.split("").reverse().join(""));
  }
  decryptApiKey(encryptedKey) {
    return atob(encryptedKey).split("").reverse().join("");
  }
  // Add this method to handle showing/hiding suggested actions
  toggleSuggestedActions(show) {
    const suggestedActions = this.chatContainer.querySelector(".suggested-actions");
    if (suggestedActions) {
      suggestedActions.style.display = show ? "block" : "none";
    }
  }
  updateChatHeader() {
    const activeFile = this.app.workspace.getActiveFile();
    const headerEl = this.chatContainer.querySelector(".current-file");
    if (headerEl && activeFile) {
      headerEl.textContent = activeFile.basename;
      headerEl.style.display = "block";
    } else if (headerEl) {
      headerEl.style.display = "none";
    }
  }
  // Add this method to handle full page toggle
  toggleFullPageChat() {
    this.isFullPage = !this.isFullPage;
    if (this.isFullPage) {
      this.chatContainer.addClass("full-page");
    } else {
      this.chatContainer.removeClass("full-page");
    }
  }
  // Add method to create new chat session
  createNewSession() {
    return {
      id: Date.now().toString(),
      title: "New chat",
      timestamp: Date.now(),
      messages: []
    };
  }
  // Add method to generate session title
  generateSessionTitle(firstMessage) {
    const cleanMessage = firstMessage.replace(/[#*`]/g, "").trim();
    if (cleanMessage.toLowerCase().includes("summarize")) {
      return "\u{1F4DD} Summary: " + this.extractDocumentName(cleanMessage);
    }
    if (cleanMessage.toLowerCase().includes("translate")) {
      return "\u{1F310} Translation: " + this.extractDocumentName(cleanMessage);
    }
    if (cleanMessage.toLowerCase().includes("action items") || cleanMessage.toLowerCase().includes("tasks")) {
      return "\u2705 Tasks from: " + this.extractDocumentName(cleanMessage);
    }
    if (cleanMessage.endsWith("?")) {
      return "\u2753 " + (cleanMessage.length > 40 ? cleanMessage.substring(0, 40) + "..." : cleanMessage);
    }
    const keywords = this.extractKeywords(cleanMessage);
    if (keywords) {
      return "\u{1F4AD} Chat about " + keywords;
    }
    return "\u{1F4AC} Chat from " + new Date().toLocaleTimeString([], {
      hour: "2-digit",
      minute: "2-digit"
    });
  }
  extractDocumentName(message) {
    const lines = message.split("\n");
    if (lines.length > 1) {
      for (let i = 1; i < lines.length; i++) {
        const line = lines[i].trim();
        if (line) {
          return line.length > 30 ? line.substring(0, 30) + "..." : line;
        }
      }
    }
    return "Document";
  }
  extractKeywords(message) {
    const commonWords = /* @__PURE__ */ new Set([
      "the",
      "be",
      "to",
      "of",
      "and",
      "a",
      "in",
      "that",
      "have",
      "i",
      "it",
      "for",
      "not",
      "on",
      "with",
      "he",
      "as",
      "you",
      "do",
      "at",
      "this",
      "but",
      "his",
      "by",
      "from",
      "they",
      "we",
      "say",
      "her",
      "she",
      "or",
      "an",
      "will",
      "my",
      "one",
      "all",
      "would",
      "there",
      "their",
      "what",
      "so",
      "up",
      "out",
      "if",
      "about",
      "who",
      "get",
      "which",
      "go",
      "me",
      "please",
      "could",
      "can",
      "just"
    ]);
    const words = message.toLowerCase().replace(/[^\w\s]/g, "").split(/\s+/).filter((word) => !commonWords.has(word) && word.length > 2).slice(0, 3);
    if (words.length > 0) {
      const formattedWords = words.map((word) => word.charAt(0).toUpperCase() + word.slice(1));
      return formattedWords.join(", ");
    }
    return "";
  }
  // Update showChatHistoryView method
  showChatHistoryView() {
    if (!this.chatContainer)
      return;
    const elementsToHide = [
      ".bot-info",
      ".suggested-actions",
      ".chat-input-container",
      ".gemini-chat-messages"
    ];
    elementsToHide.forEach((selector) => {
      const el = this.chatContainer.querySelector(selector);
      if (el)
        el.style.display = "none";
    });
    const existingHistoryView = this.chatContainer.querySelector(".chat-history-view");
    if (existingHistoryView) {
      existingHistoryView.classList.add("closing");
      setTimeout(() => {
        existingHistoryView.remove();
      }, 300);
      return;
    }
    const historyView = document.createElement("div");
    historyView.addClass("chat-history-view");
    historyView.innerHTML = `
			<div class="chat-history-header">
				<div class="back-button">
					<svg width="16" height="16" viewBox="0 0 24 24">
						<path fill="currentColor" d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
					</svg>
				</div>
				<h2>All chats</h2>
				<div class="new-chat-button">New chat</div>
			</div>
			<div class="chat-history-search">
				<input type="text" placeholder="Search or start new chat">
			</div>
			<div class="chat-history-sections">
				${this.renderChatHistorySections()}
			</div>
		`;
    this.chatContainer.appendChild(historyView);
    const backBtn = historyView.querySelector(".back-button");
    backBtn == null ? void 0 : backBtn.addEventListener("click", () => {
      historyView.classList.add("closing");
      setTimeout(() => {
        historyView.remove();
        this.showMainChatView();
      }, 300);
    });
    const newChatBtn = historyView.querySelector(".new-chat-button");
    newChatBtn == null ? void 0 : newChatBtn.addEventListener("click", () => {
      this.currentSession = this.createNewSession();
      historyView.remove();
      this.showMainChatView();
    });
    this.attachHistoryItemListeners(historyView);
    const searchInput = historyView.querySelector("input");
    searchInput == null ? void 0 : searchInput.addEventListener("input", (e) => {
      const query = e.target.value;
      this.filterChatHistory(query);
    });
  }
  // Update renderHistorySection to include delete button
  renderHistorySection(title, sessions) {
    if (sessions.length === 0)
      return "";
    return `
			<div class="history-section">
				<h3>${title}</h3>
				${sessions.map(
      (session) => `
					<div class="history-item" data-session-id="${session.id}">
						<div class="history-item-icon">\u{1F4AC}</div>
						<div class="history-item-content">
							<div class="history-item-title">${session.title}</div>
							<div class="history-item-time">${this.formatTime(session.timestamp)}</div>
						</div>
						<div class="delete-chat" data-session-id="${session.id}">
							<svg width="14" height="14" viewBox="0 0 24 24">
								<path fill="currentColor" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"/>
							</svg>
						</div>
					</div>
				`
    ).join("")}
			</div>
		`;
  }
  // Add method to handle chat deletion
  deleteChat(sessionId) {
    const historyItem = this.chatContainer.querySelector(
      `.history-item[data-session-id="${sessionId}"]`
    );
    if (historyItem) {
      historyItem.classList.add("deleting");
      setTimeout(() => {
        this.settings.chatSessions = this.settings.chatSessions.filter((s) => s.id !== sessionId);
        this.saveSettings();
        historyItem.remove();
        const sectionsContainer = this.chatContainer.querySelector(".chat-history-sections");
        if (sectionsContainer) {
          sectionsContainer.innerHTML = this.renderChatHistorySections();
          this.attachHistoryItemListeners(sectionsContainer);
        }
      }, 300);
    }
  }
  // Add method to attach event listeners to history items
  attachHistoryItemListeners(historyView) {
    const deleteButtons = historyView.querySelectorAll(".delete-chat");
    deleteButtons.forEach((btn) => {
      btn.addEventListener("click", (e) => {
        e.stopPropagation();
        const sessionId = btn.getAttribute("data-session-id");
        if (sessionId) {
          this.deleteChat(sessionId);
        }
      });
    });
    const historyItems = historyView.querySelectorAll(".history-item");
    historyItems.forEach((item) => {
      item.addEventListener("click", () => {
        const sessionId = item.getAttribute("data-session-id");
        const session = this.settings.chatSessions.find((s) => s.id === sessionId);
        if (session) {
          this.currentSession = { ...session };
          this.showMainChatView();
          historyView.remove();
        }
      });
    });
  }
  // Add method to render chat history sections
  renderChatHistorySections() {
    const now = Date.now();
    const dayInMs = 24 * 60 * 60 * 1e3;
    const thirtyDaysAgo = now - 30 * dayInMs;
    const today = [];
    const past30Days = [];
    const older = [];
    this.settings.chatSessions.forEach((session) => {
      if (session.timestamp > now - dayInMs) {
        today.push(session);
      } else if (session.timestamp > thirtyDaysAgo) {
        past30Days.push(session);
      } else {
        older.push(session);
      }
    });
    return `
			${this.renderHistorySection("Today", today)}
			${this.renderHistorySection("Past 30 days", past30Days)}
			${this.renderHistorySection("Older", older)}
		`;
  }
  // Add method to format timestamp
  formatTime(timestamp) {
    const date = new Date(timestamp);
    const now = new Date();
    if (date.toDateString() === now.toDateString()) {
      return date.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
    }
    return date.toLocaleDateString();
  }
  // Update filterChatHistory method to fix search
  filterChatHistory(query) {
    const historyView = this.chatContainer.querySelector(".chat-history-view");
    if (!historyView)
      return;
    const items = historyView.querySelectorAll(".history-item");
    items.forEach((item) => {
      var _a, _b;
      const title = ((_b = (_a = item.querySelector(".history-item-title")) == null ? void 0 : _a.textContent) == null ? void 0 : _b.toLowerCase()) || "";
      if (title.includes(query.toLowerCase())) {
        ;
        item.style.display = "flex";
      } else {
        ;
        item.style.display = "none";
      }
    });
  }
  // Update showMainChatView method
  showMainChatView() {
    const elementsToShow = [".bot-info", ".chat-input-container", ".gemini-chat-messages"];
    elementsToShow.forEach((selector) => {
      const el = this.chatContainer.querySelector(selector);
      if (el)
        el.style.display = selector === ".gemini-chat-messages" ? "flex" : "block";
    });
    if (this.messagesContainer) {
      this.messagesContainer.innerHTML = "";
      if (this.currentSession) {
        this.currentSession.messages.forEach((message) => this.addMessageToChat(message));
        this.toggleSuggestedActions(false);
      } else {
        this.toggleSuggestedActions(true);
      }
    }
  }
  // Add this method to handle file selection
  async showFileSelectionModal() {
    const files = this.app.vault.getMarkdownFiles();
    const modal = new FileSelectionModal(this.app, async (file) => {
      if (file && this.inputField) {
        const content = await this.app.vault.read(file);
        const cursorPos = this.inputField.selectionStart;
        const currentValue = this.inputField.value;
        const newValue = currentValue.slice(0, cursorPos) + `@${file.basename} ` + currentValue.slice(cursorPos);
        this.inputField.value = newValue;
        this.referencedFiles = this.referencedFiles || /* @__PURE__ */ new Map();
        this.referencedFiles.set(file.basename, content);
        this.inputField.focus();
      }
    });
    modal.open();
  }
  // Add method to truncate content intelligently
  truncateContent(content) {
    if (content.length <= this.MAX_CONTEXT_LENGTH) {
      return content;
    }
    const relevantPart = content.slice(0, this.MAX_CONTEXT_LENGTH);
    const lastParagraph = relevantPart.lastIndexOf("\n\n");
    if (lastParagraph !== -1) {
      return relevantPart.slice(0, lastParagraph) + "\n\n[Content truncated for length...]";
    }
    return relevantPart + "[Content truncated for length...]";
  }
  // Add this method to format the bot's response
  async formatBotResponse(container, content) {
    const headerDiv = container.createDiv("response-header");
    const copyButton = headerDiv.createEl("button", {
      text: "Copy to new note",
      cls: "copy-response-button"
    });
    copyButton.addEventListener("click", async () => {
      const fileName = `AI Response ${new Date().toLocaleString().replace(/[/:\\]/g, "-")}`;
      const file = await this.app.vault.create(`${fileName}.md`, content);
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(file);
      new import_obsidian3.Notice("Response copied to new note!");
    });
    const contentDiv = container.createDiv("response-content");
    await import_obsidian4.MarkdownRenderer.renderMarkdown(content, contentDiv, "", this);
  }
  // Add method to generate creative titles
  generateNoteTitle(content) {
    const isQuiz = content.toLowerCase().includes("quiz") || content.toLowerCase().includes("question");
    const isSummary = content.toLowerCase().includes("summary") || content.toLowerCase().includes("summarize");
    const isTranslation = content.toLowerCase().includes("translation") || content.toLowerCase().includes("translated");
    const activeFile = this.app.workspace.getActiveFile();
    const fileName = activeFile ? activeFile.basename : "";
    let title = "";
    if (isQuiz) {
      title = `Quiz - ${fileName}`;
    } else if (isSummary) {
      title = `Summary - ${fileName}`;
    } else if (isTranslation) {
      const langMatch = content.match(/translated? to (\w+)/i);
      const language = langMatch ? langMatch[1] : "Other Language";
      title = `${language} Translation - ${fileName}`;
    } else {
      const headingMatch = content.match(/^#\s+(.+)$/m);
      if (headingMatch) {
        title = `${headingMatch[1].trim()} - ${fileName}`;
      } else {
        const firstLine = content.split("\n")[0].trim();
        if (firstLine && firstLine.length < 50) {
          title = `${firstLine} - ${fileName}`;
        } else {
          const now = new Date();
          title = `AI Response ${now.toLocaleString("en-US", {
            month: "short",
            day: "numeric",
            hour: "numeric",
            minute: "2-digit"
          })}`;
        }
      }
    }
    return title.replace(/[\\/:*?"<>|]/g, "-");
  }
  addResizeFunctionality(handle) {
    let isResizing = false;
    let startWidth;
    let startHeight;
    let startX;
    let startY;
    let startBottom;
    let startRight;
    handle.addEventListener("mousedown", (e) => {
      isResizing = true;
      startWidth = this.chatContainer.offsetWidth;
      startHeight = this.chatContainer.offsetHeight;
      startX = e.clientX;
      startY = e.clientY;
      const rect = this.chatContainer.getBoundingClientRect();
      startBottom = window.innerHeight - rect.bottom;
      startRight = window.innerWidth - rect.right;
      document.addEventListener("mousemove", handleMouseMove);
      document.addEventListener("mouseup", stopResize);
      e.preventDefault();
    });
    const handleMouseMove = (e) => {
      if (!isResizing)
        return;
      const deltaX = startX - e.clientX;
      const deltaY = startY - e.clientY;
      const newWidth = Math.min(
        Math.max(startWidth + deltaX, 380),
        // Minimum width: 380px
        800
        // Maximum width: 800px
      );
      const newHeight = Math.min(
        Math.max(startHeight + deltaY, 500),
        // Minimum height: 500px
        800
        // Maximum height: 800px
      );
      this.chatContainer.style.width = `${newWidth}px`;
      this.chatContainer.style.height = `${newHeight}px`;
      this.chatContainer.style.bottom = `${startBottom}px`;
      this.chatContainer.style.right = `${startRight}px`;
    };
    const stopResize = () => {
      isResizing = false;
      document.removeEventListener("mousemove", handleMouseMove);
      document.removeEventListener("mouseup", stopResize);
    };
  }
};
var GeminiChatbotSettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian3.Setting(containerEl).setName("Gemini API Key").setDesc("Enter your Gemini API key (stored securely)").addText((text) => {
      text.inputEl.type = "password";
      text.setPlaceholder("Enter your API key").setValue(this.plugin.settings.apiKey ? "\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022" : "").onChange(async (value) => {
        if (value !== "\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022") {
          this.plugin.settings.apiKey = this.plugin.encryptApiKey(value);
          await this.plugin.saveSettings();
          this.plugin.initializeGeminiService();
        }
      });
      const toggleButton = text.inputEl.createEl("button", {
        text: "\uFE0F",
        cls: "password-toggle"
      });
      toggleButton.style.position = "absolute";
      toggleButton.style.right = "5px";
      toggleButton.style.top = "50%";
      toggleButton.style.transform = "translateY(-50%)";
      toggleButton.style.background = "transparent";
      toggleButton.style.border = "none";
      toggleButton.style.cursor = "pointer";
      toggleButton.addEventListener("click", (e) => {
        e.preventDefault();
        text.inputEl.type = text.inputEl.type === "password" ? "text" : "password";
      });
    });
  }
};
/*! Bundled license information:

@google/generative-ai/dist/index.mjs:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@google/generative-ai/dist/index.mjs:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJub2RlX21vZHVsZXMvQGdvb2dsZS9nZW5lcmF0aXZlLWFpL2Rpc3QvaW5kZXgubWpzIiwgInNyYy9zZXJ2aWNlcy9HZW1pbmlTZXJ2aWNlLnRzIiwgInNyYy9tb2RhbHMvTGFuZ3VhZ2VTZWxlY3Rpb25Nb2RhbC50cyIsICJzcmMvbW9kYWxzL0ZpbGVTZWxlY3Rpb25Nb2RhbC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBOb3RpY2UsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgeyBHZW1pbmlTZXJ2aWNlIH0gZnJvbSBcIi4vc3JjL3NlcnZpY2VzL0dlbWluaVNlcnZpY2VcIlxuaW1wb3J0IHsgTGFuZ3VhZ2VTZWxlY3Rpb25Nb2RhbCB9IGZyb20gXCIuL3NyYy9tb2RhbHMvTGFuZ3VhZ2VTZWxlY3Rpb25Nb2RhbFwiXG5pbXBvcnQgeyBNYXJrZG93blJlbmRlcmVyIH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCB7IEZpbGVTZWxlY3Rpb25Nb2RhbCB9IGZyb20gXCIuL3NyYy9tb2RhbHMvRmlsZVNlbGVjdGlvbk1vZGFsXCJcblxuLy8gQ29yZSBpbnRlcmZhY2VzIGZvciBjaGF0IGZ1bmN0aW9uYWxpdHlcbmludGVyZmFjZSBDaGF0TWVzc2FnZSB7XG5cdHJvbGU6IFwidXNlclwiIHwgXCJib3RcIlxuXHRjb250ZW50OiBzdHJpbmdcblx0dGltZXN0YW1wOiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIENoYXRTZXNzaW9uIHtcblx0aWQ6IHN0cmluZ1xuXHR0aXRsZTogc3RyaW5nXG5cdHRpbWVzdGFtcDogbnVtYmVyXG5cdG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXG59XG5cbmludGVyZmFjZSBHZW1pbmlDaGF0Ym90U2V0dGluZ3Mge1xuXHRhcGlLZXk6IHN0cmluZ1xuXHRmbG9hdGluZ1Bvc2l0aW9uOiB7IHg6IG51bWJlciwgeTogbnVtYmVyIH1cblx0aXNEb2NrZWQ6IGJvb2xlYW5cblx0Y2hhdFNlc3Npb25zOiBDaGF0U2Vzc2lvbltdXG59XG5cbi8vIERlZmF1bHQgcGx1Z2luIHNldHRpbmdzXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBHZW1pbmlDaGF0Ym90U2V0dGluZ3MgPSB7XG5cdGFwaUtleTogXCJcIixcblx0ZmxvYXRpbmdQb3NpdGlvbjogeyB4OiAyMCwgeTogMjAgfSxcblx0aXNEb2NrZWQ6IGZhbHNlLFxuXHRjaGF0U2Vzc2lvbnM6IFtdLFxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHZW1pbmlDaGF0Ym90UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0Ly8gQ29yZSBwbHVnaW4gcHJvcGVydGllc1xuXHRzZXR0aW5nczogR2VtaW5pQ2hhdGJvdFNldHRpbmdzXG5cdGNoYXRJY29uOiBIVE1MRWxlbWVudFxuXHRjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudFxuXHRwcml2YXRlIGdlbWluaVNlcnZpY2U6IEdlbWluaVNlcnZpY2UgfCBudWxsID0gbnVsbFxuXHRwcml2YXRlIG1lc3NhZ2VzQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsXG5cdHByaXZhdGUgaW5wdXRGaWVsZDogSFRNTFRleHRBcmVhRWxlbWVudCB8IG51bGwgPSBudWxsXG5cdHByaXZhdGUgY3VycmVudEZpbGVDb250ZW50OiBzdHJpbmcgfCBudWxsID0gbnVsbFxuXHRwcml2YXRlIGNoYXRIaXN0b3J5OiBDaGF0TWVzc2FnZVtdID0gW11cblx0cHJpdmF0ZSBpc0Z1bGxQYWdlID0gZmFsc2Vcblx0cHJpdmF0ZSBjdXJyZW50U2Vzc2lvbjogQ2hhdFNlc3Npb24gfCBudWxsID0gbnVsbFxuXHRwcml2YXRlIHJlZmVyZW5jZWRGaWxlczogTWFwPHN0cmluZywgc3RyaW5nPiB8IG51bGwgPSBudWxsXG5cdFxuXHQvLyBSYXRlIGxpbWl0aW5nIGFuZCBjb250ZXh0IG1hbmFnZW1lbnRcblx0cHJpdmF0ZSBsYXN0QXBpQ2FsbCA9IDBcblx0cHJpdmF0ZSByZWFkb25seSBBUElfQ09PTERPV04gPSAxMDAwICAvLyBQcmV2ZW50IHJhcGlkLWZpcmUgQVBJIGNhbGxzXG5cdHByaXZhdGUgcmVhZG9ubHkgTUFYX0NPTlRFWFRfTEVOR1RIID0gMzAwMDAgIC8vIFByZXZlbnQgdG9rZW4gbGltaXQgaXNzdWVzXG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdC8vIEFkZCBGb250IEF3ZXNvbWUgQ1NTXG5cdFx0Y29uc3QgZm9udEF3ZXNvbWVMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIilcblx0XHRmb250QXdlc29tZUxpbmsucmVsID0gXCJzdHlsZXNoZWV0XCJcblx0XHRmb250QXdlc29tZUxpbmsuaHJlZiA9XG5cdFx0XHRcImh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2ZvbnQtYXdlc29tZS82LjAuMC9jc3MvYWxsLm1pbi5jc3NcIlxuXHRcdGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZm9udEF3ZXNvbWVMaW5rKVxuXG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKVxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmFwaUtleSkge1xuXHRcdFx0dGhpcy5pbml0aWFsaXplR2VtaW5pU2VydmljZSgpXG5cdFx0fVxuXG5cdFx0Ly8gQWRkIHNldHRpbmdzIHRhYlxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgR2VtaW5pQ2hhdGJvdFNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKVxuXG5cdFx0Ly8gQWRkIGZsb2F0aW5nIGNoYXQgaWNvblxuXHRcdHRoaXMuYWRkRmxvYXRpbmdJY29uKClcblxuXHRcdC8vIEFkZCBjaGF0IGNvbnRhaW5lclxuXHRcdHRoaXMuYWRkQ2hhdENvbnRhaW5lcigpXG5cdH1cblxuXHRwdWJsaWMgaW5pdGlhbGl6ZUdlbWluaVNlcnZpY2UoKSB7XG5cdFx0dHJ5IHtcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmFwaUtleSkge1xuXHRcdFx0XHRjb25zdCBkZWNyeXB0ZWRLZXkgPSB0aGlzLmRlY3J5cHRBcGlLZXkodGhpcy5zZXR0aW5ncy5hcGlLZXkpXG5cdFx0XHRcdHRoaXMuZ2VtaW5pU2VydmljZSA9IG5ldyBHZW1pbmlTZXJ2aWNlKGRlY3J5cHRlZEtleSlcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBpbml0aWFsaXplIEdlbWluaSBzZXJ2aWNlOlwiLCBlcnJvcilcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGhhbmRsZU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nKSB7XG5cdFx0aWYgKCF0aGlzLmdlbWluaVNlcnZpY2UgfHwgIW1lc3NhZ2UudHJpbSgpKSByZXR1cm5cblxuXHRcdC8vIENoZWNrIEFQSSBjb29sZG93blxuXHRcdGNvbnN0IG5vdyA9IERhdGUubm93KClcblx0XHRpZiAobm93IC0gdGhpcy5sYXN0QXBpQ2FsbCA8IHRoaXMuQVBJX0NPT0xET1dOKSB7XG5cdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShcIlBsZWFzZSB3YWl0IGEgbW9tZW50IGJlZm9yZSBzZW5kaW5nIGFub3RoZXIgbWVzc2FnZVwiKVxuXHRcdFx0cmV0dXJuXG5cdFx0fVxuXG5cdFx0dGhpcy50b2dnbGVTdWdnZXN0ZWRBY3Rpb25zKGZhbHNlKVxuXG5cdFx0Ly8gQnVpbGQgY29udGV4dCBtb3JlIGVmZmljaWVudGx5XG5cdFx0bGV0IGNvbnRleHRNZXNzYWdlID0gbWVzc2FnZVxuXHRcdGxldCBjb250ZXh0ID0gXCJcIlxuXG5cdFx0Ly8gQWRkIHJlZmVyZW5jZWQgZmlsZSBjb250ZW50IGlmIGFueVxuXHRcdGNvbnN0IGZpbGVSZWZlcmVuY2VzID0gbWVzc2FnZS5tYXRjaCgvQChbXlxcc10rKS9nKVxuXHRcdGlmIChmaWxlUmVmZXJlbmNlcykge1xuXHRcdFx0Y29udGV4dE1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UoL0AoW15cXHNdKykvZywgXCJcIikudHJpbSgpXG5cdFx0XHRmb3IgKGNvbnN0IHJlZiBvZiBmaWxlUmVmZXJlbmNlcykge1xuXHRcdFx0XHRjb25zdCBmaWxlTmFtZSA9IHJlZi5zbGljZSgxKVxuXHRcdFx0XHRjb25zdCBmaWxlQ29udGVudCA9IHRoaXMucmVmZXJlbmNlZEZpbGVzPy5nZXQoZmlsZU5hbWUpXG5cdFx0XHRcdGlmIChmaWxlQ29udGVudCkge1xuXHRcdFx0XHRcdC8vIEFkZCBvbmx5IHRoZSBmaXJzdCBwYXJ0IG9mIGxvbmcgZmlsZXNcblx0XHRcdFx0XHRjb25zdCB0cnVuY2F0ZWRDb250ZW50ID0gdGhpcy50cnVuY2F0ZUNvbnRlbnQoZmlsZUNvbnRlbnQpXG5cdFx0XHRcdFx0Y29udGV4dCArPSBgXFxuUmVsZXZhbnQgY29udGVudCBmcm9tICR7ZmlsZU5hbWV9OlxcbiR7dHJ1bmNhdGVkQ29udGVudH1cXG5gXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBBZGQgY3VycmVudCBmaWxlIGNvbnRlbnQgaWYgYXZhaWxhYmxlIGFuZCBubyBzcGVjaWZpYyBmaWxlIHdhcyByZWZlcmVuY2VkXG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKClcblx0XHRpZiAoYWN0aXZlRmlsZSAmJiAhZmlsZVJlZmVyZW5jZXMpIHtcblx0XHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGFjdGl2ZUZpbGUpXG5cdFx0XHQvLyBBZGQgb25seSByZWxldmFudCBwYXJ0cyBvZiB0aGUgY3VycmVudCBmaWxlXG5cdFx0XHRjb25zdCB0cnVuY2F0ZWRDb250ZW50ID0gdGhpcy50cnVuY2F0ZUNvbnRlbnQoY29udGVudClcblx0XHRcdGNvbnRleHQgKz0gYFxcblJlbGV2YW50IGNvbnRlbnQgZnJvbSBjdXJyZW50IG5vdGU6XFxuJHt0cnVuY2F0ZWRDb250ZW50fVxcbmBcblx0XHR9XG5cblx0XHQvLyBQcmVwYXJlIHRoZSBmaW5hbCBtZXNzYWdlXG5cdFx0Y29uc3QgZmluYWxNZXNzYWdlID0gY29udGV4dCA/IGAke2NvbnRleHR9XFxuXFxuVXNlciBxdWVzdGlvbjogJHtjb250ZXh0TWVzc2FnZX1gIDogY29udGV4dE1lc3NhZ2VcblxuXHRcdGNvbnN0IHVzZXJNZXNzYWdlOiBDaGF0TWVzc2FnZSA9IHtcblx0XHRcdHJvbGU6IFwidXNlclwiLFxuXHRcdFx0Y29udGVudDogZmluYWxNZXNzYWdlLFxuXHRcdFx0dGltZXN0YW1wOiBEYXRlLm5vdygpLFxuXHRcdH1cblxuXHRcdGF3YWl0IHRoaXMuYWRkTWVzc2FnZVRvQ2hhdCh7XG5cdFx0XHQuLi51c2VyTWVzc2FnZSxcblx0XHRcdGNvbnRlbnQ6IGNvbnRleHRNZXNzYWdlLFxuXHRcdH0pXG5cblx0XHQvLyBBZGQgdHlwaW5nIGluZGljYXRvclxuXHRcdGNvbnN0IHR5cGluZ0luZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcblx0XHR0eXBpbmdJbmRpY2F0b3IuYWRkQ2xhc3MoXCJ0eXBpbmctaW5kaWNhdG9yXCIpXG5cdFx0dHlwaW5nSW5kaWNhdG9yLmlubmVySFRNTCA9IGBcblx0XHRcdDxzcGFuPjwvc3Bhbj5cblx0XHRcdDxzcGFuPjwvc3Bhbj5cblx0XHRcdDxzcGFuPjwvc3Bhbj5cblx0XHRgXG5cdFx0dGhpcy5tZXNzYWdlc0NvbnRhaW5lcj8uYXBwZW5kQ2hpbGQodHlwaW5nSW5kaWNhdG9yKVxuXG5cdFx0dHJ5IHtcblx0XHRcdHRoaXMubGFzdEFwaUNhbGwgPSBEYXRlLm5vdygpIC8vIFVwZGF0ZSBsYXN0IEFQSSBjYWxsIHRpbWVcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZW1pbmlTZXJ2aWNlLnNlbmRNZXNzYWdlKGZpbmFsTWVzc2FnZSlcblx0XHRcdHR5cGluZ0luZGljYXRvci5yZW1vdmUoKVxuXG5cdFx0XHRjb25zdCBib3RNZXNzYWdlOiBDaGF0TWVzc2FnZSA9IHtcblx0XHRcdFx0cm9sZTogXCJib3RcIixcblx0XHRcdFx0Y29udGVudDogcmVzcG9uc2UsXG5cdFx0XHRcdHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcblx0XHRcdH1cblxuXHRcdFx0YXdhaXQgdGhpcy5hZGRNZXNzYWdlVG9DaGF0KGJvdE1lc3NhZ2UpXG5cblx0XHRcdGlmICh0aGlzLmN1cnJlbnRTZXNzaW9uKSB7XG5cdFx0XHRcdGlmICh0aGlzLmN1cnJlbnRTZXNzaW9uLm1lc3NhZ2VzLmxlbmd0aCA9PT0gMikge1xuXHRcdFx0XHRcdHRoaXMuY3VycmVudFNlc3Npb24udGl0bGUgPSB0aGlzLmdlbmVyYXRlU2Vzc2lvblRpdGxlKHVzZXJNZXNzYWdlLmNvbnRlbnQpXG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmNoYXRTZXNzaW9ucyA9IFtcblx0XHRcdFx0XHR0aGlzLmN1cnJlbnRTZXNzaW9uLFxuXHRcdFx0XHRcdC4uLnRoaXMuc2V0dGluZ3MuY2hhdFNlc3Npb25zLmZpbHRlcigocykgPT4gcy5pZCAhPT0gdGhpcy5jdXJyZW50U2Vzc2lvbj8uaWQpLFxuXHRcdFx0XHRdXG5cblx0XHRcdFx0YXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHR0eXBpbmdJbmRpY2F0b3IucmVtb3ZlKClcblxuXHRcdFx0Ly8gQmV0dGVyIGVycm9yIGhhbmRsaW5nXG5cdFx0XHRsZXQgZXJyb3JNZXNzYWdlID0gXCJGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIGZyb20gR2VtaW5pXCJcblx0XHRcdGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG5cdFx0XHRcdGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwiNDI5XCIpKSB7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gXCJSYXRlIGxpbWl0IHJlYWNoZWQuIFBsZWFzZSB3YWl0IGEgbW9tZW50IGJlZm9yZSB0cnlpbmcgYWdhaW4uXCJcblx0XHRcdFx0fSBlbHNlIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwicXVvdGFcIikpIHtcblx0XHRcdFx0XHRlcnJvck1lc3NhZ2UgPSBcIkFQSSBxdW90YSBleGNlZWRlZC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIlxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShlcnJvck1lc3NhZ2UpXG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBhZGRNZXNzYWdlVG9DaGF0KG1lc3NhZ2U6IENoYXRNZXNzYWdlKSB7XG5cdFx0aWYgKCF0aGlzLm1lc3NhZ2VzQ29udGFpbmVyKSByZXR1cm5cblxuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcblx0XHRtZXNzYWdlRWwuYWRkQ2xhc3MoYGdlbWluaS1tZXNzYWdlLSR7bWVzc2FnZS5yb2xlfWApXG5cblx0XHRpZiAobWVzc2FnZS5yb2xlID09PSBcImJvdFwiKSB7XG5cdFx0XHQvLyBBZGQgY29weSBidXR0b25cblx0XHRcdGNvbnN0IGNvcHlCdXR0b24gPSBtZXNzYWdlRWwuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuXHRcdFx0XHR0ZXh0OiBcIkNvcHkgdG8gbmV3IG5vdGVcIixcblx0XHRcdFx0Y2xzOiBcImNvcHktcmVzcG9uc2UtYnV0dG9uXCIsXG5cdFx0XHR9KVxuXG5cdFx0XHRjb3B5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdC8vIEdlbmVyYXRlIGNyZWF0aXZlIHRpdGxlIGJhc2VkIG9uIGNvbnRlbnRcblx0XHRcdFx0Y29uc3QgdGl0bGUgPSB0aGlzLmdlbmVyYXRlTm90ZVRpdGxlKG1lc3NhZ2UuY29udGVudClcblx0XHRcdFx0Y29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShgJHt0aXRsZX0ubWRgLCBtZXNzYWdlLmNvbnRlbnQpXG5cdFx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSlcblx0XHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlKVxuXHRcdFx0XHRuZXcgTm90aWNlKFwiUmVzcG9uc2UgY29waWVkIHRvIG5ldyBub3RlIVwiKVxuXHRcdFx0fSlcblxuXHRcdFx0Ly8gRGlyZWN0bHkgcmVuZGVyIG1hcmtkb3duXG5cdFx0XHRhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKG1lc3NhZ2UuY29udGVudCwgbWVzc2FnZUVsLCBcIlwiLCB0aGlzKVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBGb3IgdXNlciBtZXNzYWdlcywganVzdCBzaG93IHRoZSB2aXNpYmxlIHBhcnRcblx0XHRcdGNvbnN0IHZpc2libGVDb250ZW50ID0gdGhpcy5zdHJpcENvbnRleHRGcm9tTWVzc2FnZShtZXNzYWdlLmNvbnRlbnQpXG5cdFx0XHRtZXNzYWdlRWwudGV4dENvbnRlbnQgPSB2aXNpYmxlQ29udGVudFxuXHRcdH1cblxuXHRcdHRoaXMubWVzc2FnZXNDb250YWluZXIuYXBwZW5kQ2hpbGQobWVzc2FnZUVsKVxuXHRcdHRoaXMubWVzc2FnZXNDb250YWluZXIuc2Nyb2xsVG9wID0gdGhpcy5tZXNzYWdlc0NvbnRhaW5lci5zY3JvbGxIZWlnaHRcblxuXHRcdGlmICh0aGlzLmN1cnJlbnRTZXNzaW9uKSB7XG5cdFx0XHR0aGlzLmN1cnJlbnRTZXNzaW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSlcblx0XHR9XG5cdH1cblxuXHQvLyBBZGQgbmV3IG1ldGhvZCBmb3IgdHlwaW5nIGFuaW1hdGlvblxuXHRwcml2YXRlIGFzeW5jIHR5cGVNZXNzYWdlKHRleHQ6IHN0cmluZywgY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdC8vIEZpcnN0IHJlbmRlciB0aGUgbWFya2Rvd24gYnV0IGtlZXAgaXQgaGlkZGVuXG5cdFx0YXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bih0ZXh0LCBjb250YWluZXIsIFwiXCIsIHRoaXMpXG5cdFx0Y29uc3QgZWxlbWVudHMgPSBBcnJheS5mcm9tKGNvbnRhaW5lci5jaGlsZHJlbilcblx0XHRjb250YWluZXIuZW1wdHkoKVxuXG5cdFx0Zm9yIChjb25zdCBlbGVtZW50IG9mIGVsZW1lbnRzKSB7XG5cdFx0XHRpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG5cdFx0XHRcdGlmIChlbGVtZW50LnRhZ05hbWUgPT09IFwiUFwiKSB7XG5cdFx0XHRcdFx0Ly8gRm9yIHBhcmFncmFwaHMsIHR5cGUgZWFjaCBjaGFyYWN0ZXJcblx0XHRcdFx0XHRjb25zdCB0ZXh0ID0gZWxlbWVudC50ZXh0Q29udGVudCB8fCBcIlwiXG5cdFx0XHRcdFx0Y29uc3QgcCA9IGNvbnRhaW5lci5jcmVhdGVFbChcInBcIilcblx0XHRcdFx0XHRmb3IgKGNvbnN0IGNoYXIgb2YgdGV4dCkge1xuXHRcdFx0XHRcdFx0cC50ZXh0Q29udGVudCArPSBjaGFyXG5cdFx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpIC8vIEFkanVzdCBzcGVlZCBoZXJlXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5tZXNzYWdlc0NvbnRhaW5lcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLm1lc3NhZ2VzQ29udGFpbmVyLnNjcm9sbFRvcCA9IHRoaXMubWVzc2FnZXNDb250YWluZXIuc2Nyb2xsSGVpZ2h0XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIEZvciBvdGhlciBlbGVtZW50cyAoY29kZSBibG9ja3MsIGxpc3RzLCBldGMuKSwgYWRkIHRoZW0gaW5zdGFudGx5XG5cdFx0XHRcdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKGVsZW1lbnQpXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyBBZGQgbWV0aG9kIHRvIHN0cmlwIGNvbnRleHQgZnJvbSBtZXNzYWdlc1xuXHRwcml2YXRlIHN0cmlwQ29udGV4dEZyb21NZXNzYWdlKG1lc3NhZ2U6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gUmVtb3ZlIHRoZSBjb250ZXh0IHBhcnQgZnJvbSB0aGUgbWVzc2FnZVxuXHRcdGNvbnN0IHVzZXJRdWVzdGlvbk1hdGNoID0gbWVzc2FnZS5tYXRjaCgvVXNlciBxdWVzdGlvbjogKC4qPykkL20pXG5cdFx0aWYgKHVzZXJRdWVzdGlvbk1hdGNoKSB7XG5cdFx0XHRyZXR1cm4gdXNlclF1ZXN0aW9uTWF0Y2hbMV0udHJpbSgpXG5cdFx0fVxuXHRcdHJldHVybiBtZXNzYWdlXG5cdH1cblxuXHRwcml2YXRlIGFkZEVycm9yTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcpIHtcblx0XHRpZiAoIXRoaXMubWVzc2FnZXNDb250YWluZXIpIHJldHVyblxuXG5cdFx0Y29uc3QgZXJyb3JFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcblx0XHRlcnJvckVsLmFkZENsYXNzKFwiZ2VtaW5pLW1lc3NhZ2UtZXJyb3JcIilcblx0XHRlcnJvckVsLnRleHRDb250ZW50ID0gbWVzc2FnZVxuXHRcdHRoaXMubWVzc2FnZXNDb250YWluZXIuYXBwZW5kQ2hpbGQoZXJyb3JFbClcblx0fVxuXG5cdHByaXZhdGUgYWRkRmxvYXRpbmdJY29uKCkge1xuXHRcdHRoaXMuY2hhdEljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG5cdFx0dGhpcy5jaGF0SWNvbi5hZGRDbGFzcyhcImdlbWluaS1jaGF0LWljb25cIilcblx0XHR0aGlzLmNoYXRJY29uLmlubmVySFRNTCA9IGA8c3ZnIHdpZHRoPVwiMjRcIiBoZWlnaHQ9XCIyNFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIj5cblx0XHRcdDxwYXRoIGQ9XCJNMjEgMTEuNWE4LjM4IDguMzggMCAwIDEtLjkgMy44IDguNSA4LjUgMCAwIDEtNy42IDQuNyA4LjM4IDguMzggMCAwIDEtMy44LS45TDMgMjFsMS45LTUuN2E4LjM4IDguMzggMCAwIDEtLjktMy44IDguNSA4LjUgMCAwIDEgNC43LTcuNiA4LjM4IDguMzggMCAwIDEgMy44LS45aC41YTguNDggOC40OCAwIDAgMSA4IDh2LjV6XCIvPlxuXHRcdDwvc3ZnPmBcblxuXHRcdC8vIEFkZCBjbGljayBoYW5kbGVyXG5cdFx0dGhpcy5jaGF0SWNvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHRcdFx0dGhpcy50b2dnbGVDaGF0Q29udGFpbmVyKClcblx0XHR9KVxuXG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmNoYXRJY29uKVxuXHR9XG5cblx0cHJpdmF0ZSBhZGRDaGF0Q29udGFpbmVyKCkge1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcblx0XHR0aGlzLmNoYXRDb250YWluZXIuYWRkQ2xhc3MoXCJnZW1pbmktY2hhdC1jb250YWluZXJcIilcblx0XHR0aGlzLmNoYXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG5cblx0XHQvLyBTZXQgaW5pdGlhbCBkZWZhdWx0IHNpemVcblx0XHR0aGlzLmNoYXRDb250YWluZXIuc3R5bGUud2lkdGggPSBcIjM4MHB4XCJcblx0XHR0aGlzLmNoYXRDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gXCI1OTBweFwiXG5cblx0XHQvLyBBZGQgY2hhdCBjb21wb25lbnRzXG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJnZW1pbmktY2hhdC1oZWFkZXJcIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cImN1cnJlbnQtZmlsZVwiPjwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwiY2hhdC1oZWFkZXItY29udHJvbHNcIj5cblx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwiaGlzdG9yeS1idXR0b25cIj5cblx0XHRcdFx0XHRcdDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMjBcIiBoZWlnaHQ9XCIyMFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cblx0XHRcdFx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiPjwvY2lyY2xlPlxuXHRcdFx0XHRcdFx0XHQ8cG9seWxpbmUgcG9pbnRzPVwiMTIgNiAxMiAxMiAxNiAxNFwiPjwvcG9seWxpbmU+XG5cdFx0XHRcdFx0XHQ8L3N2Zz5cblx0XHRcdFx0XHQ8L2J1dHRvbj5cblx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9yZS1idXR0b25cIj5cblx0XHRcdFx0XHRcdDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMjBcIiBoZWlnaHQ9XCIyMFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cblx0XHRcdFx0XHRcdFx0PHJlY3QgeD1cIjNcIiB5PVwiM1wiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxOFwiIHJ4PVwiMlwiIHJ5PVwiMlwiPjwvcmVjdD5cblx0XHRcdFx0XHRcdFx0PGxpbmUgeDE9XCIzXCIgeTE9XCIxMlwiIHgyPVwiMjFcIiB5Mj1cIjEyXCI+PC9saW5lPlxuXHRcdFx0XHRcdFx0XHQ8bGluZSB4MT1cIjEyXCIgeTE9XCIzXCIgeDI9XCIxMlwiIHkyPVwiMjFcIj48L2xpbmU+XG5cdFx0XHRcdFx0XHQ8L3N2Zz5cblx0XHRcdFx0XHQ8L2J1dHRvbj5cblx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwiY2xvc2UtYnV0dG9uXCI+XG5cdFx0XHRcdFx0XHQ8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjIwXCIgaGVpZ2h0PVwiMjBcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+XG5cdFx0XHRcdFx0XHRcdDxsaW5lIHgxPVwiMThcIiB5MT1cIjZcIiB4Mj1cIjZcIiB5Mj1cIjE4XCI+PC9saW5lPlxuXHRcdFx0XHRcdFx0XHQ8bGluZSB4MT1cIjZcIiB5MT1cIjZcIiB4Mj1cIjE4XCIgeTI9XCIxOFwiPjwvbGluZT5cblx0XHRcdFx0XHRcdDwvc3ZnPlxuXHRcdFx0XHRcdDwvYnV0dG9uPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdFx0XG5cdFx0XHQ8ZGl2IGNsYXNzPVwiYm90LWluZm9cIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cImJvdC1hdmF0YXJcIj5cblx0XHRcdFx0XHQ8c3ZnIHZpZXdCb3g9XCIwIDAgMTA4MCAxMDgwXCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XG5cdFx0XHRcdFx0XHQ8ZGVmcz5cblx0XHRcdFx0XHRcdFx0PGZpbHRlciBpZD1cImZpbHRlclwiIHg9XCItMjAlXCIgeT1cIi0yMCVcIiB3aWR0aD1cIjE0MCVcIiBoZWlnaHQ9XCIxNDAlXCIgZmlsdGVyVW5pdHM9XCJvYmplY3RCb3VuZGluZ0JveFwiIHByaW1pdGl2ZVVuaXRzPVwidXNlclNwYWNlT25Vc2VcIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9XCJsaW5lYXJSR0JcIj5cblx0XHRcdFx0XHRcdFx0XHQ8ZmVNb3JwaG9sb2d5IG9wZXJhdG9yPVwiZGlsYXRlXCIgcmFkaXVzPVwiMjAgMjBcIiBpbj1cIlNvdXJjZUFscGhhXCIgcmVzdWx0PVwibW9ycGhvbG9neVwiLz5cblx0XHRcdFx0XHRcdFx0XHQ8ZmVGbG9vZCBmbG9vZC1jb2xvcj1cIiNmZmZmZmZcIiBmbG9vZC1vcGFjaXR5PVwiMVwiIHJlc3VsdD1cImZsb29kXCIvPlxuXHRcdFx0XHRcdFx0XHRcdDxmZUNvbXBvc2l0ZSBpbj1cImZsb29kXCIgaW4yPVwibW9ycGhvbG9neVwiIG9wZXJhdG9yPVwiaW5cIiByZXN1bHQ9XCJjb21wb3NpdGVcIi8+XG5cdFx0XHRcdFx0XHRcdFx0PGZlTWVyZ2UgcmVzdWx0PVwibWVyZ2VcIj5cblx0XHRcdFx0XHRcdFx0XHRcdDxmZU1lcmdlTm9kZSBpbj1cImNvbXBvc2l0ZVwiIHJlc3VsdD1cIm1lcmdlTm9kZVwiLz5cblx0XHRcdFx0XHRcdFx0XHRcdDxmZU1lcmdlTm9kZSBpbj1cIlNvdXJjZUdyYXBoaWNcIiByZXN1bHQ9XCJtZXJnZU5vZGUxXCIvPlxuXHRcdFx0XHRcdFx0XHRcdDwvZmVNZXJnZT5cblx0XHRcdFx0XHRcdFx0PC9maWx0ZXI+XG5cdFx0XHRcdFx0XHQ8L2RlZnM+XG5cdFx0XHRcdFx0XHQ8ZyBpZD1cIm5vdGlvbi1hdmF0YXJcIiBmaWx0ZXI9XCJ1cmwoI2ZpbHRlcilcIj5cblx0XHRcdFx0XHRcdFx0PGcgaWQ9XCJub3Rpb24tYXZhdGFyLWZhY2VcIiBmaWxsPVwiI2ZmZmZmZlwiPlxuXHRcdFx0XHRcdFx0XHRcdDx0aXRsZT5GYWNlLyA1PC90aXRsZT5cblx0XHRcdFx0XHRcdFx0XHQ8ZyBpZD1cIkZhY2UvLTVcIiBzdHJva2U9XCJub25lXCIgc3Ryb2tlLXdpZHRoPVwiMVwiIGZpbGwtcnVsZT1cImV2ZW5vZGRcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cblx0XHRcdFx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJNNTMyLDM3OSBDNjY0LjU0ODM0LDM3OSA3NzIsNDg2LjQ1MTY2IDc3Miw2MTkgQzc3Miw3NTEuNTQ4MzQgNzA0LjU0ODM0LDg1OSA1MzIsODU5IEM0MDUuODQyNTI4LDg1OSAzMzUuODY2NTYzLDgwMS41NTk1OTIgMzA3LjM1ODY2OCw3MTguODY2OTU5IEMyNjUuMzM2NzA0LDcxNi40NjQ1ODggMjMyLDY4MS42MjUzOTYgMjMyLDYzOSBDMjMyLDU5OS4xMzQ5NTYgMjYxLjE1ODg0Myw1NjYuMDgwMzI1IDI5OS4zMTIwODYsNTYwLjAwMDU1IEMzMjUuNTk5Mjk3LDQ1NS45NzkyMTMgNDE5LjgwOTkxOSwzNzkgNTMyLDM3OSBaIE0yOTUuODU4ODk1LDYyNC41NDUxODcgTDMwNC4xNDExMDUsNjU1LjQ1NDgxM1wiIGlkPVwiUGF0aFwiIHN0cm9rZT1cIiMwMDAwMDBcIiBzdHJva2Utd2lkdGg9XCIyNFwiLz5cblx0XHRcdFx0XHRcdFx0XHQ8L2c+XG5cdFx0XHRcdFx0XHRcdDwvZz5cblx0XHRcdFx0XHRcdFx0PGcgaWQ9XCJub3Rpb24tYXZhdGFyLW5vc2VcIj5cblx0XHRcdFx0XHRcdFx0XHQ8dGl0bGU+Tm9zZS8gNTwvdGl0bGU+XG5cdFx0XHRcdFx0XHRcdFx0PGcgaWQ9XCJOb3NlLy01XCIgc3Ryb2tlPVwibm9uZVwiIHN0cm9rZS13aWR0aD1cIjFcIiBmaWxsPVwibm9uZVwiIGZpbGwtcnVsZT1cImV2ZW5vZGRcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cblx0XHRcdFx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJNNjczLDU2OCBDNjYyLjU1MTAyLDU5MC44MzYxNDcgNjU3LjMyNjUzMSw2MTMuNDE0MTI2IDY1Ny4zMjY1MzEsNjM1LjczMzkzOSBDNjU3LjMyNjUzMSw2NjkuMjEzNjU3IDY3Myw2ODYuOTkyMDU0IDY3MC4wNjEyMjQsNzAyLjU1MjU1NCBDNjY4LjEwMjA0MSw3MTIuOTI2MjIgNjUzLjA4MTYzMyw3MTQuNzU2ODY3IDYyNSw3MDguMDQ0NDk1XCIgaWQ9XCJQYXRoXCIgc3Ryb2tlPVwiIzAwMDAwMFwiIHN0cm9rZS13aWR0aD1cIjE2XCIvPlxuXHRcdFx0XHRcdFx0XHRcdDwvZz5cblx0XHRcdFx0XHRcdFx0PC9nPlxuXHRcdFx0XHRcdFx0XHQ8ZyBpZD1cIm5vdGlvbi1hdmF0YXItbW91dGhcIj5cblx0XHRcdFx0XHRcdFx0XHQ8dGl0bGU+TW91dGgvIDE8L3RpdGxlPlxuXHRcdFx0XHRcdFx0XHRcdDxnIGlkPVwiTW91dGgvLTFcIiBzdHJva2U9XCJub25lXCIgc3Ryb2tlLXdpZHRoPVwiMVwiIGZpbGw9XCJub25lXCIgZmlsbC1ydWxlPVwiZXZlbm9kZFwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPlxuXHRcdFx0XHRcdFx0XHRcdFx0PHBhdGggZD1cIk01NDksNzU5IEM1NzUuMTI5NzksNzczLjY2NjY2NyA2MDMuMTI5NzksNzgxIDYzMyw3ODEgQzY2Mi44NzAyMSw3ODEgNjgyLjg3MDIxLDc3My42NjY2NjcgNjkzLDc1OVwiIGlkPVwiUGF0aFwiIHN0cm9rZT1cIiMwMDAwMDBcIiBzdHJva2Utd2lkdGg9XCIxNlwiLz5cblx0XHRcdFx0XHRcdFx0XHQ8L2c+XG5cdFx0XHRcdFx0XHRcdDwvZz5cblx0XHRcdFx0XHRcdFx0PGcgaWQ9XCJub3Rpb24tYXZhdGFyLWV5ZXNcIj5cblx0XHRcdFx0XHRcdFx0XHQ8dGl0bGU+RXllcy8gNzwvdGl0bGU+XG5cdFx0XHRcdFx0XHRcdFx0PGcgaWQ9XCJFeWVzLy03XCIgc3Ryb2tlPVwibm9uZVwiIHN0cm9rZS13aWR0aD1cIjFcIiBmaWxsPVwibm9uZVwiIGZpbGwtcnVsZT1cImV2ZW5vZGRcIj5cblx0XHRcdFx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJNNTcwLDUxNiBDNTc4LjgzNjU1Niw1MTYgNTg2LDUyNi43NDUxNjYgNTg2LDU0MCBDNTg2LDU1My4yNTQ4MzQgNTc4LjgzNjU1Niw1NjQgNTcwLDU2NCBDNTYxLjE2MzQ0NCw1NjQgNTU0LDU1My4yNTQ4MzQgNTU0LDU0MCBDNTU0LDUyNi43NDUxNjYgNTYxLjE2MzQ0NCw1MTYgNTcwLDUxNiBaIE03MDgsNTE2IEM3MTYuODM2NTU2LDUxNiA3MjQsNTI2Ljc0NTE2NiA3MjQsNTQwIEM3MjQsNTUzLjI1NDgzNCA3MTYuODM2NTU2LDU2NCA3MDgsNTY0IEM2OTkuMTYzNDQ0LDU2NCA2OTIsNTUzLjI1NDgzNCA2OTIsNTQwIEM2OTIsNTI2Ljc0NTE2NiA2OTkuMTYzNDQ0LDUxNiA3MDgsNTE2IFogTTU2OCw1MjcgQzU2NC42ODYyOTIsNTI3IDU2Miw1MjkuNjg2MjkyIDU2Miw1MzMgQzU2Miw1MzYuMzEzNzA4IDU2NC42ODYyOTIsNTM5IDU2OCw1MzkgQzU3MS4zMTM3MDgsNTM5IDU3NCw1MzYuMzEzNzA4IDU3NCw1MzMgQzU3NCw1MjkuNjg2MjkyIDU3MS4zMTM3MDgsNTI3IDU2OCw1MjcgWiBNNzA2LDUyNyBDNzAyLjY4NjI5Miw1MjcgNzAwLDUyOS42ODYyOTIgNzAwLDUzMyBDNzAwLDUzNi4zMTM3MDggNzAyLjY4NjI5Miw1MzkgNzA2LDUzOSBDNzA5LjMxMzcwOCw1MzkgNzEyLDUzNi4zMTM3MDggNzEyLDUzMyBDNzEyLDUyOS42ODYyOTIgNzA5LjMxMzcwOCw1MjcgNzA2LDUyNyBaXCIgaWQ9XCJDb21iaW5lZC1TaGFwZVwiIGZpbGw9XCIjMDAwMDAwXCIvPlxuXHRcdFx0XHRcdFx0XHRcdDwvZz5cblx0XHRcdFx0XHRcdFx0PC9nPlxuXHRcdFx0XHRcdFx0XHQ8ZyBpZD1cIm5vdGlvbi1hdmF0YXItZXllYnJvd3NcIj5cblx0XHRcdFx0XHRcdFx0XHQ8dGl0bGU+RXllYnJvd3MvIDE8L3RpdGxlPlxuXHRcdFx0XHRcdFx0XHRcdDxnIGlkPVwiRXllYnJvd3MvLTFcIiBzdHJva2U9XCJub25lXCIgc3Ryb2tlLXdpZHRoPVwiMVwiIGZpbGw9XCJub25lXCIgZmlsbC1ydWxlPVwiZXZlbm9kZFwiIHN0cm9rZS1saW5lY2FwPVwic3F1YXJlXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cblx0XHRcdFx0XHRcdFx0XHRcdDxnIGlkPVwiR3JvdXBcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoNTIxLjAwMDAwMCwgNDkwLjAwMDAwMClcIiBzdHJva2U9XCIjMDAwMDAwXCIgc3Ryb2tlLXdpZHRoPVwiMjBcIj5cblx0XHRcdFx0XHRcdFx0XHRcdFx0PHBhdGggZD1cIk0wLDE2IEMxMi44ODg4ODg5LDUuMzMzMzMzMzMgMjcuODg4ODg4OSwwIDQ1LDAgQzYyLjExMTExMTEsMCA3Ny4xMTExMTExLDUuMzMzMzMzMzMgOTAsMTZcIiBpZD1cIlBhdGhcIi8+XG5cdFx0XHRcdFx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTQ2LDE2IEMxNTguODg4ODg5LDUuMzMzMzMzMzMgMTczLjg4ODg4OSwwIDE5MSwwIEMyMDguMTExMTExLDAgMjIzLjExMTExMSw1LjMzMzMzMzMzIDIzNiwxNlwiIGlkPVwiUGF0aFwiLz5cblx0XHRcdFx0XHRcdFx0XHRcdDwvZz5cblx0XHRcdFx0XHRcdFx0XHQ8L2c+XG5cdFx0XHRcdFx0XHRcdDwvZz5cblx0XHRcdFx0XHRcdFx0PGcgaWQ9XCJub3Rpb24tYXZhdGFyLWhhaXJcIj5cblx0XHRcdFx0XHRcdFx0XHQ8dGl0bGU+SGFpcnN0eWxlLyAyNTwvdGl0bGU+XG5cdFx0XHRcdFx0XHRcdFx0PGcgaWQ9XCJIYWlyc3R5bGUvLTI1XCIgc3Ryb2tlPVwibm9uZVwiIHN0cm9rZS13aWR0aD1cIjFcIiBmaWxsPVwibm9uZVwiIGZpbGwtcnVsZT1cImV2ZW5vZGRcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj5cblx0XHRcdFx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJNMjI3LDE1MSBDMjkxLDE0MyAzNDQuMTUyMDU5LDE2MS40ODcwMjggMzY4LjAyNDE1OCwyMTIuNjg5ODExIEM0MTAuMjM4NTI3LDE5NC40NDcxNTEgNDU5LjMwNDIzOSwxODYgNTE1LDE4NiBDNjI5LjEyNTk4MywxODYgNzAzLjc0NzUzNiwyMzYuNTk0OTM5IDc0NywzMDQgQzc3OS4wODM5ODksMzU0IDc5Mi4wODM5ODksNDIwLjY2NjY2NyA3ODYsNTA0IEw3ODIuMzQxMiw1MDMuMTYxMiBDNzIyLjkyNzA2Nyw0ODkuNDgwNCA2OTksNDg0IDY2MSw0NjAgQzYzNS42NjY2NjcsNDQ0IDYwMi4zMzMzMzMsNDE5LjY2NjY2NyA1NjEsMzg3IEM1MjQuMzMzMzMzLDQzNyA0OTUuMzMzMzMzLDQ3MCA0NzQsNDg2IEM0NDIsNTEwIDM1Nyw1NDcgMzA0LDU2NSBDMjUxLDU4MyAyMzIsNTk4IDIzMiw2NDggQzIzMiw2ODEuMzMzMzMzIDI1OC42NjY2NjcsNzA1IDMxMiw3MTkgQzMyNS45OTYyMjMsNzQ2LjAzMzE2NyAzNDAuOTk2MjIzLDc2OS4zNjY1MDEgMzU3LDc4OSBDMzczLjAwMzc3Nyw4MDguNjMzNDk5IDM5My4wMDM3NzcsODI1LjYzMzQ5OSA0MTcsODQwIEMzMzUuNjY2NjY3LDg1NS4zMzMzMzMgMjYyLjMzMzMzMyw4NTUuMzMzMzMzIDE5Nyw4NDAgQzEzMS42NjY2NjcsODI0LjY2NjY2NyA3OS4zMzMzMzMzLDc5MSA0MCw3MzkgQzk0LjY2NjY2NjcsNzM1IDEyNy42NjY2NjcsNzEwLjMzMzMzMyAxMzksNjY1IEMxNjkuNDY5MDU0LDU0My4xMjM3ODQgOTMsNTE5IDkzLDM3OSBDOTMsMjM5IDE0Ny42OTk5NTIsMTYwLjkxMjUwNiAyMjcsMTUxIFpcIiBpZD1cIlBhdGhcIiBzdHJva2U9XCIjMDAwMDAwXCIgc3Ryb2tlLXdpZHRoPVwiMTJcIiBmaWxsPVwiIzAwMDAwMFwiLz5cblx0XHRcdFx0XHRcdFx0XHQ8L2c+XG5cdFx0XHRcdFx0XHRcdDwvZz5cblx0XHRcdFx0XHRcdDwvZz5cblx0XHRcdFx0XHQ8L3N2Zz5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJib3QtZ3JlZXRpbmdcIj5IZWxsbywgSG93IGNhbiBJIGhlbHAgeW91IHRvZGF5PzwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cblx0XHRcdDxkaXYgY2xhc3M9XCJnZW1pbmktY2hhdC1tZXNzYWdlc1wiPjwvZGl2PlxuXG5cdFx0XHQ8ZGl2IGNsYXNzPVwic3VnZ2VzdGVkLWFjdGlvbnNcIj5cblx0XHRcdFx0PGgzPlN1Z2dlc3RlZDwvaDM+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJhY3Rpb24tYnV0dG9uXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJhY3Rpb24taWNvblwiPlx1RDgzRFx1RENERDwvc3Bhbj5cblx0XHRcdFx0XHRTdW1tYXJpemUgdGhpcyBwYWdlXG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwiYWN0aW9uLWJ1dHRvblwiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwiYWN0aW9uLWljb25cIj5cdUQ4M0RcdUREMEQ8L3NwYW4+XG5cdFx0XHRcdFx0QXNrIGFib3V0IHRoaXMgcGFnZVxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cImFjdGlvbi1idXR0b25cIj5cblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cImFjdGlvbi1pY29uXCI+XHVEODNEXHVEQ0RBPC9zcGFuPlxuXHRcdFx0XHRcdE1ha2UgYSBxdWl6XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwiYWN0aW9uLWJ1dHRvblwiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwiYWN0aW9uLWljb25cIj5cdUQ4M0NcdURGMTA8L3NwYW4+XG5cdFx0XHRcdFx0VHJhbnNsYXRlIHRvXG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cblx0XHRcdDxkaXYgY2xhc3M9XCJjaGF0LWlucHV0LWNvbnRhaW5lclwiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwiY2hhdC1pbnB1dC13cmFwcGVyXCI+XG5cdFx0XHRcdFx0PHRleHRhcmVhIGNsYXNzPVwiY2hhdC1pbnB1dFwiIHBsYWNlaG9sZGVyPVwiQXNrIGFueXRoaW5nIG9yIHNlbGVjdC4uLlwiPjwvdGV4dGFyZWE+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cImlucHV0LWFjdGlvbnNcIj5cblx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJtZW50aW9uLWJ1dHRvblwiPkA8L2J1dHRvbj5cblx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJzZW5kLWJ1dHRvblwiPlx1MjE5MTwvYnV0dG9uPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdGBcblxuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5jaGF0Q29udGFpbmVyKVxuXG5cdFx0Ly8gQWRkIGV2ZW50IGxpc3RlbmVycyBmb3IgdGhlIGJ1dHRvbnNcblx0XHR0aGlzLmFkZENoYXRFdmVudExpc3RlbmVycygpXG5cblx0XHQvLyBBZGQgcmVzaXplIGhhbmRsZVxuXHRcdGNvbnN0IHJlc2l6ZUhhbmRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcblx0XHRyZXNpemVIYW5kbGUuYWRkQ2xhc3MoXCJyZXNpemUtaGFuZGxlXCIpXG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmFwcGVuZENoaWxkKHJlc2l6ZUhhbmRsZSlcblxuXHRcdC8vIEFkZCByZXNpemUgZnVuY3Rpb25hbGl0eVxuXHRcdHRoaXMuYWRkUmVzaXplRnVuY3Rpb25hbGl0eShyZXNpemVIYW5kbGUpXG5cdH1cblxuXHRwcml2YXRlIGFkZENoYXRFdmVudExpc3RlbmVycygpIHtcblx0XHRjb25zdCBjbG9zZUJ1dHRvbiA9IHRoaXMuY2hhdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmNsb3NlLWJ1dHRvblwiKVxuXHRcdGNsb3NlQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHRcdFx0dGhpcy50b2dnbGVDaGF0Q29udGFpbmVyKClcblx0XHR9KVxuXG5cdFx0Y29uc3Qgc2VuZEJ1dHRvbiA9IHRoaXMuY2hhdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnNlbmQtYnV0dG9uXCIpXG5cdFx0Y29uc3QgaW5wdXRGaWVsZCA9IHRoaXMuY2hhdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmNoYXQtaW5wdXRcIikgYXMgSFRNTFRleHRBcmVhRWxlbWVudFxuXHRcdHRoaXMuaW5wdXRGaWVsZCA9IGlucHV0RmllbGRcblx0XHR0aGlzLm1lc3NhZ2VzQ29udGFpbmVyID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuZ2VtaW5pLWNoYXQtbWVzc2FnZXNcIilcblxuXHRcdHNlbmRCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHRpZiAodGhpcy5pbnB1dEZpZWxkKSB7XG5cdFx0XHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLmlucHV0RmllbGQudmFsdWUudHJpbSgpXG5cdFx0XHRcdGlmIChtZXNzYWdlKSB7XG5cdFx0XHRcdFx0dGhpcy5oYW5kbGVNZXNzYWdlKG1lc3NhZ2UpXG5cdFx0XHRcdFx0dGhpcy5pbnB1dEZpZWxkLnZhbHVlID0gXCJcIlxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSlcblxuXHRcdGlucHV0RmllbGQ/LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoZS5rZXkgPT09IFwiRW50ZXJcIiAmJiAhZS5zaGlmdEtleSAmJiB0aGlzLmlucHV0RmllbGQpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpXG5cdFx0XHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLmlucHV0RmllbGQudmFsdWUudHJpbSgpXG5cdFx0XHRcdGlmIChtZXNzYWdlKSB7XG5cdFx0XHRcdFx0dGhpcy5oYW5kbGVNZXNzYWdlKG1lc3NhZ2UpXG5cdFx0XHRcdFx0dGhpcy5pbnB1dEZpZWxkLnZhbHVlID0gXCJcIlxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSlcblxuXHRcdC8vIFNpbXBsaWZ5IGFjdGlvbiBidXR0b25zIGhhbmRsZXJzXG5cdFx0Y29uc3QgYWN0aW9uQnV0dG9ucyA9IHRoaXMuY2hhdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwiLmFjdGlvbi1idXR0b25cIilcblx0XHRhY3Rpb25CdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuXHRcdFx0YnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHRcdGlmICghdGhpcy5pbnB1dEZpZWxkKSByZXR1cm5cblxuXHRcdFx0XHQvLyBTaW1wbHkgc2V0IHRoZSBpbnB1dCB2YWx1ZSBiYXNlZCBvbiB0aGUgYWN0aW9uXG5cdFx0XHRcdGlmIChidXR0b24udGV4dENvbnRlbnQ/LmluY2x1ZGVzKFwiU3VtbWFyaXplXCIpKSB7XG5cdFx0XHRcdFx0dGhpcy5pbnB1dEZpZWxkLnZhbHVlID0gXCJDYW4geW91IHN1bW1hcml6ZSB0aGlzIG5vdGUgZm9yIG1lP1wiXG5cdFx0XHRcdH0gZWxzZSBpZiAoYnV0dG9uLnRleHRDb250ZW50Py5pbmNsdWRlcyhcIkFzayBhYm91dFwiKSkge1xuXHRcdFx0XHRcdHRoaXMuaW5wdXRGaWVsZC52YWx1ZSA9IFwiV2hhdCBpcyB0aGlzIG5vdGUgYWJvdXQ/XCJcblx0XHRcdFx0fSBlbHNlIGlmIChidXR0b24udGV4dENvbnRlbnQ/LmluY2x1ZGVzKFwiTWFrZSBhIHF1aXpcIikpIHtcblx0XHRcdFx0XHR0aGlzLmlucHV0RmllbGQudmFsdWUgPSBcIkNhbiB5b3UgY3JlYXRlIGEgcXVpeiB1c2luZyB0aGlzIG5vdGU/XCJcblx0XHRcdFx0fSBlbHNlIGlmIChidXR0b24udGV4dENvbnRlbnQ/LmluY2x1ZGVzKFwiVHJhbnNsYXRlXCIpKSB7XG5cdFx0XHRcdFx0bmV3IExhbmd1YWdlU2VsZWN0aW9uTW9kYWwodGhpcy5hcHAsIChsYW5ndWFnZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5pbnB1dEZpZWxkKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuaW5wdXRGaWVsZC52YWx1ZSA9IGBDYW4geW91IHRyYW5zbGF0ZSB0aGlzIG5vdGUgdG8gJHtsYW5ndWFnZX0/YFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pLm9wZW4oKVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gRm9jdXMgdGhlIGlucHV0XG5cdFx0XHRcdHRoaXMuaW5wdXRGaWVsZC5mb2N1cygpXG5cdFx0XHR9KVxuXHRcdH0pXG5cblx0XHQvLyBVcGRhdGUgaGlzdG9yeSBidXR0b24gaGFuZGxlclxuXHRcdGNvbnN0IGhpc3RvcnlCdXR0b24gPSB0aGlzLmNoYXRDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5oaXN0b3J5LWJ1dHRvblwiKVxuXHRcdGhpc3RvcnlCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHQvLyBTaG93IGNoYXQgaGlzdG9yeSB2aWV3IGluc3RlYWQgb2YganVzdCBzaG93aW5nIG1lc3NhZ2VzXG5cdFx0XHR0aGlzLnNob3dDaGF0SGlzdG9yeVZpZXcoKVxuXHRcdH0pXG5cblx0XHQvLyBBZGQgbW9yZSBvcHRpb25zIG1lbnVcblx0XHRjb25zdCBtb3JlQnV0dG9uID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIubW9yZS1idXR0b25cIilcblx0XHRtb3JlQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgd2luZG93IGlzIGFscmVhZHkgYXQgZGVmYXVsdCBzaXplXG5cdFx0XHRpZiAoXG5cdFx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS53aWR0aCA9PT0gXCIzODBweFwiICYmXG5cdFx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS5oZWlnaHQgPT09IFwiNTkwcHhcIlxuXHRcdFx0KSB7XG5cdFx0XHRcdHJldHVyblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBBZGQgcmVzZXR0aW5nIGNsYXNzIGZvciBhbmltYXRpb25cblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwicmVzZXR0aW5nXCIpXG5cblx0XHRcdC8vIFJlc2V0IHNpemUgd2l0aCBzbW9vdGggdHJhbnNpdGlvblxuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnN0eWxlLndpZHRoID0gXCIzODBweFwiXG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gXCI1OTBweFwiXG5cblx0XHRcdC8vIFJlbW92ZSByZXNldHRpbmcgY2xhc3MgYWZ0ZXIgYW5pbWF0aW9uXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJyZXNldHRpbmdcIilcblx0XHRcdH0sIDQwMCkgLy8gTWF0Y2ggdGhlIG5ldyBhbmltYXRpb24gZHVyYXRpb25cblx0XHR9KVxuXG5cdFx0Ly8gQWRkIEAgYnV0dG9uIGhhbmRsZXJcblx0XHRjb25zdCBtZW50aW9uQnV0dG9uID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIubWVudGlvbi1idXR0b25cIilcblx0XHRtZW50aW9uQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHRcdFx0dGhpcy5zaG93RmlsZVNlbGVjdGlvbk1vZGFsKClcblx0XHR9KVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93TGFuZ3VhZ2VTZWxlY3Rpb25Nb2RhbChjb250ZW50OiBzdHJpbmcpIHtcblx0XHRuZXcgTGFuZ3VhZ2VTZWxlY3Rpb25Nb2RhbCh0aGlzLmFwcCwgKGxhbmd1YWdlOiBzdHJpbmcpID0+IHtcblx0XHRcdGlmICh0aGlzLmdlbWluaVNlcnZpY2UpIHtcblx0XHRcdFx0dGhpcy5nZW1pbmlTZXJ2aWNlXG5cdFx0XHRcdFx0LnRyYW5zbGF0ZUNvbnRlbnQoY29udGVudCwgbGFuZ3VhZ2UpXG5cdFx0XHRcdFx0LnRoZW4oKHRyYW5zbGF0aW9uKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2VUb0NoYXQoe1xuXHRcdFx0XHRcdFx0XHRyb2xlOiBcImJvdFwiLFxuXHRcdFx0XHRcdFx0XHRjb250ZW50OiB0cmFuc2xhdGlvbixcblx0XHRcdFx0XHRcdFx0dGltZXN0YW1wOiBEYXRlLm5vdygpLFxuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdC5jYXRjaCgoZXJyb3IpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKFwiVHJhbnNsYXRpb24gZmFpbGVkXCIpXG5cdFx0XHRcdFx0XHRjb25zb2xlLmVycm9yKFwiVHJhbnNsYXRpb24gZXJyb3I6XCIsIGVycm9yKVxuXHRcdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fSkub3BlbigpXG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHRvZ2dsZUNoYXRDb250YWluZXIoKSB7XG5cdFx0Y29uc3QgaXNWaXNpYmxlID0gdGhpcy5jaGF0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09IFwibm9uZVwiXG5cblx0XHRpZiAoaXNWaXNpYmxlKSB7XG5cdFx0XHQvLyBBZGQgY2xvc2luZyBhbmltYXRpb25cblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiY2xvc2luZ1wiKVxuXHRcdFx0Ly8gV2FpdCBmb3IgYW5pbWF0aW9uIHRvIGNvbXBsZXRlIGJlZm9yZSBoaWRpbmdcblx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDMwMCkpXG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImNsb3NpbmdcIilcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIlxuXHRcdFx0dGhpcy5jdXJyZW50U2Vzc2lvbiA9IHRoaXMuY3JlYXRlTmV3U2Vzc2lvbigpXG5cdFx0XHR0aGlzLnNob3dNYWluQ2hhdFZpZXcoKVxuXHRcdFx0dGhpcy50b2dnbGVTdWdnZXN0ZWRBY3Rpb25zKHRydWUpXG5cblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpXG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRGaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoYWN0aXZlRmlsZSlcblx0XHRcdFx0dGhpcy51cGRhdGVDaGF0SGVhZGVyKClcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY3VycmVudEZpbGVDb250ZW50ID0gbnVsbFxuXHRcdFx0XHR0aGlzLnVwZGF0ZUNoYXRIZWFkZXIoKVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKVxuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncylcblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXHRcdC8vIFJlbW92ZSBGb250IEF3ZXNvbWUgQ1NTXG5cdFx0Y29uc3QgZm9udEF3ZXNvbWVMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbGlua1tocmVmKj1cImZvbnQtYXdlc29tZVwiXScpXG5cdFx0aWYgKGZvbnRBd2Vzb21lTGluaykge1xuXHRcdFx0Zm9udEF3ZXNvbWVMaW5rLnJlbW92ZSgpXG5cdFx0fVxuXG5cdFx0dGhpcy5jaGF0SWNvbj8ucmVtb3ZlKClcblx0XHR0aGlzLmNoYXRDb250YWluZXI/LnJlbW92ZSgpXG5cdH1cblxuXHRwdWJsaWMgZW5jcnlwdEFwaUtleShrZXk6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIGJ0b2Eoa2V5LnNwbGl0KFwiXCIpLnJldmVyc2UoKS5qb2luKFwiXCIpKVxuXHR9XG5cblx0cHVibGljIGRlY3J5cHRBcGlLZXkoZW5jcnlwdGVkS2V5OiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHJldHVybiBhdG9iKGVuY3J5cHRlZEtleSkuc3BsaXQoXCJcIikucmV2ZXJzZSgpLmpvaW4oXCJcIilcblx0fVxuXG5cdC8vIEFkZCB0aGlzIG1ldGhvZCB0byBoYW5kbGUgc2hvd2luZy9oaWRpbmcgc3VnZ2VzdGVkIGFjdGlvbnNcblx0cHJpdmF0ZSB0b2dnbGVTdWdnZXN0ZWRBY3Rpb25zKHNob3c6IGJvb2xlYW4pIHtcblx0XHRjb25zdCBzdWdnZXN0ZWRBY3Rpb25zID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuc3VnZ2VzdGVkLWFjdGlvbnNcIikgYXMgSFRNTEVsZW1lbnRcblx0XHRpZiAoc3VnZ2VzdGVkQWN0aW9ucykge1xuXHRcdFx0c3VnZ2VzdGVkQWN0aW9ucy5zdHlsZS5kaXNwbGF5ID0gc2hvdyA/IFwiYmxvY2tcIiA6IFwibm9uZVwiXG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVDaGF0SGVhZGVyKCkge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB0aGlzLmNoYXRDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5jdXJyZW50LWZpbGVcIikgYXMgSFRNTEVsZW1lbnRcblx0XHRpZiAoaGVhZGVyRWwgJiYgYWN0aXZlRmlsZSkge1xuXHRcdFx0aGVhZGVyRWwudGV4dENvbnRlbnQgPSBhY3RpdmVGaWxlLmJhc2VuYW1lXG5cdFx0XHRoZWFkZXJFbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiXG5cdFx0fSBlbHNlIGlmIChoZWFkZXJFbCkge1xuXHRcdFx0aGVhZGVyRWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG5cdFx0fVxuXHR9XG5cblx0Ly8gQWRkIHRoaXMgbWV0aG9kIHRvIGhhbmRsZSBmdWxsIHBhZ2UgdG9nZ2xlXG5cdHByaXZhdGUgdG9nZ2xlRnVsbFBhZ2VDaGF0KCkge1xuXHRcdHRoaXMuaXNGdWxsUGFnZSA9ICF0aGlzLmlzRnVsbFBhZ2Vcblx0XHRpZiAodGhpcy5pc0Z1bGxQYWdlKSB7XG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuYWRkQ2xhc3MoXCJmdWxsLXBhZ2VcIilcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnJlbW92ZUNsYXNzKFwiZnVsbC1wYWdlXCIpXG5cdFx0fVxuXHR9XG5cblx0Ly8gQWRkIG1ldGhvZCB0byBjcmVhdGUgbmV3IGNoYXQgc2Vzc2lvblxuXHRwcml2YXRlIGNyZWF0ZU5ld1Nlc3Npb24oKTogQ2hhdFNlc3Npb24ge1xuXHRcdHJldHVybiB7XG5cdFx0XHRpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuXHRcdFx0dGl0bGU6IFwiTmV3IGNoYXRcIixcblx0XHRcdHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcblx0XHRcdG1lc3NhZ2VzOiBbXSxcblx0XHR9XG5cdH1cblxuXHQvLyBBZGQgbWV0aG9kIHRvIGdlbmVyYXRlIHNlc3Npb24gdGl0bGVcblx0cHJpdmF0ZSBnZW5lcmF0ZVNlc3Npb25UaXRsZShmaXJzdE1lc3NhZ2U6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gUmVtb3ZlIGFueSBtYXJrZG93biBmb3JtYXR0aW5nXG5cdFx0Y29uc3QgY2xlYW5NZXNzYWdlID0gZmlyc3RNZXNzYWdlLnJlcGxhY2UoL1sjKmBdL2csIFwiXCIpLnRyaW0oKVxuXG5cdFx0Ly8gQ2hlY2sgZm9yIHNwZWNpZmljIHBhdHRlcm5zIGluIHRoZSBtZXNzYWdlXG5cdFx0aWYgKGNsZWFuTWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwic3VtbWFyaXplXCIpKSB7XG5cdFx0XHRyZXR1cm4gXCJcdUQ4M0RcdURDREQgU3VtbWFyeTogXCIgKyB0aGlzLmV4dHJhY3REb2N1bWVudE5hbWUoY2xlYW5NZXNzYWdlKVxuXHRcdH1cblxuXHRcdGlmIChjbGVhbk1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInRyYW5zbGF0ZVwiKSkge1xuXHRcdFx0cmV0dXJuIFwiXHVEODNDXHVERjEwIFRyYW5zbGF0aW9uOiBcIiArIHRoaXMuZXh0cmFjdERvY3VtZW50TmFtZShjbGVhbk1lc3NhZ2UpXG5cdFx0fVxuXG5cdFx0aWYgKFxuXHRcdFx0Y2xlYW5NZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJhY3Rpb24gaXRlbXNcIikgfHxcblx0XHRcdGNsZWFuTWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwidGFza3NcIilcblx0XHQpIHtcblx0XHRcdHJldHVybiBcIlx1MjcwNSBUYXNrcyBmcm9tOiBcIiArIHRoaXMuZXh0cmFjdERvY3VtZW50TmFtZShjbGVhbk1lc3NhZ2UpXG5cdFx0fVxuXG5cdFx0Ly8gRm9yIHF1ZXN0aW9uc1xuXHRcdGlmIChjbGVhbk1lc3NhZ2UuZW5kc1dpdGgoXCI/XCIpKSB7XG5cdFx0XHRyZXR1cm4gKFxuXHRcdFx0XHRcIlx1Mjc1MyBcIiArIChjbGVhbk1lc3NhZ2UubGVuZ3RoID4gNDAgPyBjbGVhbk1lc3NhZ2Uuc3Vic3RyaW5nKDAsIDQwKSArIFwiLi4uXCIgOiBjbGVhbk1lc3NhZ2UpXG5cdFx0XHQpXG5cdFx0fVxuXG5cdFx0Ly8gRm9yIGdlbmVyYWwgY2hhdCwgdHJ5IHRvIGV4dHJhY3Qga2V5IHRvcGljXG5cdFx0Y29uc3Qga2V5d29yZHMgPSB0aGlzLmV4dHJhY3RLZXl3b3JkcyhjbGVhbk1lc3NhZ2UpXG5cdFx0aWYgKGtleXdvcmRzKSB7XG5cdFx0XHRyZXR1cm4gXCJcdUQ4M0RcdURDQUQgQ2hhdCBhYm91dCBcIiArIGtleXdvcmRzXG5cdFx0fVxuXG5cdFx0Ly8gRmFsbGJhY2sgdG8gZGVmYXVsdCB3aXRoIHRpbWVzdGFtcFxuXHRcdHJldHVybiAoXG5cdFx0XHRcIlx1RDgzRFx1RENBQyBDaGF0IGZyb20gXCIgK1xuXHRcdFx0bmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoW10sIHtcblx0XHRcdFx0aG91cjogXCIyLWRpZ2l0XCIsXG5cdFx0XHRcdG1pbnV0ZTogXCIyLWRpZ2l0XCIsXG5cdFx0XHR9KVxuXHRcdClcblx0fVxuXG5cdHByaXZhdGUgZXh0cmFjdERvY3VtZW50TmFtZShtZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIFRyeSB0byBmaW5kIHRoZSBkb2N1bWVudCBuYW1lIGluIHRoZSBtZXNzYWdlXG5cdFx0Y29uc3QgbGluZXMgPSBtZXNzYWdlLnNwbGl0KFwiXFxuXCIpXG5cdFx0aWYgKGxpbmVzLmxlbmd0aCA+IDEpIHtcblx0XHRcdC8vIFRha2UgdGhlIGZpcnN0IG5vbi1lbXB0eSBsaW5lIGFmdGVyIHRoZSBmaXJzdCBsaW5lXG5cdFx0XHRmb3IgKGxldCBpID0gMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGNvbnN0IGxpbmUgPSBsaW5lc1tpXS50cmltKClcblx0XHRcdFx0aWYgKGxpbmUpIHtcblx0XHRcdFx0XHRyZXR1cm4gbGluZS5sZW5ndGggPiAzMCA/IGxpbmUuc3Vic3RyaW5nKDAsIDMwKSArIFwiLi4uXCIgOiBsaW5lXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIFwiRG9jdW1lbnRcIlxuXHR9XG5cblx0cHJpdmF0ZSBleHRyYWN0S2V5d29yZHMobWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHQvLyBSZW1vdmUgY29tbW9uIHdvcmRzIGFuZCBnZXQga2V5IHRvcGljc1xuXHRcdGNvbnN0IGNvbW1vbldvcmRzID0gbmV3IFNldChbXG5cdFx0XHRcInRoZVwiLFxuXHRcdFx0XCJiZVwiLFxuXHRcdFx0XCJ0b1wiLFxuXHRcdFx0XCJvZlwiLFxuXHRcdFx0XCJhbmRcIixcblx0XHRcdFwiYVwiLFxuXHRcdFx0XCJpblwiLFxuXHRcdFx0XCJ0aGF0XCIsXG5cdFx0XHRcImhhdmVcIixcblx0XHRcdFwiaVwiLFxuXHRcdFx0XCJpdFwiLFxuXHRcdFx0XCJmb3JcIixcblx0XHRcdFwibm90XCIsXG5cdFx0XHRcIm9uXCIsXG5cdFx0XHRcIndpdGhcIixcblx0XHRcdFwiaGVcIixcblx0XHRcdFwiYXNcIixcblx0XHRcdFwieW91XCIsXG5cdFx0XHRcImRvXCIsXG5cdFx0XHRcImF0XCIsXG5cdFx0XHRcInRoaXNcIixcblx0XHRcdFwiYnV0XCIsXG5cdFx0XHRcImhpc1wiLFxuXHRcdFx0XCJieVwiLFxuXHRcdFx0XCJmcm9tXCIsXG5cdFx0XHRcInRoZXlcIixcblx0XHRcdFwid2VcIixcblx0XHRcdFwic2F5XCIsXG5cdFx0XHRcImhlclwiLFxuXHRcdFx0XCJzaGVcIixcblx0XHRcdFwib3JcIixcblx0XHRcdFwiYW5cIixcblx0XHRcdFwid2lsbFwiLFxuXHRcdFx0XCJteVwiLFxuXHRcdFx0XCJvbmVcIixcblx0XHRcdFwiYWxsXCIsXG5cdFx0XHRcIndvdWxkXCIsXG5cdFx0XHRcInRoZXJlXCIsXG5cdFx0XHRcInRoZWlyXCIsXG5cdFx0XHRcIndoYXRcIixcblx0XHRcdFwic29cIixcblx0XHRcdFwidXBcIixcblx0XHRcdFwib3V0XCIsXG5cdFx0XHRcImlmXCIsXG5cdFx0XHRcImFib3V0XCIsXG5cdFx0XHRcIndob1wiLFxuXHRcdFx0XCJnZXRcIixcblx0XHRcdFwid2hpY2hcIixcblx0XHRcdFwiZ29cIixcblx0XHRcdFwibWVcIixcblx0XHRcdFwicGxlYXNlXCIsXG5cdFx0XHRcImNvdWxkXCIsXG5cdFx0XHRcImNhblwiLFxuXHRcdFx0XCJqdXN0XCIsXG5cdFx0XSlcblxuXHRcdC8vIFNwbGl0IG1lc3NhZ2UgaW50byB3b3JkcyBhbmQgZmlsdGVyXG5cdFx0Y29uc3Qgd29yZHMgPSBtZXNzYWdlXG5cdFx0XHQudG9Mb3dlckNhc2UoKVxuXHRcdFx0LnJlcGxhY2UoL1teXFx3XFxzXS9nLCBcIlwiKVxuXHRcdFx0LnNwbGl0KC9cXHMrLylcblx0XHRcdC5maWx0ZXIoKHdvcmQpID0+ICFjb21tb25Xb3Jkcy5oYXMod29yZCkgJiYgd29yZC5sZW5ndGggPiAyKVxuXHRcdFx0LnNsaWNlKDAsIDMpXG5cblx0XHRpZiAod29yZHMubGVuZ3RoID4gMCkge1xuXHRcdFx0Ly8gQ2FwaXRhbGl6ZSBmaXJzdCBsZXR0ZXJzXG5cdFx0XHRjb25zdCBmb3JtYXR0ZWRXb3JkcyA9IHdvcmRzLm1hcCgod29yZCkgPT4gd29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHdvcmQuc2xpY2UoMSkpXG5cdFx0XHRyZXR1cm4gZm9ybWF0dGVkV29yZHMuam9pbihcIiwgXCIpXG5cdFx0fVxuXG5cdFx0cmV0dXJuIFwiXCJcblx0fVxuXG5cdC8vIFVwZGF0ZSBzaG93Q2hhdEhpc3RvcnlWaWV3IG1ldGhvZFxuXHRwcml2YXRlIHNob3dDaGF0SGlzdG9yeVZpZXcoKSB7XG5cdFx0aWYgKCF0aGlzLmNoYXRDb250YWluZXIpIHJldHVyblxuXG5cdFx0Ly8gSGlkZSBhbGwgb3RoZXIgZWxlbWVudHNcblx0XHRjb25zdCBlbGVtZW50c1RvSGlkZSA9IFtcblx0XHRcdFwiLmJvdC1pbmZvXCIsXG5cdFx0XHRcIi5zdWdnZXN0ZWQtYWN0aW9uc1wiLFxuXHRcdFx0XCIuY2hhdC1pbnB1dC1jb250YWluZXJcIixcblx0XHRcdFwiLmdlbWluaS1jaGF0LW1lc3NhZ2VzXCIsXG5cdFx0XVxuXG5cdFx0ZWxlbWVudHNUb0hpZGUuZm9yRWFjaCgoc2VsZWN0b3IpID0+IHtcblx0XHRcdGNvbnN0IGVsID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpXG5cdFx0XHRpZiAoZWwpIChlbCBhcyBIVE1MRWxlbWVudCkuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG5cdFx0fSlcblxuXHRcdC8vIFJlbW92ZSBleGlzdGluZyBoaXN0b3J5IHZpZXcgaWYgYW55XG5cdFx0Y29uc3QgZXhpc3RpbmdIaXN0b3J5VmlldyA9IHRoaXMuY2hhdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmNoYXQtaGlzdG9yeS12aWV3XCIpXG5cdFx0aWYgKGV4aXN0aW5nSGlzdG9yeVZpZXcpIHtcblx0XHRcdGV4aXN0aW5nSGlzdG9yeVZpZXcuY2xhc3NMaXN0LmFkZChcImNsb3NpbmdcIilcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRleGlzdGluZ0hpc3RvcnlWaWV3LnJlbW92ZSgpXG5cdFx0XHR9LCAzMDApXG5cdFx0XHRyZXR1cm5cblx0XHR9XG5cblx0XHQvLyBDcmVhdGUgYW5kIHNob3cgaGlzdG9yeSB2aWV3XG5cdFx0Y29uc3QgaGlzdG9yeVZpZXcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG5cdFx0aGlzdG9yeVZpZXcuYWRkQ2xhc3MoXCJjaGF0LWhpc3Rvcnktdmlld1wiKVxuXHRcdGhpc3RvcnlWaWV3LmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJjaGF0LWhpc3RvcnktaGVhZGVyXCI+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJiYWNrLWJ1dHRvblwiPlxuXHRcdFx0XHRcdDxzdmcgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPlxuXHRcdFx0XHRcdFx0PHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNMjAgMTFINy44M2w1LjU5LTUuNTlMMTIgNGwtOCA4IDggOCAxLjQxLTEuNDFMNy44MyAxM0gyMHYtMnpcIi8+XG5cdFx0XHRcdFx0PC9zdmc+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8aDI+QWxsIGNoYXRzPC9oMj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5ldy1jaGF0LWJ1dHRvblwiPk5ldyBjaGF0PC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJjaGF0LWhpc3Rvcnktc2VhcmNoXCI+XG5cdFx0XHRcdDxpbnB1dCB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiU2VhcmNoIG9yIHN0YXJ0IG5ldyBjaGF0XCI+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJjaGF0LWhpc3Rvcnktc2VjdGlvbnNcIj5cblx0XHRcdFx0JHt0aGlzLnJlbmRlckNoYXRIaXN0b3J5U2VjdGlvbnMoKX1cblx0XHRcdDwvZGl2PlxuXHRcdGBcblxuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5hcHBlbmRDaGlsZChoaXN0b3J5VmlldylcblxuXHRcdC8vIEFkZCBiYWNrIGJ1dHRvbiBoYW5kbGVyIHdpdGggYW5pbWF0aW9uXG5cdFx0Y29uc3QgYmFja0J0biA9IGhpc3RvcnlWaWV3LnF1ZXJ5U2VsZWN0b3IoXCIuYmFjay1idXR0b25cIilcblx0XHRiYWNrQnRuPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHRcdFx0aGlzdG9yeVZpZXcuY2xhc3NMaXN0LmFkZChcImNsb3NpbmdcIilcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRoaXN0b3J5Vmlldy5yZW1vdmUoKVxuXHRcdFx0XHR0aGlzLnNob3dNYWluQ2hhdFZpZXcoKVxuXHRcdFx0fSwgMzAwKVxuXHRcdH0pXG5cblx0XHQvLyBBZGQgZXZlbnQgbGlzdGVuZXJzXG5cdFx0Y29uc3QgbmV3Q2hhdEJ0biA9IGhpc3RvcnlWaWV3LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LWNoYXQtYnV0dG9uXCIpXG5cdFx0bmV3Q2hhdEJ0bj8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblx0XHRcdHRoaXMuY3VycmVudFNlc3Npb24gPSB0aGlzLmNyZWF0ZU5ld1Nlc3Npb24oKVxuXHRcdFx0aGlzdG9yeVZpZXcucmVtb3ZlKClcblx0XHRcdHRoaXMuc2hvd01haW5DaGF0VmlldygpXG5cdFx0fSlcblxuXHRcdC8vIEFkZCBjbGljayBoYW5kbGVycyBmb3IgaGlzdG9yeSBpdGVtc1xuXHRcdHRoaXMuYXR0YWNoSGlzdG9yeUl0ZW1MaXN0ZW5lcnMoaGlzdG9yeVZpZXcpXG5cblx0XHRjb25zdCBzZWFyY2hJbnB1dCA9IGhpc3RvcnlWaWV3LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFwiKVxuXHRcdHNlYXJjaElucHV0Py5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcblx0XHRcdGNvbnN0IHF1ZXJ5ID0gKGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlXG5cdFx0XHR0aGlzLmZpbHRlckNoYXRIaXN0b3J5KHF1ZXJ5KVxuXHRcdH0pXG5cdH1cblxuXHQvLyBVcGRhdGUgcmVuZGVySGlzdG9yeVNlY3Rpb24gdG8gaW5jbHVkZSBkZWxldGUgYnV0dG9uXG5cdHByaXZhdGUgcmVuZGVySGlzdG9yeVNlY3Rpb24odGl0bGU6IHN0cmluZywgc2Vzc2lvbnM6IENoYXRTZXNzaW9uW10pOiBzdHJpbmcge1xuXHRcdGlmIChzZXNzaW9ucy5sZW5ndGggPT09IDApIHJldHVybiBcIlwiXG5cblx0XHRyZXR1cm4gYFxuXHRcdFx0PGRpdiBjbGFzcz1cImhpc3Rvcnktc2VjdGlvblwiPlxuXHRcdFx0XHQ8aDM+JHt0aXRsZX08L2gzPlxuXHRcdFx0XHQke3Nlc3Npb25zXG5cdFx0XHRcdFx0Lm1hcChcblx0XHRcdFx0XHRcdChzZXNzaW9uKSA9PiBgXG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cImhpc3RvcnktaXRlbVwiIGRhdGEtc2Vzc2lvbi1pZD1cIiR7c2Vzc2lvbi5pZH1cIj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJoaXN0b3J5LWl0ZW0taWNvblwiPlx1RDgzRFx1RENBQzwvZGl2PlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cImhpc3RvcnktaXRlbS1jb250ZW50XCI+XG5cdFx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJoaXN0b3J5LWl0ZW0tdGl0bGVcIj4ke3Nlc3Npb24udGl0bGV9PC9kaXY+XG5cdFx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJoaXN0b3J5LWl0ZW0tdGltZVwiPiR7dGhpcy5mb3JtYXRUaW1lKHNlc3Npb24udGltZXN0YW1wKX08L2Rpdj5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cImRlbGV0ZS1jaGF0XCIgZGF0YS1zZXNzaW9uLWlkPVwiJHtzZXNzaW9uLmlkfVwiPlxuXHRcdFx0XHRcdFx0XHQ8c3ZnIHdpZHRoPVwiMTRcIiBoZWlnaHQ9XCIxNFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cblx0XHRcdFx0XHRcdFx0XHQ8cGF0aCBmaWxsPVwiY3VycmVudENvbG9yXCIgZD1cIk02IDE5YzAgMS4xLjkgMiAyIDJoOGMxLjEgMCAyLS45IDItMlY3SDZ2MTJ6bTIuNDYtNy4xMmwxLjQxLTEuNDFMMTIgMTIuNTlsMi4xMi0yLjEyIDEuNDEgMS40MUwxMy40MSAxNGwyLjEyIDIuMTItMS40MSAxLjQxTDEyIDE1LjQxbC0yLjEyIDIuMTItMS40MS0xLjQxTDEwLjU5IDE0bC0yLjEzLTIuMTJ6TTE1LjUgNGwtMS0xaC01bC0xIDFINXYyaDE0VjR6XCIvPlxuXHRcdFx0XHRcdFx0XHQ8L3N2Zz5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRgLFxuXHRcdFx0XHRcdClcblx0XHRcdFx0XHQuam9pbihcIlwiKX1cblx0XHRcdDwvZGl2PlxuXHRcdGBcblx0fVxuXG5cdC8vIEFkZCBtZXRob2QgdG8gaGFuZGxlIGNoYXQgZGVsZXRpb25cblx0cHJpdmF0ZSBkZWxldGVDaGF0KHNlc3Npb25JZDogc3RyaW5nKSB7XG5cdFx0Y29uc3QgaGlzdG9yeUl0ZW0gPSB0aGlzLmNoYXRDb250YWluZXIucXVlcnlTZWxlY3Rvcihcblx0XHRcdGAuaGlzdG9yeS1pdGVtW2RhdGEtc2Vzc2lvbi1pZD1cIiR7c2Vzc2lvbklkfVwiXWAsXG5cdFx0KVxuXHRcdGlmIChoaXN0b3J5SXRlbSkge1xuXHRcdFx0aGlzdG9yeUl0ZW0uY2xhc3NMaXN0LmFkZChcImRlbGV0aW5nXCIpXG5cblx0XHRcdC8vIFdhaXQgZm9yIHRoZSBhbmltYXRpb24gdG8gY29tcGxldGUgYmVmb3JlIHJlbW92aW5nIHRoZSBpdGVtXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0Ly8gUmVtb3ZlIHRoZSBzZXNzaW9uIGZyb20gc2V0dGluZ3Ncblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5jaGF0U2Vzc2lvbnMgPSB0aGlzLnNldHRpbmdzLmNoYXRTZXNzaW9ucy5maWx0ZXIoKHMpID0+IHMuaWQgIT09IHNlc3Npb25JZClcblx0XHRcdFx0dGhpcy5zYXZlU2V0dGluZ3MoKVxuXG5cdFx0XHRcdC8vIFJlbW92ZSB0aGUgaXRlbSBmcm9tIHRoZSBET01cblx0XHRcdFx0aGlzdG9yeUl0ZW0ucmVtb3ZlKClcblxuXHRcdFx0XHQvLyBSZS1yZW5kZXIgdGhlIGNoYXQgaGlzdG9yeSBzZWN0aW9uc1xuXHRcdFx0XHRjb25zdCBzZWN0aW9uc0NvbnRhaW5lciA9IHRoaXMuY2hhdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmNoYXQtaGlzdG9yeS1zZWN0aW9uc1wiKVxuXHRcdFx0XHRpZiAoc2VjdGlvbnNDb250YWluZXIpIHtcblx0XHRcdFx0XHRzZWN0aW9uc0NvbnRhaW5lci5pbm5lckhUTUwgPSB0aGlzLnJlbmRlckNoYXRIaXN0b3J5U2VjdGlvbnMoKVxuXHRcdFx0XHRcdHRoaXMuYXR0YWNoSGlzdG9yeUl0ZW1MaXN0ZW5lcnMoc2VjdGlvbnNDb250YWluZXIgYXMgSFRNTEVsZW1lbnQpXG5cdFx0XHRcdH1cblx0XHRcdH0sIDMwMCkgLy8gTWF0Y2ggdGhlIGR1cmF0aW9uIG9mIHRoZSBmYWRlT3V0IGFuaW1hdGlvblxuXHRcdH1cblx0fVxuXG5cdC8vIEFkZCBtZXRob2QgdG8gYXR0YWNoIGV2ZW50IGxpc3RlbmVycyB0byBoaXN0b3J5IGl0ZW1zXG5cdHByaXZhdGUgYXR0YWNoSGlzdG9yeUl0ZW1MaXN0ZW5lcnMoaGlzdG9yeVZpZXc6IEhUTUxFbGVtZW50KSB7XG5cdFx0Ly8gRGVsZXRlIGJ1dHRvbnNcblx0XHRjb25zdCBkZWxldGVCdXR0b25zID0gaGlzdG9yeVZpZXcucXVlcnlTZWxlY3RvckFsbChcIi5kZWxldGUtY2hhdFwiKVxuXHRcdGRlbGV0ZUJ1dHRvbnMuZm9yRWFjaCgoYnRuKSA9PiB7XG5cdFx0XHRidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCkgLy8gUHJldmVudCB0cmlnZ2VyaW5nIHRoZSBoaXN0b3J5IGl0ZW0gY2xpY2tcblx0XHRcdFx0Y29uc3Qgc2Vzc2lvbklkID0gYnRuLmdldEF0dHJpYnV0ZShcImRhdGEtc2Vzc2lvbi1pZFwiKVxuXHRcdFx0XHRpZiAoc2Vzc2lvbklkKSB7XG5cdFx0XHRcdFx0dGhpcy5kZWxldGVDaGF0KHNlc3Npb25JZClcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KVxuXG5cdFx0Ly8gSGlzdG9yeSBpdGVtc1xuXHRcdGNvbnN0IGhpc3RvcnlJdGVtcyA9IGhpc3RvcnlWaWV3LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaGlzdG9yeS1pdGVtXCIpXG5cdFx0aGlzdG9yeUl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblx0XHRcdFx0Y29uc3Qgc2Vzc2lvbklkID0gaXRlbS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNlc3Npb24taWRcIilcblx0XHRcdFx0Y29uc3Qgc2Vzc2lvbiA9IHRoaXMuc2V0dGluZ3MuY2hhdFNlc3Npb25zLmZpbmQoKHMpID0+IHMuaWQgPT09IHNlc3Npb25JZClcblx0XHRcdFx0aWYgKHNlc3Npb24pIHtcblx0XHRcdFx0XHR0aGlzLmN1cnJlbnRTZXNzaW9uID0geyAuLi5zZXNzaW9uIH1cblx0XHRcdFx0XHR0aGlzLnNob3dNYWluQ2hhdFZpZXcoKVxuXHRcdFx0XHRcdGhpc3RvcnlWaWV3LnJlbW92ZSgpXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSlcblx0fVxuXG5cdC8vIEFkZCBtZXRob2QgdG8gcmVuZGVyIGNoYXQgaGlzdG9yeSBzZWN0aW9uc1xuXHRwcml2YXRlIHJlbmRlckNoYXRIaXN0b3J5U2VjdGlvbnMoKTogc3RyaW5nIHtcblx0XHRjb25zdCBub3cgPSBEYXRlLm5vdygpXG5cdFx0Y29uc3QgZGF5SW5NcyA9IDI0ICogNjAgKiA2MCAqIDEwMDBcblx0XHRjb25zdCB0aGlydHlEYXlzQWdvID0gbm93IC0gMzAgKiBkYXlJbk1zXG5cblx0XHRjb25zdCB0b2RheTogQ2hhdFNlc3Npb25bXSA9IFtdXG5cdFx0Y29uc3QgcGFzdDMwRGF5czogQ2hhdFNlc3Npb25bXSA9IFtdXG5cdFx0Y29uc3Qgb2xkZXI6IENoYXRTZXNzaW9uW10gPSBbXVxuXG5cdFx0dGhpcy5zZXR0aW5ncy5jaGF0U2Vzc2lvbnMuZm9yRWFjaCgoc2Vzc2lvbikgPT4ge1xuXHRcdFx0aWYgKHNlc3Npb24udGltZXN0YW1wID4gbm93IC0gZGF5SW5Ncykge1xuXHRcdFx0XHR0b2RheS5wdXNoKHNlc3Npb24pXG5cdFx0XHR9IGVsc2UgaWYgKHNlc3Npb24udGltZXN0YW1wID4gdGhpcnR5RGF5c0Fnbykge1xuXHRcdFx0XHRwYXN0MzBEYXlzLnB1c2goc2Vzc2lvbilcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9sZGVyLnB1c2goc2Vzc2lvbilcblx0XHRcdH1cblx0XHR9KVxuXG5cdFx0cmV0dXJuIGBcblx0XHRcdCR7dGhpcy5yZW5kZXJIaXN0b3J5U2VjdGlvbihcIlRvZGF5XCIsIHRvZGF5KX1cblx0XHRcdCR7dGhpcy5yZW5kZXJIaXN0b3J5U2VjdGlvbihcIlBhc3QgMzAgZGF5c1wiLCBwYXN0MzBEYXlzKX1cblx0XHRcdCR7dGhpcy5yZW5kZXJIaXN0b3J5U2VjdGlvbihcIk9sZGVyXCIsIG9sZGVyKX1cblx0XHRgXG5cdH1cblxuXHQvLyBBZGQgbWV0aG9kIHRvIGZvcm1hdCB0aW1lc3RhbXBcblx0cHJpdmF0ZSBmb3JtYXRUaW1lKHRpbWVzdGFtcDogbnVtYmVyKTogc3RyaW5nIHtcblx0XHRjb25zdCBkYXRlID0gbmV3IERhdGUodGltZXN0YW1wKVxuXHRcdGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcblxuXHRcdGlmIChkYXRlLnRvRGF0ZVN0cmluZygpID09PSBub3cudG9EYXRlU3RyaW5nKCkpIHtcblx0XHRcdHJldHVybiBkYXRlLnRvTG9jYWxlVGltZVN0cmluZyhbXSwgeyBob3VyOiBcIjItZGlnaXRcIiwgbWludXRlOiBcIjItZGlnaXRcIiB9KVxuXHRcdH1cblx0XHRyZXR1cm4gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKVxuXHR9XG5cblx0Ly8gVXBkYXRlIGZpbHRlckNoYXRIaXN0b3J5IG1ldGhvZCB0byBmaXggc2VhcmNoXG5cdHByaXZhdGUgZmlsdGVyQ2hhdEhpc3RvcnkocXVlcnk6IHN0cmluZykge1xuXHRcdGNvbnN0IGhpc3RvcnlWaWV3ID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuY2hhdC1oaXN0b3J5LXZpZXdcIilcblx0XHRpZiAoIWhpc3RvcnlWaWV3KSByZXR1cm5cblxuXHRcdGNvbnN0IGl0ZW1zID0gaGlzdG9yeVZpZXcucXVlcnlTZWxlY3RvckFsbChcIi5oaXN0b3J5LWl0ZW1cIilcblx0XHRpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG5cdFx0XHRjb25zdCB0aXRsZSA9IGl0ZW0ucXVlcnlTZWxlY3RvcihcIi5oaXN0b3J5LWl0ZW0tdGl0bGVcIik/LnRleHRDb250ZW50Py50b0xvd2VyQ2FzZSgpIHx8IFwiXCJcblx0XHRcdGlmICh0aXRsZS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSkge1xuXHRcdFx0XHQ7KGl0ZW0gYXMgSFRNTEVsZW1lbnQpLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIlxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0OyhpdGVtIGFzIEhUTUxFbGVtZW50KS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcblx0XHRcdH1cblx0XHR9KVxuXHR9XG5cblx0Ly8gVXBkYXRlIHNob3dNYWluQ2hhdFZpZXcgbWV0aG9kXG5cdHByaXZhdGUgc2hvd01haW5DaGF0VmlldygpIHtcblx0XHQvLyBTaG93IGFsbCBtYWluIGNoYXQgZWxlbWVudHNcblx0XHRjb25zdCBlbGVtZW50c1RvU2hvdyA9IFtcIi5ib3QtaW5mb1wiLCBcIi5jaGF0LWlucHV0LWNvbnRhaW5lclwiLCBcIi5nZW1pbmktY2hhdC1tZXNzYWdlc1wiXVxuXG5cdFx0ZWxlbWVudHNUb1Nob3cuZm9yRWFjaCgoc2VsZWN0b3IpID0+IHtcblx0XHRcdGNvbnN0IGVsID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpXG5cdFx0XHRpZiAoZWwpXG5cdFx0XHRcdChlbCBhcyBIVE1MRWxlbWVudCkuc3R5bGUuZGlzcGxheSA9IHNlbGVjdG9yID09PSBcIi5nZW1pbmktY2hhdC1tZXNzYWdlc1wiID8gXCJmbGV4XCIgOiBcImJsb2NrXCJcblx0XHR9KVxuXG5cdFx0aWYgKHRoaXMubWVzc2FnZXNDb250YWluZXIpIHtcblx0XHRcdHRoaXMubWVzc2FnZXNDb250YWluZXIuaW5uZXJIVE1MID0gXCJcIlxuXG5cdFx0XHQvLyBPbmx5IHNob3cgbWVzc2FnZXMgaWYgd2UgaGF2ZSBhIGN1cnJlbnQgc2Vzc2lvblxuXHRcdFx0aWYgKHRoaXMuY3VycmVudFNlc3Npb24pIHtcblx0XHRcdFx0dGhpcy5jdXJyZW50U2Vzc2lvbi5tZXNzYWdlcy5mb3JFYWNoKChtZXNzYWdlKSA9PiB0aGlzLmFkZE1lc3NhZ2VUb0NoYXQobWVzc2FnZSkpXG5cdFx0XHRcdHRoaXMudG9nZ2xlU3VnZ2VzdGVkQWN0aW9ucyhmYWxzZSlcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFNob3cgc3VnZ2VzdGVkIGFjdGlvbnMgZm9yIG5ldyBjaGF0XG5cdFx0XHRcdHRoaXMudG9nZ2xlU3VnZ2VzdGVkQWN0aW9ucyh0cnVlKVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIEFkZCB0aGlzIG1ldGhvZCB0byBoYW5kbGUgZmlsZSBzZWxlY3Rpb25cblx0cHJpdmF0ZSBhc3luYyBzaG93RmlsZVNlbGVjdGlvbk1vZGFsKCkge1xuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcblx0XHRjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKVxuXHRcdGNvbnN0IG1vZGFsID0gbmV3IEZpbGVTZWxlY3Rpb25Nb2RhbCh0aGlzLmFwcCwgYXN5bmMgKGZpbGUpID0+IHtcblx0XHRcdGlmIChmaWxlICYmIHRoaXMuaW5wdXRGaWVsZCkge1xuXHRcdFx0XHRjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKVxuXHRcdFx0XHQvLyBBZGQgZmlsZSByZWZlcmVuY2UgdG8gaW5wdXQgYXQgY3Vyc29yIHBvc2l0aW9uXG5cdFx0XHRcdGNvbnN0IGN1cnNvclBvcyA9IHRoaXMuaW5wdXRGaWVsZC5zZWxlY3Rpb25TdGFydFxuXHRcdFx0XHRjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLmlucHV0RmllbGQudmFsdWVcblx0XHRcdFx0Y29uc3QgbmV3VmFsdWUgPVxuXHRcdFx0XHRcdGN1cnJlbnRWYWx1ZS5zbGljZSgwLCBjdXJzb3JQb3MpICsgYEAke2ZpbGUuYmFzZW5hbWV9IGAgKyBjdXJyZW50VmFsdWUuc2xpY2UoY3Vyc29yUG9zKVxuXHRcdFx0XHR0aGlzLmlucHV0RmllbGQudmFsdWUgPSBuZXdWYWx1ZVxuXG5cdFx0XHRcdC8vIFN0b3JlIHRoZSBmaWxlIGNvbnRlbnQgdG8gYmUgdXNlZCBpbiB0aGUgcHJvbXB0XG5cdFx0XHRcdHRoaXMucmVmZXJlbmNlZEZpbGVzID0gdGhpcy5yZWZlcmVuY2VkRmlsZXMgfHwgbmV3IE1hcCgpXG5cdFx0XHRcdHRoaXMucmVmZXJlbmNlZEZpbGVzLnNldChmaWxlLmJhc2VuYW1lLCBjb250ZW50KVxuXG5cdFx0XHRcdHRoaXMuaW5wdXRGaWVsZC5mb2N1cygpXG5cdFx0XHR9XG5cdFx0fSlcblx0XHRtb2RhbC5vcGVuKClcblx0fVxuXG5cdC8vIEFkZCBtZXRob2QgdG8gdHJ1bmNhdGUgY29udGVudCBpbnRlbGxpZ2VudGx5XG5cdHByaXZhdGUgdHJ1bmNhdGVDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKGNvbnRlbnQubGVuZ3RoIDw9IHRoaXMuTUFYX0NPTlRFWFRfTEVOR1RIKSB7XG5cdFx0XHRyZXR1cm4gY29udGVudFxuXHRcdH1cblxuXHRcdC8vIFRyeSB0byBmaW5kIGEgZ29vZCBicmVha2luZyBwb2ludFxuXHRcdGNvbnN0IHJlbGV2YW50UGFydCA9IGNvbnRlbnQuc2xpY2UoMCwgdGhpcy5NQVhfQ09OVEVYVF9MRU5HVEgpXG5cdFx0Y29uc3QgbGFzdFBhcmFncmFwaCA9IHJlbGV2YW50UGFydC5sYXN0SW5kZXhPZihcIlxcblxcblwiKVxuXHRcdGlmIChsYXN0UGFyYWdyYXBoICE9PSAtMSkge1xuXHRcdFx0cmV0dXJuIHJlbGV2YW50UGFydC5zbGljZSgwLCBsYXN0UGFyYWdyYXBoKSArIFwiXFxuXFxuW0NvbnRlbnQgdHJ1bmNhdGVkIGZvciBsZW5ndGguLi5dXCJcblx0XHR9XG5cblx0XHRyZXR1cm4gcmVsZXZhbnRQYXJ0ICsgXCJbQ29udGVudCB0cnVuY2F0ZWQgZm9yIGxlbmd0aC4uLl1cIlxuXHR9XG5cblx0Ly8gQWRkIHRoaXMgbWV0aG9kIHRvIGZvcm1hdCB0aGUgYm90J3MgcmVzcG9uc2Vcblx0cHJpdmF0ZSBhc3luYyBmb3JtYXRCb3RSZXNwb25zZShjb250YWluZXI6IEhUTUxFbGVtZW50LCBjb250ZW50OiBzdHJpbmcpIHtcblx0XHQvLyBDcmVhdGUgaGVhZGVyIHdpdGggY29weSBidXR0b25cblx0XHRjb25zdCBoZWFkZXJEaXYgPSBjb250YWluZXIuY3JlYXRlRGl2KFwicmVzcG9uc2UtaGVhZGVyXCIpXG5cdFx0Y29uc3QgY29weUJ1dHRvbiA9IGhlYWRlckRpdi5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG5cdFx0XHR0ZXh0OiBcIkNvcHkgdG8gbmV3IG5vdGVcIixcblx0XHRcdGNsczogXCJjb3B5LXJlc3BvbnNlLWJ1dHRvblwiLFxuXHRcdH0pXG5cblx0XHRjb3B5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG5cdFx0XHQvLyBDcmVhdGUgbmV3IG5vdGUgd2l0aCByZXNwb25zZSBjb250ZW50XG5cdFx0XHRjb25zdCBmaWxlTmFtZSA9IGBBSSBSZXNwb25zZSAke25ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKS5yZXBsYWNlKC9bLzpcXFxcXS9nLCBcIi1cIil9YFxuXHRcdFx0Y29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShgJHtmaWxlTmFtZX0ubWRgLCBjb250ZW50KVxuXG5cdFx0XHQvLyBPcGVuIHRoZSBuZXcgZmlsZVxuXHRcdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKVxuXHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlKVxuXG5cdFx0XHQvLyBTaG93IG5vdGlmaWNhdGlvblxuXHRcdFx0bmV3IE5vdGljZShcIlJlc3BvbnNlIGNvcGllZCB0byBuZXcgbm90ZSFcIilcblx0XHR9KVxuXG5cdFx0Ly8gQ3JlYXRlIGNvbnRlbnQgY29udGFpbmVyIHdpdGggcHJvcGVyIGZvcm1hdHRpbmdcblx0XHRjb25zdCBjb250ZW50RGl2ID0gY29udGFpbmVyLmNyZWF0ZURpdihcInJlc3BvbnNlLWNvbnRlbnRcIilcblx0XHRhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKGNvbnRlbnQsIGNvbnRlbnREaXYsIFwiXCIsIHRoaXMpXG5cdH1cblxuXHQvLyBBZGQgbWV0aG9kIHRvIGdlbmVyYXRlIGNyZWF0aXZlIHRpdGxlc1xuXHRwcml2YXRlIGdlbmVyYXRlTm90ZVRpdGxlKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gVHJ5IHRvIGlkZW50aWZ5IHRoZSB0eXBlIG9mIGNvbnRlbnRcblx0XHRjb25zdCBpc1F1aXogPVxuXHRcdFx0Y29udGVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicXVpelwiKSB8fCBjb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJxdWVzdGlvblwiKVxuXHRcdGNvbnN0IGlzU3VtbWFyeSA9XG5cdFx0XHRjb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJzdW1tYXJ5XCIpIHx8IGNvbnRlbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInN1bW1hcml6ZVwiKVxuXHRcdGNvbnN0IGlzVHJhbnNsYXRpb24gPVxuXHRcdFx0Y29udGVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwidHJhbnNsYXRpb25cIikgfHwgY29udGVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwidHJhbnNsYXRlZFwiKVxuXG5cdFx0Ly8gR2V0IGN1cnJlbnQgZmlsZSBuYW1lIGlmIGF2YWlsYWJsZVxuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpXG5cdFx0Y29uc3QgZmlsZU5hbWUgPSBhY3RpdmVGaWxlID8gYWN0aXZlRmlsZS5iYXNlbmFtZSA6IFwiXCJcblxuXHRcdC8vIEdlbmVyYXRlIGJhc2UgdGl0bGUgYmFzZWQgb24gY29udGVudCB0eXBlXG5cdFx0bGV0IHRpdGxlID0gXCJcIlxuXHRcdGlmIChpc1F1aXopIHtcblx0XHRcdHRpdGxlID0gYFF1aXogLSAke2ZpbGVOYW1lfWBcblx0XHR9IGVsc2UgaWYgKGlzU3VtbWFyeSkge1xuXHRcdFx0dGl0bGUgPSBgU3VtbWFyeSAtICR7ZmlsZU5hbWV9YFxuXHRcdH0gZWxzZSBpZiAoaXNUcmFuc2xhdGlvbikge1xuXHRcdFx0Y29uc3QgbGFuZ01hdGNoID0gY29udGVudC5tYXRjaCgvdHJhbnNsYXRlZD8gdG8gKFxcdyspL2kpXG5cdFx0XHRjb25zdCBsYW5ndWFnZSA9IGxhbmdNYXRjaCA/IGxhbmdNYXRjaFsxXSA6IFwiT3RoZXIgTGFuZ3VhZ2VcIlxuXHRcdFx0dGl0bGUgPSBgJHtsYW5ndWFnZX0gVHJhbnNsYXRpb24gLSAke2ZpbGVOYW1lfWBcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRm9yIG90aGVyIHR5cGVzLCB0cnkgdG8gZXh0cmFjdCBtZWFuaW5nZnVsIGNvbnRlbnRcblx0XHRcdGNvbnN0IGhlYWRpbmdNYXRjaCA9IGNvbnRlbnQubWF0Y2goL14jXFxzKyguKykkL20pXG5cdFx0XHRpZiAoaGVhZGluZ01hdGNoKSB7XG5cdFx0XHRcdHRpdGxlID0gYCR7aGVhZGluZ01hdGNoWzFdLnRyaW0oKX0gLSAke2ZpbGVOYW1lfWBcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGZpcnN0TGluZSA9IGNvbnRlbnQuc3BsaXQoXCJcXG5cIilbMF0udHJpbSgpXG5cdFx0XHRcdGlmIChmaXJzdExpbmUgJiYgZmlyc3RMaW5lLmxlbmd0aCA8IDUwKSB7XG5cdFx0XHRcdFx0dGl0bGUgPSBgJHtmaXJzdExpbmV9IC0gJHtmaWxlTmFtZX1gXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gRmFsbGJhY2s6IFVzZSB0aW1lc3RhbXBcblx0XHRcdFx0XHRjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG5cdFx0XHRcdFx0dGl0bGUgPSBgQUkgUmVzcG9uc2UgJHtub3cudG9Mb2NhbGVTdHJpbmcoXCJlbi1VU1wiLCB7XG5cdFx0XHRcdFx0XHRtb250aDogXCJzaG9ydFwiLFxuXHRcdFx0XHRcdFx0ZGF5OiBcIm51bWVyaWNcIixcblx0XHRcdFx0XHRcdGhvdXI6IFwibnVtZXJpY1wiLFxuXHRcdFx0XHRcdFx0bWludXRlOiBcIjItZGlnaXRcIixcblx0XHRcdFx0XHR9KX1gXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBTYW5pdGl6ZSB0aGUgdGl0bGUgYnkgcmVtb3ZpbmcgaW52YWxpZCBjaGFyYWN0ZXJzXG5cdFx0cmV0dXJuIHRpdGxlLnJlcGxhY2UoL1tcXFxcLzoqP1wiPD58XS9nLCBcIi1cIilcblx0fVxuXG5cdHByaXZhdGUgYWRkUmVzaXplRnVuY3Rpb25hbGl0eShoYW5kbGU6IEhUTUxFbGVtZW50KSB7XG5cdFx0bGV0IGlzUmVzaXppbmcgPSBmYWxzZVxuXHRcdGxldCBzdGFydFdpZHRoOiBudW1iZXJcblx0XHRsZXQgc3RhcnRIZWlnaHQ6IG51bWJlclxuXHRcdGxldCBzdGFydFg6IG51bWJlclxuXHRcdGxldCBzdGFydFk6IG51bWJlclxuXHRcdGxldCBzdGFydEJvdHRvbTogbnVtYmVyXG5cdFx0bGV0IHN0YXJ0UmlnaHQ6IG51bWJlclxuXG5cdFx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGU6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdGlzUmVzaXppbmcgPSB0cnVlXG5cdFx0XHRzdGFydFdpZHRoID0gdGhpcy5jaGF0Q29udGFpbmVyLm9mZnNldFdpZHRoXG5cdFx0XHRzdGFydEhlaWdodCA9IHRoaXMuY2hhdENvbnRhaW5lci5vZmZzZXRIZWlnaHRcblx0XHRcdHN0YXJ0WCA9IGUuY2xpZW50WFxuXHRcdFx0c3RhcnRZID0gZS5jbGllbnRZXG5cblx0XHRcdC8vIFN0b3JlIHRoZSBvcmlnaW5hbCBib3R0b20gYW5kIHJpZ2h0IHBvc2l0aW9uc1xuXHRcdFx0Y29uc3QgcmVjdCA9IHRoaXMuY2hhdENvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuXHRcdFx0c3RhcnRCb3R0b20gPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSByZWN0LmJvdHRvbVxuXHRcdFx0c3RhcnRSaWdodCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gcmVjdC5yaWdodFxuXG5cdFx0XHQvLyBBZGQgZXZlbnQgbGlzdGVuZXJzXG5cdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGhhbmRsZU1vdXNlTW92ZSlcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHN0b3BSZXNpemUpXG5cblx0XHRcdC8vIFByZXZlbnQgdGV4dCBzZWxlY3Rpb24gd2hpbGUgcmVzaXppbmdcblx0XHRcdGUucHJldmVudERlZmF1bHQoKVxuXHRcdH0pXG5cblx0XHRjb25zdCBoYW5kbGVNb3VzZU1vdmUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCFpc1Jlc2l6aW5nKSByZXR1cm5cblxuXHRcdFx0Ly8gQ2FsY3VsYXRlIG5ldyBkaW1lbnNpb25zIChleHBhbmRpbmcgbGVmdHdhcmQgYW5kIHVwd2FyZClcblx0XHRcdGNvbnN0IGRlbHRhWCA9IHN0YXJ0WCAtIGUuY2xpZW50WFxuXHRcdFx0Y29uc3QgZGVsdGFZID0gc3RhcnRZIC0gZS5jbGllbnRZXG5cblx0XHRcdGNvbnN0IG5ld1dpZHRoID0gTWF0aC5taW4oXG5cdFx0XHRcdE1hdGgubWF4KHN0YXJ0V2lkdGggKyBkZWx0YVgsIDM4MCksIC8vIE1pbmltdW0gd2lkdGg6IDM4MHB4XG5cdFx0XHRcdDgwMCwgLy8gTWF4aW11bSB3aWR0aDogODAwcHhcblx0XHRcdClcblxuXHRcdFx0Y29uc3QgbmV3SGVpZ2h0ID0gTWF0aC5taW4oXG5cdFx0XHRcdE1hdGgubWF4KHN0YXJ0SGVpZ2h0ICsgZGVsdGFZLCA1MDApLCAvLyBNaW5pbXVtIGhlaWdodDogNTAwcHhcblx0XHRcdFx0ODAwLCAvLyBNYXhpbXVtIGhlaWdodDogODAwcHhcblx0XHRcdClcblxuXHRcdFx0Ly8gVXBkYXRlIGNvbnRhaW5lciBkaW1lbnNpb25zXG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc3R5bGUud2lkdGggPSBgJHtuZXdXaWR0aH1weGBcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHtuZXdIZWlnaHR9cHhgXG5cblx0XHRcdC8vIE1haW50YWluIHBvc2l0aW9uIHJlbGF0aXZlIHRvIGJvdHRvbS1yaWdodCBjb3JuZXJcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS5ib3R0b20gPSBgJHtzdGFydEJvdHRvbX1weGBcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS5yaWdodCA9IGAke3N0YXJ0UmlnaHR9cHhgXG5cdFx0fVxuXG5cdFx0Y29uc3Qgc3RvcFJlc2l6ZSA9ICgpID0+IHtcblx0XHRcdGlzUmVzaXppbmcgPSBmYWxzZVxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBoYW5kbGVNb3VzZU1vdmUpXG5cdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBzdG9wUmVzaXplKVxuXHRcdH1cblx0fVxufVxuXG5jbGFzcyBHZW1pbmlDaGF0Ym90U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IEdlbWluaUNoYXRib3RQbHVnaW5cblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBHZW1pbmlDaGF0Ym90UGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW5cblx0fVxuXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpc1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KClcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoXCJHZW1pbmkgQVBJIEtleVwiKVxuXHRcdFx0LnNldERlc2MoXCJFbnRlciB5b3VyIEdlbWluaSBBUEkga2V5IChzdG9yZWQgc2VjdXJlbHkpXCIpXG5cdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwudHlwZSA9IFwicGFzc3dvcmRcIlxuXHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgeW91ciBBUEkga2V5XCIpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFwaUtleSA/IFwiXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXCIgOiBcIlwiKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdGlmICh2YWx1ZSAhPT0gXCJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcIikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlLZXkgPSB0aGlzLnBsdWdpbi5lbmNyeXB0QXBpS2V5KHZhbHVlKVxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5pbml0aWFsaXplR2VtaW5pU2VydmljZSgpXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSlcblxuXHRcdFx0XHQvLyBBZGQgc2hvdy9oaWRlIHBhc3N3b3JkIHRvZ2dsZVxuXHRcdFx0XHRjb25zdCB0b2dnbGVCdXR0b24gPSB0ZXh0LmlucHV0RWwuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuXHRcdFx0XHRcdHRleHQ6IFwiXHVGRTBGXCIsXG5cdFx0XHRcdFx0Y2xzOiBcInBhc3N3b3JkLXRvZ2dsZVwiLFxuXHRcdFx0XHR9KVxuXHRcdFx0XHR0b2dnbGVCdXR0b24uc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCJcblx0XHRcdFx0dG9nZ2xlQnV0dG9uLnN0eWxlLnJpZ2h0ID0gXCI1cHhcIlxuXHRcdFx0XHR0b2dnbGVCdXR0b24uc3R5bGUudG9wID0gXCI1MCVcIlxuXHRcdFx0XHR0b2dnbGVCdXR0b24uc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGVZKC01MCUpXCJcblx0XHRcdFx0dG9nZ2xlQnV0dG9uLnN0eWxlLmJhY2tncm91bmQgPSBcInRyYW5zcGFyZW50XCJcblx0XHRcdFx0dG9nZ2xlQnV0dG9uLnN0eWxlLmJvcmRlciA9IFwibm9uZVwiXG5cdFx0XHRcdHRvZ2dsZUJ1dHRvbi5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIlxuXG5cdFx0XHRcdHRvZ2dsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KClcblx0XHRcdFx0XHR0ZXh0LmlucHV0RWwudHlwZSA9IHRleHQuaW5wdXRFbC50eXBlID09PSBcInBhc3N3b3JkXCIgPyBcInRleHRcIiA6IFwicGFzc3dvcmRcIlxuXHRcdFx0XHR9KVxuXHRcdFx0fSlcblx0fVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEhhcm0gY2F0ZWdvcmllcyB0aGF0IHdvdWxkIGNhdXNlIHByb21wdHMgb3IgY2FuZGlkYXRlcyB0byBiZSBibG9ja2VkLlxuICogQHB1YmxpY1xuICovXG52YXIgSGFybUNhdGVnb3J5O1xuKGZ1bmN0aW9uIChIYXJtQ2F0ZWdvcnkpIHtcbiAgICBIYXJtQ2F0ZWdvcnlbXCJIQVJNX0NBVEVHT1JZX1VOU1BFQ0lGSUVEXCJdID0gXCJIQVJNX0NBVEVHT1JZX1VOU1BFQ0lGSUVEXCI7XG4gICAgSGFybUNhdGVnb3J5W1wiSEFSTV9DQVRFR09SWV9IQVRFX1NQRUVDSFwiXSA9IFwiSEFSTV9DQVRFR09SWV9IQVRFX1NQRUVDSFwiO1xuICAgIEhhcm1DYXRlZ29yeVtcIkhBUk1fQ0FURUdPUllfU0VYVUFMTFlfRVhQTElDSVRcIl0gPSBcIkhBUk1fQ0FURUdPUllfU0VYVUFMTFlfRVhQTElDSVRcIjtcbiAgICBIYXJtQ2F0ZWdvcnlbXCJIQVJNX0NBVEVHT1JZX0hBUkFTU01FTlRcIl0gPSBcIkhBUk1fQ0FURUdPUllfSEFSQVNTTUVOVFwiO1xuICAgIEhhcm1DYXRlZ29yeVtcIkhBUk1fQ0FURUdPUllfREFOR0VST1VTX0NPTlRFTlRcIl0gPSBcIkhBUk1fQ0FURUdPUllfREFOR0VST1VTX0NPTlRFTlRcIjtcbn0pKEhhcm1DYXRlZ29yeSB8fCAoSGFybUNhdGVnb3J5ID0ge30pKTtcbi8qKlxuICogVGhyZXNoaG9sZCBhYm92ZSB3aGljaCBhIHByb21wdCBvciBjYW5kaWRhdGUgd2lsbCBiZSBibG9ja2VkLlxuICogQHB1YmxpY1xuICovXG52YXIgSGFybUJsb2NrVGhyZXNob2xkO1xuKGZ1bmN0aW9uIChIYXJtQmxvY2tUaHJlc2hvbGQpIHtcbiAgICAvLyBUaHJlc2hvbGQgaXMgdW5zcGVjaWZpZWQuXG4gICAgSGFybUJsb2NrVGhyZXNob2xkW1wiSEFSTV9CTE9DS19USFJFU0hPTERfVU5TUEVDSUZJRURcIl0gPSBcIkhBUk1fQkxPQ0tfVEhSRVNIT0xEX1VOU1BFQ0lGSUVEXCI7XG4gICAgLy8gQ29udGVudCB3aXRoIE5FR0xJR0lCTEUgd2lsbCBiZSBhbGxvd2VkLlxuICAgIEhhcm1CbG9ja1RocmVzaG9sZFtcIkJMT0NLX0xPV19BTkRfQUJPVkVcIl0gPSBcIkJMT0NLX0xPV19BTkRfQUJPVkVcIjtcbiAgICAvLyBDb250ZW50IHdpdGggTkVHTElHSUJMRSBhbmQgTE9XIHdpbGwgYmUgYWxsb3dlZC5cbiAgICBIYXJtQmxvY2tUaHJlc2hvbGRbXCJCTE9DS19NRURJVU1fQU5EX0FCT1ZFXCJdID0gXCJCTE9DS19NRURJVU1fQU5EX0FCT1ZFXCI7XG4gICAgLy8gQ29udGVudCB3aXRoIE5FR0xJR0lCTEUsIExPVywgYW5kIE1FRElVTSB3aWxsIGJlIGFsbG93ZWQuXG4gICAgSGFybUJsb2NrVGhyZXNob2xkW1wiQkxPQ0tfT05MWV9ISUdIXCJdID0gXCJCTE9DS19PTkxZX0hJR0hcIjtcbiAgICAvLyBBbGwgY29udGVudCB3aWxsIGJlIGFsbG93ZWQuXG4gICAgSGFybUJsb2NrVGhyZXNob2xkW1wiQkxPQ0tfTk9ORVwiXSA9IFwiQkxPQ0tfTk9ORVwiO1xufSkoSGFybUJsb2NrVGhyZXNob2xkIHx8IChIYXJtQmxvY2tUaHJlc2hvbGQgPSB7fSkpO1xuLyoqXG4gKiBQcm9iYWJpbGl0eSB0aGF0IGEgcHJvbXB0IG9yIGNhbmRpZGF0ZSBtYXRjaGVzIGEgaGFybSBjYXRlZ29yeS5cbiAqIEBwdWJsaWNcbiAqL1xudmFyIEhhcm1Qcm9iYWJpbGl0eTtcbihmdW5jdGlvbiAoSGFybVByb2JhYmlsaXR5KSB7XG4gICAgLy8gUHJvYmFiaWxpdHkgaXMgdW5zcGVjaWZpZWQuXG4gICAgSGFybVByb2JhYmlsaXR5W1wiSEFSTV9QUk9CQUJJTElUWV9VTlNQRUNJRklFRFwiXSA9IFwiSEFSTV9QUk9CQUJJTElUWV9VTlNQRUNJRklFRFwiO1xuICAgIC8vIENvbnRlbnQgaGFzIGEgbmVnbGlnaWJsZSBjaGFuY2Ugb2YgYmVpbmcgdW5zYWZlLlxuICAgIEhhcm1Qcm9iYWJpbGl0eVtcIk5FR0xJR0lCTEVcIl0gPSBcIk5FR0xJR0lCTEVcIjtcbiAgICAvLyBDb250ZW50IGhhcyBhIGxvdyBjaGFuY2Ugb2YgYmVpbmcgdW5zYWZlLlxuICAgIEhhcm1Qcm9iYWJpbGl0eVtcIkxPV1wiXSA9IFwiTE9XXCI7XG4gICAgLy8gQ29udGVudCBoYXMgYSBtZWRpdW0gY2hhbmNlIG9mIGJlaW5nIHVuc2FmZS5cbiAgICBIYXJtUHJvYmFiaWxpdHlbXCJNRURJVU1cIl0gPSBcIk1FRElVTVwiO1xuICAgIC8vIENvbnRlbnQgaGFzIGEgaGlnaCBjaGFuY2Ugb2YgYmVpbmcgdW5zYWZlLlxuICAgIEhhcm1Qcm9iYWJpbGl0eVtcIkhJR0hcIl0gPSBcIkhJR0hcIjtcbn0pKEhhcm1Qcm9iYWJpbGl0eSB8fCAoSGFybVByb2JhYmlsaXR5ID0ge30pKTtcbi8qKlxuICogUmVhc29uIHRoYXQgYSBwcm9tcHQgd2FzIGJsb2NrZWQuXG4gKiBAcHVibGljXG4gKi9cbnZhciBCbG9ja1JlYXNvbjtcbihmdW5jdGlvbiAoQmxvY2tSZWFzb24pIHtcbiAgICAvLyBBIGJsb2NrZWQgcmVhc29uIHdhcyBub3Qgc3BlY2lmaWVkLlxuICAgIEJsb2NrUmVhc29uW1wiQkxPQ0tFRF9SRUFTT05fVU5TUEVDSUZJRURcIl0gPSBcIkJMT0NLRURfUkVBU09OX1VOU1BFQ0lGSUVEXCI7XG4gICAgLy8gQ29udGVudCB3YXMgYmxvY2tlZCBieSBzYWZldHkgc2V0dGluZ3MuXG4gICAgQmxvY2tSZWFzb25bXCJTQUZFVFlcIl0gPSBcIlNBRkVUWVwiO1xuICAgIC8vIENvbnRlbnQgd2FzIGJsb2NrZWQsIGJ1dCB0aGUgcmVhc29uIGlzIHVuY2F0ZWdvcml6ZWQuXG4gICAgQmxvY2tSZWFzb25bXCJPVEhFUlwiXSA9IFwiT1RIRVJcIjtcbn0pKEJsb2NrUmVhc29uIHx8IChCbG9ja1JlYXNvbiA9IHt9KSk7XG4vKipcbiAqIFJlYXNvbiB0aGF0IGEgY2FuZGlkYXRlIGZpbmlzaGVkLlxuICogQHB1YmxpY1xuICovXG52YXIgRmluaXNoUmVhc29uO1xuKGZ1bmN0aW9uIChGaW5pc2hSZWFzb24pIHtcbiAgICAvLyBEZWZhdWx0IHZhbHVlLiBUaGlzIHZhbHVlIGlzIHVudXNlZC5cbiAgICBGaW5pc2hSZWFzb25bXCJGSU5JU0hfUkVBU09OX1VOU1BFQ0lGSUVEXCJdID0gXCJGSU5JU0hfUkVBU09OX1VOU1BFQ0lGSUVEXCI7XG4gICAgLy8gTmF0dXJhbCBzdG9wIHBvaW50IG9mIHRoZSBtb2RlbCBvciBwcm92aWRlZCBzdG9wIHNlcXVlbmNlLlxuICAgIEZpbmlzaFJlYXNvbltcIlNUT1BcIl0gPSBcIlNUT1BcIjtcbiAgICAvLyBUaGUgbWF4aW11bSBudW1iZXIgb2YgdG9rZW5zIGFzIHNwZWNpZmllZCBpbiB0aGUgcmVxdWVzdCB3YXMgcmVhY2hlZC5cbiAgICBGaW5pc2hSZWFzb25bXCJNQVhfVE9LRU5TXCJdID0gXCJNQVhfVE9LRU5TXCI7XG4gICAgLy8gVGhlIGNhbmRpZGF0ZSBjb250ZW50IHdhcyBmbGFnZ2VkIGZvciBzYWZldHkgcmVhc29ucy5cbiAgICBGaW5pc2hSZWFzb25bXCJTQUZFVFlcIl0gPSBcIlNBRkVUWVwiO1xuICAgIC8vIFRoZSBjYW5kaWRhdGUgY29udGVudCB3YXMgZmxhZ2dlZCBmb3IgcmVjaXRhdGlvbiByZWFzb25zLlxuICAgIEZpbmlzaFJlYXNvbltcIlJFQ0lUQVRJT05cIl0gPSBcIlJFQ0lUQVRJT05cIjtcbiAgICAvLyBVbmtub3duIHJlYXNvbi5cbiAgICBGaW5pc2hSZWFzb25bXCJPVEhFUlwiXSA9IFwiT1RIRVJcIjtcbn0pKEZpbmlzaFJlYXNvbiB8fCAoRmluaXNoUmVhc29uID0ge30pKTtcbi8qKlxuICogVGFzayB0eXBlIGZvciBlbWJlZGRpbmcgY29udGVudC5cbiAqIEBwdWJsaWNcbiAqL1xudmFyIFRhc2tUeXBlO1xuKGZ1bmN0aW9uIChUYXNrVHlwZSkge1xuICAgIFRhc2tUeXBlW1wiVEFTS19UWVBFX1VOU1BFQ0lGSUVEXCJdID0gXCJUQVNLX1RZUEVfVU5TUEVDSUZJRURcIjtcbiAgICBUYXNrVHlwZVtcIlJFVFJJRVZBTF9RVUVSWVwiXSA9IFwiUkVUUklFVkFMX1FVRVJZXCI7XG4gICAgVGFza1R5cGVbXCJSRVRSSUVWQUxfRE9DVU1FTlRcIl0gPSBcIlJFVFJJRVZBTF9ET0NVTUVOVFwiO1xuICAgIFRhc2tUeXBlW1wiU0VNQU5USUNfU0lNSUxBUklUWVwiXSA9IFwiU0VNQU5USUNfU0lNSUxBUklUWVwiO1xuICAgIFRhc2tUeXBlW1wiQ0xBU1NJRklDQVRJT05cIl0gPSBcIkNMQVNTSUZJQ0FUSU9OXCI7XG4gICAgVGFza1R5cGVbXCJDTFVTVEVSSU5HXCJdID0gXCJDTFVTVEVSSU5HXCI7XG59KShUYXNrVHlwZSB8fCAoVGFza1R5cGUgPSB7fSkpO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgR29vZ2xlR2VuZXJhdGl2ZUFJRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgICAgICBzdXBlcihgW0dvb2dsZUdlbmVyYXRpdmVBSSBFcnJvcl06ICR7bWVzc2FnZX1gKTtcbiAgICB9XG59XG5jbGFzcyBHb29nbGVHZW5lcmF0aXZlQUlSZXNwb25zZUVycm9yIGV4dGVuZHMgR29vZ2xlR2VuZXJhdGl2ZUFJRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIHJlc3BvbnNlKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgICAgICB0aGlzLnJlc3BvbnNlID0gcmVzcG9uc2U7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgQkFTRV9VUkwgPSBcImh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tXCI7XG5jb25zdCBBUElfVkVSU0lPTiA9IFwidjFcIjtcbi8qKlxuICogV2UgY2FuJ3QgYHJlcXVpcmVgIHBhY2thZ2UuanNvbiBpZiB0aGlzIHJ1bnMgb24gd2ViLiBXZSB3aWxsIHVzZSByb2xsdXAgdG9cbiAqIHN3YXAgaW4gdGhlIHZlcnNpb24gbnVtYmVyIGhlcmUgYXQgYnVpbGQgdGltZS5cbiAqL1xuY29uc3QgUEFDS0FHRV9WRVJTSU9OID0gXCIwLjEuM1wiO1xuY29uc3QgUEFDS0FHRV9MT0dfSEVBREVSID0gXCJnZW5haS1qc1wiO1xudmFyIFRhc2s7XG4oZnVuY3Rpb24gKFRhc2spIHtcbiAgICBUYXNrW1wiR0VORVJBVEVfQ09OVEVOVFwiXSA9IFwiZ2VuZXJhdGVDb250ZW50XCI7XG4gICAgVGFza1tcIlNUUkVBTV9HRU5FUkFURV9DT05URU5UXCJdID0gXCJzdHJlYW1HZW5lcmF0ZUNvbnRlbnRcIjtcbiAgICBUYXNrW1wiQ09VTlRfVE9LRU5TXCJdID0gXCJjb3VudFRva2Vuc1wiO1xuICAgIFRhc2tbXCJFTUJFRF9DT05URU5UXCJdID0gXCJlbWJlZENvbnRlbnRcIjtcbiAgICBUYXNrW1wiQkFUQ0hfRU1CRURfQ09OVEVOVFNcIl0gPSBcImJhdGNoRW1iZWRDb250ZW50c1wiO1xufSkoVGFzayB8fCAoVGFzayA9IHt9KSk7XG5jbGFzcyBSZXF1ZXN0VXJsIHtcbiAgICBjb25zdHJ1Y3Rvcihtb2RlbCwgdGFzaywgYXBpS2V5LCBzdHJlYW0pIHtcbiAgICAgICAgdGhpcy5tb2RlbCA9IG1vZGVsO1xuICAgICAgICB0aGlzLnRhc2sgPSB0YXNrO1xuICAgICAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICAgICAgdGhpcy5zdHJlYW0gPSBzdHJlYW07XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICBsZXQgdXJsID0gYCR7QkFTRV9VUkx9LyR7QVBJX1ZFUlNJT059L21vZGVscy8ke3RoaXMubW9kZWx9OiR7dGhpcy50YXNrfWA7XG4gICAgICAgIGlmICh0aGlzLnN0cmVhbSkge1xuICAgICAgICAgICAgdXJsICs9IFwiP2FsdD1zc2VcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cbn1cbi8qKlxuICogU2ltcGxlLCBidXQgbWF5IGJlY29tZSBtb3JlIGNvbXBsZXggaWYgd2UgYWRkIG1vcmUgdmVyc2lvbnMgdG8gbG9nLlxuICovXG5mdW5jdGlvbiBnZXRDbGllbnRIZWFkZXJzKCkge1xuICAgIHJldHVybiBgJHtQQUNLQUdFX0xPR19IRUFERVJ9LyR7UEFDS0FHRV9WRVJTSU9OfWA7XG59XG5hc3luYyBmdW5jdGlvbiBtYWtlUmVxdWVzdCh1cmwsIGJvZHkpIHtcbiAgICBsZXQgcmVzcG9uc2U7XG4gICAgdHJ5IHtcbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwudG9TdHJpbmcoKSwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICBcIngtZ29vZy1hcGktY2xpZW50XCI6IGdldENsaWVudEhlYWRlcnMoKSxcbiAgICAgICAgICAgICAgICBcIngtZ29vZy1hcGkta2V5XCI6IHVybC5hcGlLZXksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGxldCBtZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0ganNvbi5lcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgICAgIGlmIChqc29uLmVycm9yLmRldGFpbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSArPSBgICR7SlNPTi5zdHJpbmdpZnkoanNvbi5lcnJvci5kZXRhaWxzKX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gaWdub3JlZFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBbJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1dICR7bWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBjb25zdCBlcnIgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJRXJyb3IoYEVycm9yIGZldGNoaW5nIGZyb20gJHt1cmwudG9TdHJpbmcoKX06ICR7ZS5tZXNzYWdlfWApO1xuICAgICAgICBlcnIuc3RhY2sgPSBlLnN0YWNrO1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICAgIHJldHVybiByZXNwb25zZTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQWRkcyBjb252ZW5pZW5jZSBoZWxwZXIgbWV0aG9kcyB0byBhIHJlc3BvbnNlIG9iamVjdCwgaW5jbHVkaW5nIHN0cmVhbVxuICogY2h1bmtzIChhcyBsb25nIGFzIGVhY2ggY2h1bmsgaXMgYSBjb21wbGV0ZSBHZW5lcmF0ZUNvbnRlbnRSZXNwb25zZSBKU09OKS5cbiAqL1xuZnVuY3Rpb24gYWRkSGVscGVycyhyZXNwb25zZSkge1xuICAgIHJlc3BvbnNlLnRleHQgPSAoKSA9PiB7XG4gICAgICAgIGlmIChyZXNwb25zZS5jYW5kaWRhdGVzICYmIHJlc3BvbnNlLmNhbmRpZGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmNhbmRpZGF0ZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVGhpcyByZXNwb25zZSBoYWQgJHtyZXNwb25zZS5jYW5kaWRhdGVzLmxlbmd0aH0gYCArXG4gICAgICAgICAgICAgICAgICAgIGBjYW5kaWRhdGVzLiBSZXR1cm5pbmcgdGV4dCBmcm9tIHRoZSBmaXJzdCBjYW5kaWRhdGUgb25seS4gYCArXG4gICAgICAgICAgICAgICAgICAgIGBBY2Nlc3MgcmVzcG9uc2UuY2FuZGlkYXRlcyBkaXJlY3RseSB0byB1c2UgdGhlIG90aGVyIGNhbmRpZGF0ZXMuYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGFkQmFkRmluaXNoUmVhc29uKHJlc3BvbnNlLmNhbmRpZGF0ZXNbMF0pKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEdvb2dsZUdlbmVyYXRpdmVBSVJlc3BvbnNlRXJyb3IoYCR7Zm9ybWF0QmxvY2tFcnJvck1lc3NhZ2UocmVzcG9uc2UpfWAsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBnZXRUZXh0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyZXNwb25zZS5wcm9tcHRGZWVkYmFjaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEdvb2dsZUdlbmVyYXRpdmVBSVJlc3BvbnNlRXJyb3IoYFRleHQgbm90IGF2YWlsYWJsZS4gJHtmb3JtYXRCbG9ja0Vycm9yTWVzc2FnZShyZXNwb25zZSl9YCwgcmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH07XG4gICAgcmV0dXJuIHJlc3BvbnNlO1xufVxuLyoqXG4gKiBSZXR1cm5zIHRleHQgb2YgZmlyc3QgY2FuZGlkYXRlLlxuICovXG5mdW5jdGlvbiBnZXRUZXh0KHJlc3BvbnNlKSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kO1xuICAgIGlmICgoX2QgPSAoX2MgPSAoX2IgPSAoX2EgPSByZXNwb25zZS5jYW5kaWRhdGVzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FbMF0uY29udGVudCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnBhcnRzKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NbMF0pID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC50ZXh0KSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHNbMF0udGV4dDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cbn1cbmNvbnN0IGJhZEZpbmlzaFJlYXNvbnMgPSBbRmluaXNoUmVhc29uLlJFQ0lUQVRJT04sIEZpbmlzaFJlYXNvbi5TQUZFVFldO1xuZnVuY3Rpb24gaGFkQmFkRmluaXNoUmVhc29uKGNhbmRpZGF0ZSkge1xuICAgIHJldHVybiAoISFjYW5kaWRhdGUuZmluaXNoUmVhc29uICYmXG4gICAgICAgIGJhZEZpbmlzaFJlYXNvbnMuaW5jbHVkZXMoY2FuZGlkYXRlLmZpbmlzaFJlYXNvbikpO1xufVxuZnVuY3Rpb24gZm9ybWF0QmxvY2tFcnJvck1lc3NhZ2UocmVzcG9uc2UpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICBsZXQgbWVzc2FnZSA9IFwiXCI7XG4gICAgaWYgKCghcmVzcG9uc2UuY2FuZGlkYXRlcyB8fCByZXNwb25zZS5jYW5kaWRhdGVzLmxlbmd0aCA9PT0gMCkgJiZcbiAgICAgICAgcmVzcG9uc2UucHJvbXB0RmVlZGJhY2spIHtcbiAgICAgICAgbWVzc2FnZSArPSBcIlJlc3BvbnNlIHdhcyBibG9ja2VkXCI7XG4gICAgICAgIGlmICgoX2EgPSByZXNwb25zZS5wcm9tcHRGZWVkYmFjaykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmJsb2NrUmVhc29uKSB7XG4gICAgICAgICAgICBtZXNzYWdlICs9IGAgZHVlIHRvICR7cmVzcG9uc2UucHJvbXB0RmVlZGJhY2suYmxvY2tSZWFzb259YDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKF9iID0gcmVzcG9uc2UucHJvbXB0RmVlZGJhY2spID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5ibG9ja1JlYXNvbk1lc3NhZ2UpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgKz0gYDogJHtyZXNwb25zZS5wcm9tcHRGZWVkYmFjay5ibG9ja1JlYXNvbk1lc3NhZ2V9YDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICgoX2MgPSByZXNwb25zZS5jYW5kaWRhdGVzKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NbMF0pIHtcbiAgICAgICAgY29uc3QgZmlyc3RDYW5kaWRhdGUgPSByZXNwb25zZS5jYW5kaWRhdGVzWzBdO1xuICAgICAgICBpZiAoaGFkQmFkRmluaXNoUmVhc29uKGZpcnN0Q2FuZGlkYXRlKSkge1xuICAgICAgICAgICAgbWVzc2FnZSArPSBgQ2FuZGlkYXRlIHdhcyBibG9ja2VkIGR1ZSB0byAke2ZpcnN0Q2FuZGlkYXRlLmZpbmlzaFJlYXNvbn1gO1xuICAgICAgICAgICAgaWYgKGZpcnN0Q2FuZGlkYXRlLmZpbmlzaE1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlICs9IGA6ICR7Zmlyc3RDYW5kaWRhdGUuZmluaXNoTWVzc2FnZX1gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xufVxuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XHJcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXHJcbkFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXHJcbk9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UsIFN1cHByZXNzZWRFcnJvciwgU3ltYm9sICovXHJcblxyXG5cclxuZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxudHlwZW9mIFN1cHByZXNzZWRFcnJvciA9PT0gXCJmdW5jdGlvblwiID8gU3VwcHJlc3NlZEVycm9yIDogZnVuY3Rpb24gKGVycm9yLCBzdXBwcmVzc2VkLCBtZXNzYWdlKSB7XHJcbiAgICB2YXIgZSA9IG5ldyBFcnJvcihtZXNzYWdlKTtcclxuICAgIHJldHVybiBlLm5hbWUgPSBcIlN1cHByZXNzZWRFcnJvclwiLCBlLmVycm9yID0gZXJyb3IsIGUuc3VwcHJlc3NlZCA9IHN1cHByZXNzZWQsIGU7XHJcbn07XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCByZXNwb25zZUxpbmVSRSA9IC9eZGF0YVxcOiAoLiopKD86XFxuXFxufFxcclxccnxcXHJcXG5cXHJcXG4pLztcbi8qKlxuICogUHJvY2VzcyBhIHJlc3BvbnNlLmJvZHkgc3RyZWFtIGZyb20gdGhlIGJhY2tlbmQgYW5kIHJldHVybiBhblxuICogaXRlcmF0b3IgdGhhdCBwcm92aWRlcyBvbmUgY29tcGxldGUgR2VuZXJhdGVDb250ZW50UmVzcG9uc2UgYXQgYSB0aW1lXG4gKiBhbmQgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCBhIHNpbmdsZSBhZ2dyZWdhdGVkXG4gKiBHZW5lcmF0ZUNvbnRlbnRSZXNwb25zZS5cbiAqXG4gKiBAcGFyYW0gcmVzcG9uc2UgLSBSZXNwb25zZSBmcm9tIGEgZmV0Y2ggY2FsbFxuICovXG5mdW5jdGlvbiBwcm9jZXNzU3RyZWFtKHJlc3BvbnNlKSB7XG4gICAgY29uc3QgaW5wdXRTdHJlYW0gPSByZXNwb25zZS5ib2R5LnBpcGVUaHJvdWdoKG5ldyBUZXh0RGVjb2RlclN0cmVhbShcInV0ZjhcIiwgeyBmYXRhbDogdHJ1ZSB9KSk7XG4gICAgY29uc3QgcmVzcG9uc2VTdHJlYW0gPSBnZXRSZXNwb25zZVN0cmVhbShpbnB1dFN0cmVhbSk7XG4gICAgY29uc3QgW3N0cmVhbTEsIHN0cmVhbTJdID0gcmVzcG9uc2VTdHJlYW0udGVlKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RyZWFtOiBnZW5lcmF0ZVJlc3BvbnNlU2VxdWVuY2Uoc3RyZWFtMSksXG4gICAgICAgIHJlc3BvbnNlOiBnZXRSZXNwb25zZVByb21pc2Uoc3RyZWFtMiksXG4gICAgfTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldFJlc3BvbnNlUHJvbWlzZShzdHJlYW0pIHtcbiAgICBjb25zdCBhbGxSZXNwb25zZXMgPSBbXTtcbiAgICBjb25zdCByZWFkZXIgPSBzdHJlYW0uZ2V0UmVhZGVyKCk7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgY29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcbiAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgIHJldHVybiBhZGRIZWxwZXJzKGFnZ3JlZ2F0ZVJlc3BvbnNlcyhhbGxSZXNwb25zZXMpKTtcbiAgICAgICAgfVxuICAgICAgICBhbGxSZXNwb25zZXMucHVzaCh2YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2VuZXJhdGVSZXNwb25zZVNlcXVlbmNlKHN0cmVhbSkge1xuICAgIHJldHVybiBfX2FzeW5jR2VuZXJhdG9yKHRoaXMsIGFyZ3VtZW50cywgZnVuY3Rpb24qIGdlbmVyYXRlUmVzcG9uc2VTZXF1ZW5jZV8xKCkge1xuICAgICAgICBjb25zdCByZWFkZXIgPSBzdHJlYW0uZ2V0UmVhZGVyKCk7XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICBjb25zdCB7IHZhbHVlLCBkb25lIH0gPSB5aWVsZCBfX2F3YWl0KHJlYWRlci5yZWFkKCkpO1xuICAgICAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIHlpZWxkIF9fYXdhaXQoYWRkSGVscGVycyh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG4vKipcbiAqIFJlYWRzIGEgcmF3IHN0cmVhbSBmcm9tIHRoZSBmZXRjaCByZXNwb25zZSBhbmQgam9pbiBpbmNvbXBsZXRlXG4gKiBjaHVua3MsIHJldHVybmluZyBhIG5ldyBzdHJlYW0gdGhhdCBwcm92aWRlcyBhIHNpbmdsZSBjb21wbGV0ZVxuICogR2VuZXJhdGVDb250ZW50UmVzcG9uc2UgaW4gZWFjaCBpdGVyYXRpb24uXG4gKi9cbmZ1bmN0aW9uIGdldFJlc3BvbnNlU3RyZWFtKGlucHV0U3RyZWFtKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXRTdHJlYW0uZ2V0UmVhZGVyKCk7XG4gICAgY29uc3Qgc3RyZWFtID0gbmV3IFJlYWRhYmxlU3RyZWFtKHtcbiAgICAgICAgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgICAgICAgbGV0IGN1cnJlbnRUZXh0ID0gXCJcIjtcbiAgICAgICAgICAgIHJldHVybiBwdW1wKCk7XG4gICAgICAgICAgICBmdW5jdGlvbiBwdW1wKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWFkZXIucmVhZCgpLnRoZW4oKHsgdmFsdWUsIGRvbmUgfSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZXJyb3IobmV3IEdvb2dsZUdlbmVyYXRpdmVBSUVycm9yKFwiRmFpbGVkIHRvIHBhcnNlIHN0cmVhbVwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUZXh0ICs9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbWF0Y2ggPSBjdXJyZW50VGV4dC5tYXRjaChyZXNwb25zZUxpbmVSRSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwYXJzZWRSZXNwb25zZTtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZFJlc3BvbnNlID0gSlNPTi5wYXJzZShtYXRjaFsxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZXJyb3IobmV3IEdvb2dsZUdlbmVyYXRpdmVBSUVycm9yKGBFcnJvciBwYXJzaW5nIEpTT04gcmVzcG9uc2U6IFwiJHttYXRjaFsxXX1cImApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUocGFyc2VkUmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRleHQgPSBjdXJyZW50VGV4dC5zdWJzdHJpbmcobWF0Y2hbMF0ubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoID0gY3VycmVudFRleHQubWF0Y2gocmVzcG9uc2VMaW5lUkUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwdW1wKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfSk7XG4gICAgcmV0dXJuIHN0cmVhbTtcbn1cbi8qKlxuICogQWdncmVnYXRlcyBhbiBhcnJheSBvZiBgR2VuZXJhdGVDb250ZW50UmVzcG9uc2VgcyBpbnRvIGEgc2luZ2xlXG4gKiBHZW5lcmF0ZUNvbnRlbnRSZXNwb25zZS5cbiAqL1xuZnVuY3Rpb24gYWdncmVnYXRlUmVzcG9uc2VzKHJlc3BvbnNlcykge1xuICAgIGNvbnN0IGxhc3RSZXNwb25zZSA9IHJlc3BvbnNlc1tyZXNwb25zZXMubGVuZ3RoIC0gMV07XG4gICAgY29uc3QgYWdncmVnYXRlZFJlc3BvbnNlID0ge1xuICAgICAgICBwcm9tcHRGZWVkYmFjazogbGFzdFJlc3BvbnNlID09PSBudWxsIHx8IGxhc3RSZXNwb25zZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogbGFzdFJlc3BvbnNlLnByb21wdEZlZWRiYWNrLFxuICAgIH07XG4gICAgZm9yIChjb25zdCByZXNwb25zZSBvZiByZXNwb25zZXMpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmNhbmRpZGF0ZXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2FuZGlkYXRlIG9mIHJlc3BvbnNlLmNhbmRpZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gY2FuZGlkYXRlLmluZGV4O1xuICAgICAgICAgICAgICAgIGlmICghYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlc1tpXSkge1xuICAgICAgICAgICAgICAgICAgICBhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlc1tpXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4OiBjYW5kaWRhdGUuaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIEtlZXAgb3ZlcndyaXRpbmcsIHRoZSBsYXN0IG9uZSB3aWxsIGJlIGZpbmFsXG4gICAgICAgICAgICAgICAgYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXNbaV0uY2l0YXRpb25NZXRhZGF0YSA9XG4gICAgICAgICAgICAgICAgICAgIGNhbmRpZGF0ZS5jaXRhdGlvbk1ldGFkYXRhO1xuICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzW2ldLmZpbmlzaFJlYXNvbiA9IGNhbmRpZGF0ZS5maW5pc2hSZWFzb247XG4gICAgICAgICAgICAgICAgYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXNbaV0uZmluaXNoTWVzc2FnZSA9XG4gICAgICAgICAgICAgICAgICAgIGNhbmRpZGF0ZS5maW5pc2hNZXNzYWdlO1xuICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzW2ldLnNhZmV0eVJhdGluZ3MgPVxuICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUuc2FmZXR5UmF0aW5ncztcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBDYW5kaWRhdGVzIHNob3VsZCBhbHdheXMgaGF2ZSBjb250ZW50IGFuZCBwYXJ0cywgYnV0IHRoaXMgaGFuZGxlc1xuICAgICAgICAgICAgICAgICAqIHBvc3NpYmxlIG1hbGZvcm1lZCByZXNwb25zZXMuXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZS5jb250ZW50ICYmIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXNbaV0uY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXNbaV0uY29udGVudCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlOiBjYW5kaWRhdGUuY29udGVudC5yb2xlIHx8IFwidXNlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRzOiBbeyB0ZXh0OiBcIlwiIH1dLFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgY2FuZGlkYXRlLmNvbnRlbnQucGFydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJ0LnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlc1tpXS5jb250ZW50LnBhcnRzWzBdLnRleHQgKz1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydC50ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhZ2dyZWdhdGVkUmVzcG9uc2U7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUNvbnRlbnRTdHJlYW0oYXBpS2V5LCBtb2RlbCwgcGFyYW1zKSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFJlcXVlc3RVcmwobW9kZWwsIFRhc2suU1RSRUFNX0dFTkVSQVRFX0NPTlRFTlQsIGFwaUtleSwgXG4gICAgLyogc3RyZWFtICovIHRydWUpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbWFrZVJlcXVlc3QodXJsLCBKU09OLnN0cmluZ2lmeShwYXJhbXMpKTtcbiAgICByZXR1cm4gcHJvY2Vzc1N0cmVhbShyZXNwb25zZSk7XG59XG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUNvbnRlbnQoYXBpS2V5LCBtb2RlbCwgcGFyYW1zKSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFJlcXVlc3RVcmwobW9kZWwsIFRhc2suR0VORVJBVEVfQ09OVEVOVCwgYXBpS2V5LCBcbiAgICAvKiBzdHJlYW0gKi8gZmFsc2UpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbWFrZVJlcXVlc3QodXJsLCBKU09OLnN0cmluZ2lmeShwYXJhbXMpKTtcbiAgICBjb25zdCByZXNwb25zZUpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgY29uc3QgZW5oYW5jZWRSZXNwb25zZSA9IGFkZEhlbHBlcnMocmVzcG9uc2VKc29uKTtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXNwb25zZTogZW5oYW5jZWRSZXNwb25zZSxcbiAgICB9O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gZm9ybWF0TmV3Q29udGVudChyZXF1ZXN0LCByb2xlKSB7XG4gICAgbGV0IG5ld1BhcnRzID0gW107XG4gICAgaWYgKHR5cGVvZiByZXF1ZXN0ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIG5ld1BhcnRzID0gW3sgdGV4dDogcmVxdWVzdCB9XTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZvciAoY29uc3QgcGFydE9yU3RyaW5nIG9mIHJlcXVlc3QpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcGFydE9yU3RyaW5nID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgbmV3UGFydHMucHVzaCh7IHRleHQ6IHBhcnRPclN0cmluZyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld1BhcnRzLnB1c2gocGFydE9yU3RyaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyByb2xlLCBwYXJ0czogbmV3UGFydHMgfTtcbn1cbmZ1bmN0aW9uIGZvcm1hdEdlbmVyYXRlQ29udGVudElucHV0KHBhcmFtcykge1xuICAgIGlmIChwYXJhbXMuY29udGVudHMpIHtcbiAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBmb3JtYXROZXdDb250ZW50KHBhcmFtcywgXCJ1c2VyXCIpO1xuICAgICAgICByZXR1cm4geyBjb250ZW50czogW2NvbnRlbnRdIH07XG4gICAgfVxufVxuZnVuY3Rpb24gZm9ybWF0RW1iZWRDb250ZW50SW5wdXQocGFyYW1zKSB7XG4gICAgaWYgKHR5cGVvZiBwYXJhbXMgPT09IFwic3RyaW5nXCIgfHwgQXJyYXkuaXNBcnJheShwYXJhbXMpKSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBmb3JtYXROZXdDb250ZW50KHBhcmFtcywgXCJ1c2VyXCIpO1xuICAgICAgICByZXR1cm4geyBjb250ZW50IH07XG4gICAgfVxuICAgIHJldHVybiBwYXJhbXM7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERvIG5vdCBsb2cgYSBtZXNzYWdlIGZvciB0aGlzIGVycm9yLlxuICovXG5jb25zdCBTSUxFTlRfRVJST1IgPSBcIlNJTEVOVF9FUlJPUlwiO1xuLyoqXG4gKiBDaGF0U2Vzc2lvbiBjbGFzcyB0aGF0IGVuYWJsZXMgc2VuZGluZyBjaGF0IG1lc3NhZ2VzIGFuZCBzdG9yZXNcbiAqIGhpc3Rvcnkgb2Ygc2VudCBhbmQgcmVjZWl2ZWQgbWVzc2FnZXMgc28gZmFyLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgQ2hhdFNlc3Npb24ge1xuICAgIGNvbnN0cnVjdG9yKGFwaUtleSwgbW9kZWwsIHBhcmFtcykge1xuICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xuICAgICAgICB0aGlzLl9oaXN0b3J5ID0gW107XG4gICAgICAgIHRoaXMuX3NlbmRQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHRoaXMuX2FwaUtleSA9IGFwaUtleTtcbiAgICAgICAgaWYgKHBhcmFtcyA9PT0gbnVsbCB8fCBwYXJhbXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhcmFtcy5oaXN0b3J5KSB7XG4gICAgICAgICAgICB0aGlzLl9oaXN0b3J5ID0gcGFyYW1zLmhpc3RvcnkubWFwKChjb250ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFjb250ZW50LnJvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyByb2xlIGZvciBoaXN0b3J5IGl0ZW06IFwiICsgSlNPTi5zdHJpbmdpZnkoY29udGVudCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0TmV3Q29udGVudChjb250ZW50LnBhcnRzLCBjb250ZW50LnJvbGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgY2hhdCBoaXN0b3J5IHNvIGZhci4gQmxvY2tlZCBwcm9tcHRzIGFyZSBub3QgYWRkZWQgdG8gaGlzdG9yeS5cbiAgICAgKiBCbG9ja2VkIGNhbmRpZGF0ZXMgYXJlIG5vdCBhZGRlZCB0byBoaXN0b3J5LCBub3IgYXJlIHRoZSBwcm9tcHRzIHRoYXRcbiAgICAgKiBnZW5lcmF0ZWQgdGhlbS5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRIaXN0b3J5KCkge1xuICAgICAgICBhd2FpdCB0aGlzLl9zZW5kUHJvbWlzZTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hpc3Rvcnk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgY2hhdCBtZXNzYWdlIGFuZCByZWNlaXZlcyBhIG5vbi1zdHJlYW1pbmdcbiAgICAgKiB7QGxpbmsgR2VuZXJhdGVDb250ZW50UmVzdWx0fVxuICAgICAqL1xuICAgIGFzeW5jIHNlbmRNZXNzYWdlKHJlcXVlc3QpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgYXdhaXQgdGhpcy5fc2VuZFByb21pc2U7XG4gICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBmb3JtYXROZXdDb250ZW50KHJlcXVlc3QsIFwidXNlclwiKTtcbiAgICAgICAgY29uc3QgZ2VuZXJhdGVDb250ZW50UmVxdWVzdCA9IHtcbiAgICAgICAgICAgIHNhZmV0eVNldHRpbmdzOiAoX2EgPSB0aGlzLnBhcmFtcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNhZmV0eVNldHRpbmdzLFxuICAgICAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzogKF9iID0gdGhpcy5wYXJhbXMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5nZW5lcmF0aW9uQ29uZmlnLFxuICAgICAgICAgICAgY29udGVudHM6IFsuLi50aGlzLl9oaXN0b3J5LCBuZXdDb250ZW50XSxcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IGZpbmFsUmVzdWx0O1xuICAgICAgICAvLyBBZGQgb250byB0aGUgY2hhaW4uXG4gICAgICAgIHRoaXMuX3NlbmRQcm9taXNlID0gdGhpcy5fc2VuZFByb21pc2VcbiAgICAgICAgICAgIC50aGVuKCgpID0+IGdlbmVyYXRlQ29udGVudCh0aGlzLl9hcGlLZXksIHRoaXMubW9kZWwsIGdlbmVyYXRlQ29udGVudFJlcXVlc3QpKVxuICAgICAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5yZXNwb25zZS5jYW5kaWRhdGVzICYmXG4gICAgICAgICAgICAgICAgcmVzdWx0LnJlc3BvbnNlLmNhbmRpZGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hpc3RvcnkucHVzaChuZXdDb250ZW50KTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZUNvbnRlbnQgPSBPYmplY3QuYXNzaWduKHsgcGFydHM6IFtdLCBcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVzcG9uc2Ugc2VlbXMgdG8gY29tZSBiYWNrIHdpdGhvdXQgYSByb2xlIHNldC5cbiAgICAgICAgICAgICAgICAgICAgcm9sZTogXCJtb2RlbFwiIH0sIChfYSA9IHJlc3VsdC5yZXNwb25zZS5jYW5kaWRhdGVzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FbMF0uY29udGVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5faGlzdG9yeS5wdXNoKHJlc3BvbnNlQ29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBibG9ja0Vycm9yTWVzc2FnZSA9IGZvcm1hdEJsb2NrRXJyb3JNZXNzYWdlKHJlc3VsdC5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgaWYgKGJsb2NrRXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybihgc2VuZE1lc3NhZ2UoKSB3YXMgdW5zdWNjZXNzZnVsLiAke2Jsb2NrRXJyb3JNZXNzYWdlfS4gSW5zcGVjdCByZXNwb25zZSBvYmplY3QgZm9yIGRldGFpbHMuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluYWxSZXN1bHQgPSByZXN1bHQ7XG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0aGlzLl9zZW5kUHJvbWlzZTtcbiAgICAgICAgcmV0dXJuIGZpbmFsUmVzdWx0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kcyBhIGNoYXQgbWVzc2FnZSBhbmQgcmVjZWl2ZXMgdGhlIHJlc3BvbnNlIGFzIGFcbiAgICAgKiB7QGxpbmsgR2VuZXJhdGVDb250ZW50U3RyZWFtUmVzdWx0fSBjb250YWluaW5nIGFuIGl0ZXJhYmxlIHN0cmVhbVxuICAgICAqIGFuZCBhIHJlc3BvbnNlIHByb21pc2UuXG4gICAgICovXG4gICAgYXN5bmMgc2VuZE1lc3NhZ2VTdHJlYW0ocmVxdWVzdCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBhd2FpdCB0aGlzLl9zZW5kUHJvbWlzZTtcbiAgICAgICAgY29uc3QgbmV3Q29udGVudCA9IGZvcm1hdE5ld0NvbnRlbnQocmVxdWVzdCwgXCJ1c2VyXCIpO1xuICAgICAgICBjb25zdCBnZW5lcmF0ZUNvbnRlbnRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgc2FmZXR5U2V0dGluZ3M6IChfYSA9IHRoaXMucGFyYW1zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2FmZXR5U2V0dGluZ3MsXG4gICAgICAgICAgICBnZW5lcmF0aW9uQ29uZmlnOiAoX2IgPSB0aGlzLnBhcmFtcykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmdlbmVyYXRpb25Db25maWcsXG4gICAgICAgICAgICBjb250ZW50czogWy4uLnRoaXMuX2hpc3RvcnksIG5ld0NvbnRlbnRdLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBzdHJlYW1Qcm9taXNlID0gZ2VuZXJhdGVDb250ZW50U3RyZWFtKHRoaXMuX2FwaUtleSwgdGhpcy5tb2RlbCwgZ2VuZXJhdGVDb250ZW50UmVxdWVzdCk7XG4gICAgICAgIC8vIEFkZCBvbnRvIHRoZSBjaGFpbi5cbiAgICAgICAgdGhpcy5fc2VuZFByb21pc2UgPSB0aGlzLl9zZW5kUHJvbWlzZVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4gc3RyZWFtUHJvbWlzZSlcbiAgICAgICAgICAgIC8vIFRoaXMgbXVzdCBiZSBoYW5kbGVkIHRvIGF2b2lkIHVuaGFuZGxlZCByZWplY3Rpb24sIGJ1dCBqdW1wXG4gICAgICAgICAgICAvLyB0byB0aGUgZmluYWwgY2F0Y2ggYmxvY2sgd2l0aCBhIGxhYmVsIHRvIG5vdCBsb2cgdGhpcyBlcnJvci5cbiAgICAgICAgICAgIC5jYXRjaCgoX2lnbm9yZWQpID0+IHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihTSUxFTlRfRVJST1IpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKHN0cmVhbVJlc3VsdCkgPT4gc3RyZWFtUmVzdWx0LnJlc3BvbnNlKVxuICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuY2FuZGlkYXRlcyAmJiByZXNwb25zZS5jYW5kaWRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oaXN0b3J5LnB1c2gobmV3Q29udGVudCk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VDb250ZW50ID0gT2JqZWN0LmFzc2lnbih7fSwgcmVzcG9uc2UuY2FuZGlkYXRlc1swXS5jb250ZW50KTtcbiAgICAgICAgICAgICAgICAvLyBSZXNwb25zZSBzZWVtcyB0byBjb21lIGJhY2sgd2l0aG91dCBhIHJvbGUgc2V0LlxuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2VDb250ZW50LnJvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VDb250ZW50LnJvbGUgPSBcIm1vZGVsXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX2hpc3RvcnkucHVzaChyZXNwb25zZUNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYmxvY2tFcnJvck1lc3NhZ2UgPSBmb3JtYXRCbG9ja0Vycm9yTWVzc2FnZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgaWYgKGJsb2NrRXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybihgc2VuZE1lc3NhZ2VTdHJlYW0oKSB3YXMgdW5zdWNjZXNzZnVsLiAke2Jsb2NrRXJyb3JNZXNzYWdlfS4gSW5zcGVjdCByZXNwb25zZSBvYmplY3QgZm9yIGRldGFpbHMuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgICAvLyBFcnJvcnMgaW4gc3RyZWFtUHJvbWlzZSBhcmUgYWxyZWFkeSBjYXRjaGFibGUgYnkgdGhlIHVzZXIgYXNcbiAgICAgICAgICAgIC8vIHN0cmVhbVByb21pc2UgaXMgcmV0dXJuZWQuXG4gICAgICAgICAgICAvLyBBdm9pZCBkdXBsaWNhdGluZyB0aGUgZXJyb3IgbWVzc2FnZSBpbiBsb2dzLlxuICAgICAgICAgICAgaWYgKGUubWVzc2FnZSAhPT0gU0lMRU5UX0VSUk9SKSB7XG4gICAgICAgICAgICAgICAgLy8gVXNlcnMgZG8gbm90IGhhdmUgYWNjZXNzIHRvIF9zZW5kUHJvbWlzZSB0byBjYXRjaCBlcnJvcnNcbiAgICAgICAgICAgICAgICAvLyBkb3duc3RyZWFtIGZyb20gc3RyZWFtUHJvbWlzZSwgc28gdGhleSBzaG91bGQgbm90IHRocm93LlxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gc3RyZWFtUHJvbWlzZTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBjb3VudFRva2VucyhhcGlLZXksIG1vZGVsLCBwYXJhbXMpIHtcbiAgICBjb25zdCB1cmwgPSBuZXcgUmVxdWVzdFVybChtb2RlbCwgVGFzay5DT1VOVF9UT0tFTlMsIGFwaUtleSwgZmFsc2UpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbWFrZVJlcXVlc3QodXJsLCBKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHBhcmFtcyksIHsgbW9kZWwgfSkpKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZW1iZWRDb250ZW50KGFwaUtleSwgbW9kZWwsIHBhcmFtcykge1xuICAgIGNvbnN0IHVybCA9IG5ldyBSZXF1ZXN0VXJsKG1vZGVsLCBUYXNrLkVNQkVEX0NPTlRFTlQsIGFwaUtleSwgZmFsc2UpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbWFrZVJlcXVlc3QodXJsLCBKU09OLnN0cmluZ2lmeShwYXJhbXMpKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xufVxuYXN5bmMgZnVuY3Rpb24gYmF0Y2hFbWJlZENvbnRlbnRzKGFwaUtleSwgbW9kZWwsIHBhcmFtcykge1xuICAgIGNvbnN0IHVybCA9IG5ldyBSZXF1ZXN0VXJsKG1vZGVsLCBUYXNrLkJBVENIX0VNQkVEX0NPTlRFTlRTLCBhcGlLZXksIGZhbHNlKTtcbiAgICBjb25zdCByZXF1ZXN0c1dpdGhNb2RlbCA9IHBhcmFtcy5yZXF1ZXN0cy5tYXAoKHJlcXVlc3QpID0+IHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgcmVxdWVzdCksIHsgbW9kZWw6IGBtb2RlbHMvJHttb2RlbH1gIH0pO1xuICAgIH0pO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbWFrZVJlcXVlc3QodXJsLCBKU09OLnN0cmluZ2lmeSh7IHJlcXVlc3RzOiByZXF1ZXN0c1dpdGhNb2RlbCB9KSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ2xhc3MgZm9yIGdlbmVyYXRpdmUgbW9kZWwgQVBJcy5cbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgR2VuZXJhdGl2ZU1vZGVsIHtcbiAgICBjb25zdHJ1Y3RvcihhcGlLZXksIG1vZGVsUGFyYW1zKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdGhpcy5hcGlLZXkgPSBhcGlLZXk7XG4gICAgICAgIGlmIChtb2RlbFBhcmFtcy5tb2RlbC5zdGFydHNXaXRoKFwibW9kZWxzL1wiKSkge1xuICAgICAgICAgICAgdGhpcy5tb2RlbCA9IChfYSA9IG1vZGVsUGFyYW1zLm1vZGVsLnNwbGl0KFwibW9kZWxzL1wiKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hWzFdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tb2RlbCA9IG1vZGVsUGFyYW1zLm1vZGVsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ2VuZXJhdGlvbkNvbmZpZyA9IG1vZGVsUGFyYW1zLmdlbmVyYXRpb25Db25maWcgfHwge307XG4gICAgICAgIHRoaXMuc2FmZXR5U2V0dGluZ3MgPSBtb2RlbFBhcmFtcy5zYWZldHlTZXR0aW5ncyB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWFrZXMgYSBzaW5nbGUgbm9uLXN0cmVhbWluZyBjYWxsIHRvIHRoZSBtb2RlbFxuICAgICAqIGFuZCByZXR1cm5zIGFuIG9iamVjdCBjb250YWluaW5nIGEgc2luZ2xlIHtAbGluayBHZW5lcmF0ZUNvbnRlbnRSZXNwb25zZX0uXG4gICAgICovXG4gICAgYXN5bmMgZ2VuZXJhdGVDb250ZW50KHJlcXVlc3QpIHtcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkUGFyYW1zID0gZm9ybWF0R2VuZXJhdGVDb250ZW50SW5wdXQocmVxdWVzdCk7XG4gICAgICAgIHJldHVybiBnZW5lcmF0ZUNvbnRlbnQodGhpcy5hcGlLZXksIHRoaXMubW9kZWwsIE9iamVjdC5hc3NpZ24oeyBnZW5lcmF0aW9uQ29uZmlnOiB0aGlzLmdlbmVyYXRpb25Db25maWcsIHNhZmV0eVNldHRpbmdzOiB0aGlzLnNhZmV0eVNldHRpbmdzIH0sIGZvcm1hdHRlZFBhcmFtcykpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNYWtlcyBhIHNpbmdsZSBzdHJlYW1pbmcgY2FsbCB0byB0aGUgbW9kZWxcbiAgICAgKiBhbmQgcmV0dXJucyBhbiBvYmplY3QgY29udGFpbmluZyBhbiBpdGVyYWJsZSBzdHJlYW0gdGhhdCBpdGVyYXRlc1xuICAgICAqIG92ZXIgYWxsIGNodW5rcyBpbiB0aGUgc3RyZWFtaW5nIHJlc3BvbnNlIGFzIHdlbGwgYXNcbiAgICAgKiBhIHByb21pc2UgdGhhdCByZXR1cm5zIHRoZSBmaW5hbCBhZ2dyZWdhdGVkIHJlc3BvbnNlLlxuICAgICAqL1xuICAgIGFzeW5jIGdlbmVyYXRlQ29udGVudFN0cmVhbShyZXF1ZXN0KSB7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZFBhcmFtcyA9IGZvcm1hdEdlbmVyYXRlQ29udGVudElucHV0KHJlcXVlc3QpO1xuICAgICAgICByZXR1cm4gZ2VuZXJhdGVDb250ZW50U3RyZWFtKHRoaXMuYXBpS2V5LCB0aGlzLm1vZGVsLCBPYmplY3QuYXNzaWduKHsgZ2VuZXJhdGlvbkNvbmZpZzogdGhpcy5nZW5lcmF0aW9uQ29uZmlnLCBzYWZldHlTZXR0aW5nczogdGhpcy5zYWZldHlTZXR0aW5ncyB9LCBmb3JtYXR0ZWRQYXJhbXMpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyBhIG5ldyB7QGxpbmsgQ2hhdFNlc3Npb259IGluc3RhbmNlIHdoaWNoIGNhbiBiZSB1c2VkIGZvclxuICAgICAqIG11bHRpLXR1cm4gY2hhdHMuXG4gICAgICovXG4gICAgc3RhcnRDaGF0KHN0YXJ0Q2hhdFBhcmFtcykge1xuICAgICAgICByZXR1cm4gbmV3IENoYXRTZXNzaW9uKHRoaXMuYXBpS2V5LCB0aGlzLm1vZGVsLCBzdGFydENoYXRQYXJhbXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb3VudHMgdGhlIHRva2VucyBpbiB0aGUgcHJvdmlkZWQgcmVxdWVzdC5cbiAgICAgKi9cbiAgICBhc3luYyBjb3VudFRva2VucyhyZXF1ZXN0KSB7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZFBhcmFtcyA9IGZvcm1hdEdlbmVyYXRlQ29udGVudElucHV0KHJlcXVlc3QpO1xuICAgICAgICByZXR1cm4gY291bnRUb2tlbnModGhpcy5hcGlLZXksIHRoaXMubW9kZWwsIGZvcm1hdHRlZFBhcmFtcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVtYmVkcyB0aGUgcHJvdmlkZWQgY29udGVudC5cbiAgICAgKi9cbiAgICBhc3luYyBlbWJlZENvbnRlbnQocmVxdWVzdCkge1xuICAgICAgICBjb25zdCBmb3JtYXR0ZWRQYXJhbXMgPSBmb3JtYXRFbWJlZENvbnRlbnRJbnB1dChyZXF1ZXN0KTtcbiAgICAgICAgcmV0dXJuIGVtYmVkQ29udGVudCh0aGlzLmFwaUtleSwgdGhpcy5tb2RlbCwgZm9ybWF0dGVkUGFyYW1zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW1iZWRzIGFuIGFycmF5IG9mIHtAbGluayBFbWJlZENvbnRlbnRSZXF1ZXN0fXMuXG4gICAgICovXG4gICAgYXN5bmMgYmF0Y2hFbWJlZENvbnRlbnRzKGJhdGNoRW1iZWRDb250ZW50UmVxdWVzdCkge1xuICAgICAgICByZXR1cm4gYmF0Y2hFbWJlZENvbnRlbnRzKHRoaXMuYXBpS2V5LCB0aGlzLm1vZGVsLCBiYXRjaEVtYmVkQ29udGVudFJlcXVlc3QpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVG9wLWxldmVsIGNsYXNzIGZvciB0aGlzIFNES1xuICogQHB1YmxpY1xuICovXG5jbGFzcyBHb29nbGVHZW5lcmF0aXZlQUkge1xuICAgIGNvbnN0cnVjdG9yKGFwaUtleSkge1xuICAgICAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyBhIHtAbGluayBHZW5lcmF0aXZlTW9kZWx9IGluc3RhbmNlIGZvciB0aGUgcHJvdmlkZWQgbW9kZWwgbmFtZS5cbiAgICAgKi9cbiAgICBnZXRHZW5lcmF0aXZlTW9kZWwobW9kZWxQYXJhbXMpIHtcbiAgICAgICAgaWYgKCFtb2RlbFBhcmFtcy5tb2RlbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEdvb2dsZUdlbmVyYXRpdmVBSUVycm9yKGBNdXN0IHByb3ZpZGUgYSBtb2RlbCBuYW1lLiBgICtcbiAgICAgICAgICAgICAgICBgRXhhbXBsZTogZ2VuYWkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6ICdteS1tb2RlbC1uYW1lJyB9KWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgR2VuZXJhdGl2ZU1vZGVsKHRoaXMuYXBpS2V5LCBtb2RlbFBhcmFtcyk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBCbG9ja1JlYXNvbiwgQ2hhdFNlc3Npb24sIEZpbmlzaFJlYXNvbiwgR2VuZXJhdGl2ZU1vZGVsLCBHb29nbGVHZW5lcmF0aXZlQUksIEhhcm1CbG9ja1RocmVzaG9sZCwgSGFybUNhdGVnb3J5LCBIYXJtUHJvYmFiaWxpdHksIFRhc2tUeXBlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwXG4iLCAiaW1wb3J0IHsgR29vZ2xlR2VuZXJhdGl2ZUFJIH0gZnJvbSBcIkBnb29nbGUvZ2VuZXJhdGl2ZS1haVwiO1xuXG5leHBvcnQgY2xhc3MgR2VtaW5pU2VydmljZSB7XG4gICAgcHJpdmF0ZSBtb2RlbDogYW55O1xuICAgIHByaXZhdGUgY2hhdDogYW55O1xuXG4gICAgY29uc3RydWN0b3IoYXBpS2V5OiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgZ2VuQUkgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJKGFwaUtleSk7XG4gICAgICAgIHRoaXMubW9kZWwgPSBnZW5BSS5nZXRHZW5lcmF0aXZlTW9kZWwoeyBtb2RlbDogXCJnZW1pbmktcHJvXCIgfSk7XG4gICAgICAgIHRoaXMuc3RhcnRDaGF0KCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGFydENoYXQoKSB7XG4gICAgICAgIHRoaXMuY2hhdCA9IHRoaXMubW9kZWwuc3RhcnRDaGF0KHtcbiAgICAgICAgICAgIGhpc3Rvcnk6IFtdLFxuICAgICAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICAgICAgICAgIG1heE91dHB1dFRva2VuczogMTAwMCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGFzeW5jIHNlbmRNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNoYXQuc2VuZE1lc3NhZ2UobWVzc2FnZSk7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlc3VsdC5yZXNwb25zZTtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZW5kaW5nIG1lc3NhZ2UgdG8gR2VtaW5pOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgc3VtbWFyaXplQ29udGVudChjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBwcm9tcHQgPSBgUGxlYXNlIHN1bW1hcml6ZSB0aGUgZm9sbG93aW5nIGNvbnRlbnQ6XFxuXFxuJHtjb250ZW50fWA7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbmRNZXNzYWdlKHByb21wdCk7XG4gICAgfVxuXG4gICAgYXN5bmMgdHJhbnNsYXRlQ29udGVudChjb250ZW50OiBzdHJpbmcsIHRhcmdldExhbmd1YWdlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBwcm9tcHQgPSBgUGxlYXNlIHRyYW5zbGF0ZSB0aGUgZm9sbG93aW5nIGNvbnRlbnQgdG8gJHt0YXJnZXRMYW5ndWFnZX06XFxuXFxuJHtjb250ZW50fWA7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbmRNZXNzYWdlKHByb21wdCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZmluZEFjdGlvbkl0ZW1zKGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IGBQbGVhc2UgYW5hbHl6ZSB0aGUgZm9sbG93aW5nIGNvbnRlbnQgYW5kIGxpc3QgYWxsIGFjdGlvbiBpdGVtcyBhbmQgdGFza3M6XFxuXFxuJHtjb250ZW50fWA7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbmRNZXNzYWdlKHByb21wdCk7XG4gICAgfVxufSAiLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNsYXNzIExhbmd1YWdlU2VsZWN0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHJpdmF0ZSByZXN1bHQ6IHN0cmluZztcbiAgICBwcml2YXRlIG9uQ2hvb3NlOiAobGFuZ3VhZ2U6IHN0cmluZykgPT4gdm9pZDtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBvbkNob29zZTogKGxhbmd1YWdlOiBzdHJpbmcpID0+IHZvaWQpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5vbkNob29zZSA9IG9uQ2hvb3NlO1xuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdTZWxlY3QgVGFyZ2V0IExhbmd1YWdlJyB9KTtcblxuICAgICAgICBjb25zdCBsYW5ndWFnZXMgPSBbXG4gICAgICAgICAgICAnQXJhYmljJywgJ0NoaW5lc2UnLCAnRW5nbGlzaCcsICdGcmVuY2gnLCAnR2VybWFuJyxcbiAgICAgICAgICAgICdIaW5kaScsICdJdGFsaWFuJywgJ0phcGFuZXNlJywgJ0tvcmVhbicsICdQb3J0dWd1ZXNlJyxcbiAgICAgICAgICAgICdSdXNzaWFuJywgJ1NwYW5pc2gnXG4gICAgICAgIF07XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0xhbmd1YWdlJylcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2VzLmZvckVhY2gobGFuZyA9PiBkcm9wZG93bi5hZGRPcHRpb24obGFuZy50b0xvd2VyQ2FzZSgpLCBsYW5nKSk7XG4gICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1RyYW5zbGF0ZScpXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hvb3NlKHRoaXMucmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgfVxufSAiLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgRnV6enlTdWdnZXN0TW9kYWwsIEZ1enp5TWF0Y2ggfSBmcm9tIFwib2JzaWRpYW5cIlxuXG5leHBvcnQgY2xhc3MgRmlsZVNlbGVjdGlvbk1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8VEZpbGU+IHtcblx0cHJpdmF0ZSBvbkNob29zZTogKGZpbGU6IFRGaWxlKSA9PiB2b2lkXG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIG9uQ2hvb3NlOiAoZmlsZTogVEZpbGUpID0+IHZvaWQpIHtcblx0XHRzdXBlcihhcHApXG5cdFx0dGhpcy5vbkNob29zZSA9IG9uQ2hvb3NlXG5cdFx0dGhpcy5zZXRQbGFjZWhvbGRlcihcIlR5cGUgdG8gc2VhcmNoIGZvciBhIGZpbGUuLi5cIilcblx0fVxuXG5cdGdldEl0ZW1zKCk6IFRGaWxlW10ge1xuXHRcdHJldHVybiB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKClcblx0fVxuXG5cdGdldEl0ZW1UZXh0KGZpbGU6IFRGaWxlKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gZmlsZS5iYXNlbmFtZVxuXHR9XG5cblx0b25DaG9vc2VJdGVtKGZpbGU6IFRGaWxlLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG5cdFx0dGhpcy5vbkNob29zZShmaWxlKVxuXHR9XG5cblx0cmVuZGVyU3VnZ2VzdGlvbihtYXRjaDogRnV6enlNYXRjaDxURmlsZT4sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdGNvbnN0IGZpbGUgPSBtYXRjaC5pdGVtXG5cdFx0ZWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBmaWxlLmJhc2VuYW1lIH0pXG5cdFx0Y29uc3QgcGF0aCA9IGVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogZmlsZS5wYXJlbnQ/LnBhdGggPz8gXCJcIiB9KVxuXHRcdHBhdGguYWRkQ2xhc3MoXCJzdWdnZXN0aW9uLXBhdGhcIilcblx0fVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUErRDs7O0FDb0IvRCxJQUFJO0FBQUEsQ0FDSCxTQUFVQyxlQUFjO0FBQ3JCLEVBQUFBLGNBQWEsMkJBQTJCLElBQUk7QUFDNUMsRUFBQUEsY0FBYSwyQkFBMkIsSUFBSTtBQUM1QyxFQUFBQSxjQUFhLGlDQUFpQyxJQUFJO0FBQ2xELEVBQUFBLGNBQWEsMEJBQTBCLElBQUk7QUFDM0MsRUFBQUEsY0FBYSxpQ0FBaUMsSUFBSTtBQUN0RCxHQUFHLGlCQUFpQixlQUFlLENBQUMsRUFBRTtBQUt0QyxJQUFJO0FBQUEsQ0FDSCxTQUFVQyxxQkFBb0I7QUFFM0IsRUFBQUEsb0JBQW1CLGtDQUFrQyxJQUFJO0FBRXpELEVBQUFBLG9CQUFtQixxQkFBcUIsSUFBSTtBQUU1QyxFQUFBQSxvQkFBbUIsd0JBQXdCLElBQUk7QUFFL0MsRUFBQUEsb0JBQW1CLGlCQUFpQixJQUFJO0FBRXhDLEVBQUFBLG9CQUFtQixZQUFZLElBQUk7QUFDdkMsR0FBRyx1QkFBdUIscUJBQXFCLENBQUMsRUFBRTtBQUtsRCxJQUFJO0FBQUEsQ0FDSCxTQUFVQyxrQkFBaUI7QUFFeEIsRUFBQUEsaUJBQWdCLDhCQUE4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LFdBQUssY0FBYyxNQUFNLFFBQVEsR0FBRztBQUFBLElBQ3JDO0FBRUEsVUFBTSxhQUFhLE1BQU07QUFDeEIsbUJBQWE7QUFDYixlQUFTLG9CQUFvQixhQUFhLGVBQWU7QUFDekQsZUFBUyxvQkFBb0IsV0FBVyxVQUFVO0FBQUEsSUFDbkQ7QUFBQSxFQUNEO0FBQ0Q7QUFFQSxJQUFNLDBCQUFOLGNBQXNDLGtDQUFpQjtBQUFBLEVBR3RELFlBQVksS0FBVSxRQUE2QjtBQUNsRCxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxVQUFnQjtBQUNmLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFDeEIsZ0JBQVksTUFBTTtBQUVsQixRQUFJLHlCQUFRLFdBQVcsRUFDckIsUUFBUSxnQkFBZ0IsRUFDeEIsUUFBUSw2Q0FBNkMsRUFDckQsUUFBUSxDQUFDLFNBQVM7QUFDbEIsV0FBSyxRQUFRLE9BQU87QUFDcEIsV0FDRSxlQUFlLG9CQUFvQixFQUNuQyxTQUFTLEtBQUssT0FBTyxTQUFTLFNBQVMscURBQWEsRUFBRSxFQUN0RCxTQUFTLE9BQU8sVUFBVTtBQUMxQixZQUFJLFVBQVUsb0RBQVk7QUFDekIsZUFBSyxPQUFPLFNBQVMsU0FBUyxLQUFLLE9BQU8sY0FBYyxLQUFLO0FBQzdELGdCQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLGVBQUssT0FBTyx3QkFBd0I7QUFBQSxRQUNyQztBQUFBLE1BQ0QsQ0FBQztBQUdGLFlBQU0sZUFBZSxLQUFLLFFBQVEsU0FBUyxVQUFVO0FBQUEsUUFDcEQsTUFBTTtBQUFBLFFBQ04sS0FBSztBQUFBLE1BQ04sQ0FBQztBQUNELG1CQUFhLE1BQU0sV0FBVztBQUM5QixtQkFBYSxNQUFNLFFBQVE7QUFDM0IsbUJBQWEsTUFBTSxNQUFNO0FBQ3pCLG1CQUFhLE1BQU0sWUFBWTtBQUMvQixtQkFBYSxNQUFNLGFBQWE7QUFDaEMsbUJBQWEsTUFBTSxTQUFTO0FBQzVCLG1CQUFhLE1BQU0sU0FBUztBQUU1QixtQkFBYSxpQkFBaUIsU0FBUyxDQUFDLE1BQU07QUFDN0MsVUFBRSxlQUFlO0FBQ2pCLGFBQUssUUFBUSxPQUFPLEtBQUssUUFBUSxTQUFTLGFBQWEsU0FBUztBQUFBLE1BQ2pFLENBQUM7QUFBQSxJQUNGLENBQUM7QUFBQSxFQUNIO0FBQ0Q7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJIYXJtQ2F0ZWdvcnkiLCAiSGFybUJsb2NrVGhyZXNob2xkIiwgIkhhcm1Qcm9iYWJpbGl0eSIsICJCbG9ja1JlYXNvbiIsICJGaW5pc2hSZWFzb24iLCAiVGFza1R5cGUiLCAiVGFzayIsICJfYSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIl9hIiwgInRleHQiXQp9Cg==
